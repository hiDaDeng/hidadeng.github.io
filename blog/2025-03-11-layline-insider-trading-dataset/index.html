<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>数据集 | Layline美股内幕交易数据集 | 大邓和他的PYTHON</title>
<meta name="keywords" content="Python, 文本分析, 经济管理, 美股, 另类数据, 内幕交易, layline insider trading, pd.read_csv, pyarrow" />
<meta name="description" content="该数据集捕捉了公开交易公司的内幕交易活动。证券交易委员会自 2003 年中以来在其网站上以结构化格式提供了这些内幕交易报告。然而，大多数学术论文使用的是商业数据库而非直接使用监管文件，这使得复制变得困难，因为商业数据库中的数据操作和聚合步骤是不透明的，而且随着时间的推移，数据提供者可能会更改历史记录。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。This dataset captures insider trading activity at publicly traded companies. The Securities and Exchange Commission has made these insider trading reports available on its web site in a structured format since mid-2003. However, most academic papers use proprietary commercial databases instead of regulatory filings directly, which makes replication challenging because the data manipulation and aggregation steps in commercial databases are opaque and historical records could be altered by the data provider over time. To overcome these limitations, the presented dataset is created from the original regulatory filings; it is updated daily and includes all information reported by insiders without alteration.">
<meta name="author" content="大邓">
<link rel="canonical" href="/blog/2025-03-11-layline-insider-trading-dataset/" />
<meta name="baidu-site-verification" content="codeva-TJUe6nOmGr" />
<meta name="sogou-site-verification" content="dZHPIorOhK" />
<meta name="sogou-site-verification" content="dZHPIorOhK" />
<meta name="google-site-verification" content="0cmjnyICPwXY_UmLHzs6RRUBIFxxqieMsgTGT_kVctk" />
<meta name="yandex-verification" content="5e672f12d3e2cacd" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.4" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="数据集 | Layline美股内幕交易数据集" />
<meta property="og:description" content="该数据集捕捉了公开交易公司的内幕交易活动。证券交易委员会自 2003 年中以来在其网站上以结构化格式提供了这些内幕交易报告。然而，大多数学术论文使用的是商业数据库而非直接使用监管文件，这使得复制变得困难，因为商业数据库中的数据操作和聚合步骤是不透明的，而且随着时间的推移，数据提供者可能会更改历史记录。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。This dataset captures insider trading activity at publicly traded companies. The Securities and Exchange Commission has made these insider trading reports available on its web site in a structured format since mid-2003. However, most academic papers use proprietary commercial databases instead of regulatory filings directly, which makes replication challenging because the data manipulation and aggregation steps in commercial databases are opaque and historical records could be altered by the data provider over time. To overcome these limitations, the presented dataset is created from the original regulatory filings; it is updated daily and includes all information reported by insiders without alteration." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2025-03-11-layline-insider-trading-dataset/" />
<meta property="og:image" content="/images/blog/chinese_emobank.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2025-03-11T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2025-03-11T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="/images/blog/chinese_emobank.png" />
<meta name="twitter:title" content="数据集 | Layline美股内幕交易数据集"/>
<meta name="twitter:description" content="该数据集捕捉了公开交易公司的内幕交易活动。证券交易委员会自 2003 年中以来在其网站上以结构化格式提供了这些内幕交易报告。然而，大多数学术论文使用的是商业数据库而非直接使用监管文件，这使得复制变得困难，因为商业数据库中的数据操作和聚合步骤是不透明的，而且随着时间的推移，数据提供者可能会更改历史记录。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。This dataset captures insider trading activity at publicly traded companies. The Securities and Exchange Commission has made these insider trading reports available on its web site in a structured format since mid-2003. However, most academic papers use proprietary commercial databases instead of regulatory filings directly, which makes replication challenging because the data manipulation and aggregation steps in commercial databases are opaque and historical records could be altered by the data provider over time. To overcome these limitations, the presented dataset is created from the original regulatory filings; it is updated daily and includes all information reported by insiders without alteration."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "/blog/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "数据集 | Layline美股内幕交易数据集",
      "item": "/blog/2025-03-11-layline-insider-trading-dataset/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "数据集 | Layline美股内幕交易数据集",
  "name": "数据集 | Layline美股内幕交易数据集",
  "description": "该数据集捕捉了公开交易公司的内幕交易活动。证券交易委员会自 2003 年中以来在其网站上以结构化格式提供了这些内幕交易报告。然而，大多数学术论文使用的是商业数据库而非直接使用监管文件，这使得复制变得困难，因为商业数据库中的数据操作和聚合步骤是不透明的，而且随着时间的推移，数据提供者可能会更改历史记录。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。This dataset captures insider trading activity at publicly traded companies. The Securities and Exchange Commission has made these insider trading reports available on its web site in a structured format since mid-2003. However, most academic papers use proprietary commercial databases instead of regulatory filings directly, which makes replication challenging because the data manipulation and aggregation steps in commercial databases are opaque and historical records could be altered by the data provider over time. To overcome these limitations, the presented dataset is created from the original regulatory filings; it is updated daily and includes all information reported by insiders without alteration.",
  "keywords": [
    "Python", "文本分析", "经济管理", "美股", "另类数据", "内幕交易", "layline insider trading", "pd.read_csv", "pyarrow"
  ],
  "articleBody": "该数据集捕捉了上市公司内幕交易活动。投资者和投资分析师需要这些信息，因为高管、董事和大股东被认为比外界人士更了解其公司的前景。内幕交易中的股票买卖可能揭示了财务报表中未披露的公司业务信息。如果内幕人士能够更好地解读有关公司的公开信息，这些交易还可能传递出预测股价变动的新信息。\n自 2003 年中起，证券交易委员会以结构化格式向公众提供了这些内幕交易报告； 然而，大多数学术论文使用的是商业数据库而非直接的监管文件。这使得复制研究变得困难，因为数据处理和聚合过程不透明，历史记录可能会随着时间被数据库提供商修改。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。\n\n一、 数据集介绍 数据集名: Layline内幕交易数据集(Layline insider trading dataset) 覆盖日期: 2003-06-30 ~ 2023-02-02 数据体积: 解压后35G(截止2023-02-02) 数据来源: https://www.sec.gov/edgar 下载数据: https://www.kaggle.com/datasets/layline/insidertrading 引用数据: Balogh, Attila, 2023, \"Layline insider trading dataset\", https://doi.org/10.7910/DVN/VH6GVH, Harvard Dataverse, V419 本文说明: 科研用途; 如有问题，请加微信372335839，备注「姓名-学校-专业」  Layline项目是一个研究倡议，旨在利用高性能和云计算创建金融经济学领域的公开可访问数据集。它通过民主化数据访问来降低进入门槛，同时也通过促进复制研究增加了该领域的透明度。\n 二、实验代码 一般1G大小的csv，对应着要消耗电脑内 1G ~ 5G 内存 。 该数据集相关文件截图如下， 可以看到文件的体积都比较大。 目前大家使用的电脑，内存参数大多是8G或16G， 少部分同学们使用的32G+。接下来以 lit_footnotes.csv 为例， 简单学下 pd.read_csv 读取技巧。\npd.read_csv(filepath_or_buffer, nrows, usecols, engine=‘pyarrow’, dtype_backend=‘pyarrow’, chunksize)\n filepath_or_buffer csv数据文件路径 nrows 限定读取行数 usecols 选取部分字段进行读取(列表) engine 设置读取引擎， 可选python、c、pyarrow。  其中python为默认方式， 兼容性最佳。 c和pyarrow读取速度较python更快 pyarrow可并行读取，速度最快，但兼容性差，容易报错。   dtype_backend 设置pyarrow后，大大降低python中该数据内存占用量 chunksize 每批次行数； 如果文件体积远超电脑内存时， 可将一个大文件拆分， 分批次读取。  这里设计一个df内存查看函数，单位GB\ndef bytes_to_GB(df): bytes_value = df.memory_usage(deep=True).sum() return round(bytes_value / (1024 ** 3), 2) def bytes_to_MB(df): bytes_value = df.memory_usage(deep=True).sum() return round(bytes_value / (1024 ** 2), 2) \n2.1 nrows 使用 nrows 参数设置只读取前n条记录， 了解csv字段有哪些\nimport pandas as pd #只读取csv中前5条记录 df = pd.read_csv('lit_footnotes.csv', nrows=5) df %%time import pandas as pd #只读取csv中前5条记录 df = pd.read_csv('lit_footnotes.csv') print(f\"内存占用: {bytes_to_GB(df)}GB\") Run\nCPU times: user 35.7 s, sys: 4.55 s, total: 40.3 s Wall time: 37.5 s 内存占用: 10.84 GB \n2.2 usecols 指定某几个字段进行读取\n%%time import pandas as pd #指定某些字段读取 df = pd.read_csv('lit_footnotes.csv', usecols=['filingDate', 'id', 'content']) print(f\"内存占用: {bytes_to_GB(df)}GB\") df Run\n内存占用: 6.95 GB CPU times: user 32.2 s, sys: 1.55 s, total: 33.8 s Wall time: 34.1 s 2.3 engine 可指定 engine=‘pyarrow’, 来提高读取速度。\n%%time import pandas as pd df = pd.read_csv('lit_footnotes.csv', engine='pyarrow') print(f\"内存占用: {bytes_to_GB(df)}GB\") Run\n内存占用: 10.84 GB CPU times: user 23.3 s, sys: 12.6 s, total: 35.9 s Wall time: 19.7 s 注: 有时候使用engine=‘pyarrow’, 容易代码报错， 这时候就只能放弃这个方法乖乖的默认读取。 经大邓实验，本数据集全部csv文件均可正常使用 engine=‘pyarrow’ 。\n2.4 dtype_backend 指定 dtype_backend=‘pyarrow’ 理论上会大大降低内存占用，但读取速度可能不一定提高。\n%%time import pandas as pd df = pd.read_csv('lit_footnotes.csv', dtype_backend='pyarrow') print(f\"内存占用: {bytes_to_GB(df)}GB\") Run\n内存占用: 7.19 GB CPU times: user 44 s, sys: 8 s, total: 52 s Wall time: 53.5 s \n同时指定 engine 和 dtype_backend 两个参数， 会明显提高读取速度。\n%%time import pandas as pd df = pd.read_csv('lit_footnotes.csv', engine='pyarrow', dtype_backend='pyarrow') print(f\"内存占用: {bytes_to_GB(df)}GB\") Run\n内存占用: 7.19 GB CPU times: user 9.88 s, sys: 7.55 s, total: 17.4 s Wall time: 2.12 s \n对比    参数 解析速度 内存占用     pd.read_csv(csvf) 最慢 最大   pd.read_csv(csvf. engine=‘pyarrow’) 较快 中等   pd.read_csv(csvf, engine=‘pyarrow’, dtype_backend=‘pyarrow’) 最快 最小    2.5 chunksize 当探索完前n行，选中某些列，我们已经了解了哪些字段是我们必须要用的， 占用系统内存的大小。\n接下来，我们就可以尝试着按照批次读取数据。\n为了让实验简单高效，我们假设只读取前50000行， 每批次是10000 行。 对比下占用系统内存的量\nimport pandas as pd #一次性读取50000条记录 df = pd.read_csv('lit_footnotes.csv', nrows=50000) print(f\"一次性读取内存占用: {bytes_to_MB(df)}MB\") #分批次读取 #每10000条记录是一个批次，得到chunk_dfs chunk_dfs = pd.read_csv('lit_footnotes.csv', nrows=50000, chunksize=10000) #每个chunk_df就是我们熟悉的dataframe类型数据 for chunk_df in chunk_dfs: print(f\"分批次读取内存占用: {bytes_to_MB(chunk_df)}MB\") Run\n一次性读取内存占用: 23.04 MB 分批次读取内存占用: 4.71 MB 分批次读取内存占用: 4.73 MB 分批次读取内存占用: 4.43 MB 分批次读取内存占用: 4.68 MB 分批次读取内存占用: 4.5 MB \n在实践中，nrows 和 chunksize 不会同时出现， 而且 chunksize 一般都会设置的很大，例如1000000条。\nchunk_dfs = pd.read_csv('csv文件', chunksize=1000000) 看到 chunk_dfs 也不要害怕，其实每个 chunk_df 就是我们熟悉的 df ，即dataframe数据类型。\n三、总结 记住这行代码\npd.read_csv(csvf, nrows, usecols, engine, dtype_backend, chunksize) 8G内存的电脑， 通过以上技巧，基本可以把我们应对大数据的潜力放大N倍。 N可以是几倍、十几倍、几十倍、上百倍…，放大潜力的过程\n usecols 和 chunksize 起主要作用，百试百爽，稳定不出错。 engine 和 dtype_backend 提高读取速度并降低内存占用，但代码容易出错。 chunksize、nrows 参数不能与 engine、dtype_backend同时使用。  \n相关内容  付费视频课 | Python实证指标构建与文本分析 推荐 | 如何处理远超电脑内存的csv文件 LIST | 可供社科(经管)领域使用的科研数据集清单 LIST | 社科(经管)数据挖掘文献资料汇总  \n 点击了解课程详情   ",
  "wordCount" : "425",
  "inLanguage": "en",
  "image":"/images/blog/chinese_emobank.png","datePublished": "2025-03-11T00:00:00Z",
  "dateModified": "2025-03-11T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "大邓"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/blog/2025-03-11-layline-insider-trading-dataset/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "大邓和他的PYTHON",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SFGQCREQ9X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SFGQCREQ9X');
</script>



<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=PT+Serif" rel="stylesheet">
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="大邓和他的PYTHON (Alt + H)" target="_blank">大邓和他的PYTHON</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/about/" title="关于" target="_blank">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="/archives/" title="归档" target="_blank">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="/search/" title="搜索" target="_blank">
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="标签" target="_blank">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/blog/management_python_course/" title="课程" target="_blank">
                    <span>课程</span>
                </a>
            </li>
            <li>
                <a href="/blog/the_text_analysis_list_about_ms/" title="文献" target="_blank">
                    <span>文献</span>
                </a>
            </li>
            <li>
                <a href="/blog/datasets_available_for_management_science/" title="数据" target="_blank">
                    <span>数据</span>
                </a>
            </li>
            <li>
                <a href="/blog/2024-04-27-cntext2x-usage-tutorial/" title="cntext2.x" target="_blank">
                    <span>cntext2.x</span>
                </a>
            </li>
            <li>
                <a href="/index.xml" title="RSS" target="_blank">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
onload="renderMathInElement(document.body);"></script>




<article class="post-single">
  <header class="post-header">
    
    <div class="breadcrumbs"><a href="/" target="_blank">Home</a>&nbsp;»&nbsp;<a href="/blog/" target="_blank">Blogs</a></div>
    <h1 class="post-title">
      数据集 | Layline美股内幕交易数据集
    </h1>
    <div class="post-meta"><span title='2025-03-11 00:00:00 +0000 UTC'>2025-03-11</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;大邓

</div>
  </header> 
<figure class="entry-cover"><a href="/images/blog/chinese_emobank.png" target="_blank"
            rel="noopener noreferrer"><img loading="lazy" src="/images/blog/chinese_emobank.png" alt=""></a>
        
</figure>
<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on twitter"
        href="https://twitter.com/intent/tweet/?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&amp;hashtags=pandas%2c%e6%95%b0%e6%8d%ae%e9%9b%86">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&amp;title=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;summary=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;source=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on reddit"
        href="https://reddit.com/submit?url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&title=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on whatsapp"
        href="https://api.whatsapp.com/send?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86%20-%20%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on telegram"
        href="https://telegram.me/share/url?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
    
</div>
<aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e4%b8%80-%e6%95%b0%e6%8d%ae%e9%9b%86%e4%bb%8b%e7%bb%8d" aria-label="一、 数据集介绍">一、 数据集介绍</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e5%ae%9e%e9%aa%8c%e4%bb%a3%e7%a0%81" aria-label="二、实验代码">二、实验代码</a><ul>
                            
                    <li>
                        <a href="#21-nrows" aria-label="2.1 nrows">2.1 nrows</a></li>
                    <li>
                        <a href="#22-usecols" aria-label="2.2 usecols">2.2 usecols</a></li>
                    <li>
                        <a href="#23-engine" aria-label="2.3 engine">2.3 engine</a></li>
                    <li>
                        <a href="#24-dtype_backend" aria-label="2.4 dtype_backend">2.4 dtype_backend</a></li>
                    <li>
                        <a href="#%e5%af%b9%e6%af%94" aria-label="对比">对比</a></li>
                    <li>
                        <a href="#25-chunksize" aria-label="2.5 chunksize">2.5 chunksize</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%b8%89%e6%80%bb%e7%bb%93" aria-label="三、总结">三、总结</a></li>
                    <li>
                        <a href="#%e7%9b%b8%e5%85%b3%e5%86%85%e5%ae%b9" aria-label="相关内容">相关内容</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><p>该数据集捕捉了上市公司内幕交易活动。投资者和投资分析师需要这些信息，因为高管、董事和大股东被认为比外界人士更了解其公司的前景。内幕交易中的股票买卖可能揭示了财务报表中未披露的公司业务信息。如果内幕人士能够更好地解读有关公司的公开信息，这些交易还可能传递出预测股价变动的新信息。</p>
<p>自 2003 年中起，证券交易委员会以结构化格式向公众提供了这些内幕交易报告； 然而，大多数学术论文使用的是商业数据库而非直接的监管文件。这使得复制研究变得困难，因为数据处理和聚合过程不透明，历史记录可能会随着时间被数据库提供商修改。为了克服这些限制，本数据集是从原始监管文件创建的；它每天更新，并包括内幕人士报告的所有信息，未经修改。</p>
<p><br><br></p>
<h2 id="一-数据集介绍">一、 数据集介绍<a hidden class="anchor" aria-hidden="true" href="#一-数据集介绍">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">数据集名:  Layline内幕交易数据集(Layline insider trading dataset)
覆盖日期: 2003-06-30 ~ 2023-02-02
数据体积:  解压后35G(截止2023-02-02)
数据来源: https://www.sec.gov/edgar
下载数据:  https://www.kaggle.com/datasets/layline/insidertrading
引用数据:  Balogh, Attila, 2023, &#34;Layline insider trading dataset&#34;, https://doi.org/10.7910/DVN/VH6GVH, Harvard Dataverse, V419
本文说明: 科研用途; 如有问题，请加微信372335839，备注「姓名-学校-专业」
</code></pre></div><p><img loading="lazy" src="img/01-harvard.png" alt=""  />
</p>
<br>
<blockquote>
<p>Layline项目是一个研究倡议，旨在利用高性能和云计算创建金融经济学领域的公开可访问数据集。它通过民主化数据访问来降低进入门槛，同时也通过促进复制研究增加了该领域的透明度。</p>
</blockquote>
<p><img loading="lazy" src="img/05-layline.png" alt=""  />
</p>
<br>
<br>
<h2 id="二实验代码">二、实验代码<a hidden class="anchor" aria-hidden="true" href="#二实验代码">#</a></h2>
<p><strong>一般1G大小的csv，对应着要消耗电脑内 1G ~ 5G 内存</strong> 。 该数据集相关文件截图如下， 可以看到文件的体积都比较大。 目前大家使用的电脑，内存参数大多是8G或16G， 少部分同学们使用的32G+。接下来以 <em><strong>lit_footnotes.csv</strong></em> 为例， 简单学下 <em><strong>pd.read_csv</strong></em> 读取技巧。</p>
<p><img loading="lazy" src="img/02-screen.png" alt=""  />
</p>
<p><strong>pd.read_csv(filepath_or_buffer, nrows, usecols, engine=&lsquo;pyarrow&rsquo;, dtype_backend=&lsquo;pyarrow&rsquo;,  chunksize)</strong></p>
<ul>
<li><em><strong>filepath_or_buffer</strong></em>   csv数据文件路径</li>
<li><em><strong>nrows</strong></em>  限定读取行数</li>
<li><em><strong>usecols</strong></em> 选取部分字段进行读取(列表)</li>
<li><em><strong>engine</strong></em>  设置读取引擎， 可选python、c、pyarrow。
<ul>
<li>其中python为默认方式， 兼容性最佳。</li>
<li>c和pyarrow读取速度较python更快</li>
<li>pyarrow可并行读取，速度最快，但兼容性差，容易报错。</li>
</ul>
</li>
<li><em><strong>dtype_backend</strong></em>  设置pyarrow后，大大降低python中该数据内存占用量</li>
<li><em><strong>chunksize</strong></em>  每批次行数； 如果文件体积远超电脑内存时， 可将一个大文件拆分， 分批次读取。</li>
</ul>
<br>
<p>这里设计一个df内存查看函数，单位GB</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>  
    <span class="n">bytes_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">bytes_value</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">**</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  
  
  
<span class="k">def</span> <span class="nf">bytes_to_MB</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>  
    <span class="n">bytes_value</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">bytes_value</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  
</code></pre></div><br>
<h3 id="21-nrows">2.1 nrows<a hidden class="anchor" aria-hidden="true" href="#21-nrows">#</a></h3>
<p>使用 <em><strong>nrows</strong></em> 参数设置只读取前n条记录， 了解csv字段有哪些</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#只读取csv中前5条记录</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><p><img loading="lazy" src="img/03-df.png" alt=""  />
</p>
<br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#只读取csv中前5条记录</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;内存占用: </span><span class="si">{</span><span class="n">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> GB&#34;</span><span class="p">)</span> 
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">CPU times: user 35.7 s, sys: 4.55 s, total: 40.3 s
Wall time: 37.5 s

内存占用: 10.84 GB
</code></pre></div><br>
<h3 id="22-usecols">2.2 usecols<a hidden class="anchor" aria-hidden="true" href="#22-usecols">#</a></h3>
<p>指定某几个字段进行读取</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#指定某些字段读取</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;filingDate&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;内存占用: </span><span class="si">{</span><span class="n">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> GB&#34;</span><span class="p">)</span> 
<span class="n">df</span>
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">内存占用: 6.95 GB
CPU times: user 32.2 s, sys: 1.55 s, total: 33.8 s
Wall time: 34.1 s
</code></pre></div><p><img loading="lazy" src="img/04-df.png" alt=""  />
</p>
<br>
<h3 id="23-engine">2.3 engine<a hidden class="anchor" aria-hidden="true" href="#23-engine">#</a></h3>
<p>可指定 <em><strong>engine=&lsquo;pyarrow&rsquo;</strong></em>,  来提高读取速度。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;内存占用: </span><span class="si">{</span><span class="n">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> GB&#34;</span><span class="p">)</span> 
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">内存占用: 10.84 GB
CPU times: user 23.3 s, sys: 12.6 s, total: 35.9 s
Wall time: 19.7 s
</code></pre></div><p><strong>注: 有时候使用engine=&lsquo;pyarrow&rsquo;, 容易代码报错， 这时候就只能放弃这个方法乖乖的默认读取。</strong> 经大邓实验，本数据集全部csv文件均可正常使用 <em><strong>engine=&lsquo;pyarrow&rsquo;</strong></em> 。</p>
<br>
<h3 id="24-dtype_backend">2.4 dtype_backend<a hidden class="anchor" aria-hidden="true" href="#24-dtype_backend">#</a></h3>
<p>指定 <em><strong>dtype_backend=&lsquo;pyarrow&rsquo;</strong></em> 理论上会大大降低内存占用，但读取速度可能不一定提高。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">dtype_backend</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;内存占用: </span><span class="si">{</span><span class="n">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> GB&#34;</span><span class="p">)</span> 
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">内存占用: 7.19 GB
CPU times: user 44 s, sys: 8 s, total: 52 s
Wall time: 53.5 s
</code></pre></div><br>
<p>同时指定 <em><strong>engine</strong></em> 和 <em><strong>dtype_backend</strong></em> 两个参数， 会明显提高读取速度。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">,</span> <span class="n">dtype_backend</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;内存占用: </span><span class="si">{</span><span class="n">bytes_to_GB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> GB&#34;</span><span class="p">)</span> 
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">内存占用: 7.19 GB
CPU times: user 9.88 s, sys: 7.55 s, total: 17.4 s
Wall time: 2.12 s
</code></pre></div><br>
<h3 id="对比">对比<a hidden class="anchor" aria-hidden="true" href="#对比">#</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>解析速度</th>
<th>内存占用</th>
</tr>
</thead>
<tbody>
<tr>
<td><em><strong>pd.read_csv(csvf)</strong></em></td>
<td>最慢</td>
<td>最大</td>
</tr>
<tr>
<td><em><strong>pd.read_csv(csvf. engine=&lsquo;pyarrow&rsquo;)</strong></em></td>
<td>较快</td>
<td>中等</td>
</tr>
<tr>
<td><em><strong>pd.read_csv(csvf, engine=&lsquo;pyarrow&rsquo;, dtype_backend=&lsquo;pyarrow&rsquo;)</strong></em></td>
<td><strong>最快</strong></td>
<td><strong>最小</strong></td>
</tr>
</tbody>
</table>
<br>
<h3 id="25-chunksize">2.5 chunksize<a hidden class="anchor" aria-hidden="true" href="#25-chunksize">#</a></h3>
<p>当探索完前n行，选中某些列，我们已经了解了哪些字段是我们必须要用的， 占用系统内存的大小。</p>
<p>接下来，我们就可以尝试着按照批次读取数据。</p>
<p>为了让实验简单高效，我们假设只读取前50000行， 每批次是10000 行。 对比下占用系统内存的量</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#一次性读取50000条记录</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;一次性读取内存占用: </span><span class="si">{</span><span class="n">bytes_to_MB</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> MB&#34;</span><span class="p">)</span> 


<span class="c1">#分批次读取</span>
<span class="c1">#每10000条记录是一个批次，得到chunk_dfs</span>
<span class="n">chunk_dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;lit_footnotes.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1">#每个chunk_df就是我们熟悉的dataframe类型数据</span>
<span class="k">for</span> <span class="n">chunk_df</span> <span class="ow">in</span> <span class="n">chunk_dfs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;分批次读取内存占用: </span><span class="si">{</span><span class="n">bytes_to_MB</span><span class="p">(</span><span class="n">chunk_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> MB&#34;</span><span class="p">)</span> 
</code></pre></div><p>Run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">一次性读取内存占用: 23.04 MB
分批次读取内存占用: 4.71 MB
分批次读取内存占用: 4.73 MB
分批次读取内存占用: 4.43 MB
分批次读取内存占用: 4.68 MB
分批次读取内存占用: 4.5 MB
</code></pre></div><br>
<p>在实践中，<em><strong>nrows</strong></em>  和 <em><strong>chunksize</strong></em> 不会同时出现， 而且 <em><strong>chunksize</strong></em> 一般都会设置的很大，例如1000000条。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">chunk_dfs = pd.read_csv(&#39;csv文件&#39;, chunksize=1000000)
</code></pre></div><p>看到 <em><strong>chunk_dfs</strong></em> 也不要害怕，其实每个 <em><strong>chunk_df</strong></em> 就是我们熟悉的 <em><strong>df</strong></em> ，即dataframe数据类型。</p>
<br>
<br>
<h2 id="三总结">三、总结<a hidden class="anchor" aria-hidden="true" href="#三总结">#</a></h2>
<p>记住这行代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pd.read_csv(csvf, nrows, usecols, engine, dtype_backend, chunksize)
</code></pre></div><p>8G内存的电脑， 通过以上技巧，基本可以把我们应对大数据的潜力放大N倍。  N可以是几倍、十几倍、几十倍、上百倍&hellip;，<strong>放大潜力的过程</strong></p>
<ul>
<li><em><strong>usecols</strong></em> 和 <em><strong>chunksize</strong></em>  起主要作用，百试百爽，稳定不出错。</li>
<li><em><strong>engine</strong></em>  和  <em><strong>dtype_backend</strong></em>  提高读取速度并降低内存占用，但代码容易出错。</li>
<li><em><strong>chunksize</strong></em>、<em><strong>nrows</strong></em> 参数不能与 <em><strong>engine</strong></em>、<em><strong>dtype_backend</strong></em>同时使用。</li>
</ul>
<p><br><br></p>
<h2 id="相关内容">相关内容<a hidden class="anchor" aria-hidden="true" href="#相关内容">#</a></h2>
<ul>
<li><a href="https://textdata.cn/blog/management_python_course/">付费视频课 | Python实证指标构建与文本分析</a></li>
<li><a href="https://textdata.cn/blog/2023-11-17-how-handle-mega-csv-that-far-exceed-memory/">推荐 | 如何处理远超电脑内存的csv文件</a></li>
<li><a href="https://textdata.cn/blog/datasets_available_for_management_science/">LIST | 可供社科(经管)领域使用的科研数据集清单</a></li>
<li><a href="https://textdata.cn/blog/the_text_analysis_list_about_ms/">LIST | 社科(经管)数据挖掘文献资料汇总</a></li>
</ul>
<p><br><br></p>
<div style="text-align: center;">
<figure >
    <a href="https://textdata.cn/blog/management_python_course/">
        <img src="/images/bg/management_data_mining_with_python_course2.png" width="100%" />
    </a>
    <figcaption><small><i>点击了解课程详情</i></small></figcaption>
</figure>
</div>


  </div>

  <footer class="post-footer">
      <ul class="post-tags">
        <b>Tags:  &nbsp;</b>
        <li><a href="/tags/pandas/" target='_blank'>pandas</a></li>
        <li><a href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" target='_blank'>数据集</a></li>
      </ul>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on twitter"
        href="https://twitter.com/intent/tweet/?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&amp;hashtags=pandas%2c%e6%95%b0%e6%8d%ae%e9%9b%86">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&amp;title=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;summary=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;source=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on reddit"
        href="https://reddit.com/submit?url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f&title=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on whatsapp"
        href="https://api.whatsapp.com/send?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86%20-%20%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 数据集 | Layline美股内幕交易数据集 on telegram"
        href="https://telegram.me/share/url?text=%e6%95%b0%e6%8d%ae%e9%9b%86%20%7c%20Layline%e7%be%8e%e8%82%a1%e5%86%85%e5%b9%95%e4%ba%a4%e6%98%93%e6%95%b0%e6%8d%ae%e9%9b%86&amp;url=%2fblog%2f2025-03-11-layline-insider-trading-dataset%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
    
</div>




  </footer><script src="https://utteranc.es/client.js"
        repo="hiDaDeng/hidadeng.github.io"
        issue-term="pathname"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>

  
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="/">大邓和他的PYTHON</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'Copy';

        function copyingDone() {
            copybutton.innerText = 'Copied!';
            setTimeout(() => {
                copybutton.innerText = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>


    
    
</body>

</html>
