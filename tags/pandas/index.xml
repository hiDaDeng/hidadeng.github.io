<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>pandas on å¤§é‚“å’Œä»–çš„PYTHON</title>
    <link>/tags/pandas/</link>
    <description>Recent content in pandas on å¤§é‚“å’Œä»–çš„PYTHON</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Fri, 01 Apr 2022 10:43:10 +0600</lastBuildDate><atom:link href="/tags/pandas/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>BloxsåŒ… | å¯åœ¨notebookä¸­ä½¿ç”¨çš„äº¤äº’å¯è§†åŒ–åŒ…</title>
      <link>https://hidadeng.github.io/blog/bloxs_interactive_visualization/</link>
      <pubDate>Fri, 01 Apr 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/bloxs_interactive_visualization/</guid>
      <description>Bloxsæ˜¯ä¸€ä¸ªç®€å•çš„ python å¯äº¤äº’çš„å¯è§†åŒ–åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä»¥ä¸€ç§æœ‰å¸å¼•åŠ›çš„æ–¹å¼ï¼ˆä»¥å—å½¢å¼ï¼‰æ˜¾ç¤ºä¿¡æ¯ã€‚ éå¸¸é€‚åˆåœ¨ç¬”è®°æœ¬ä¸­æ„å»ºä»ªè¡¨æ¿ã€æŠ¥å‘Šå’Œåº”ç”¨ç¨‹åºã€‚</description>
      <content:encoded><![CDATA[<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<br>
<p>Bloxsæ˜¯ä¸€ä¸ªç®€å•çš„ python å¯äº¤äº’çš„å¯è§†åŒ–åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä»¥ä¸€ç§æœ‰å¸å¼•åŠ›çš„æ–¹å¼ï¼ˆä»¥å—å½¢å¼ï¼‰æ˜¾ç¤ºä¿¡æ¯ã€‚ éå¸¸é€‚åˆåœ¨ç¬”è®°æœ¬ä¸­æ„å»ºä»ªè¡¨æ¿ã€æŠ¥å‘Šå’Œåº”ç”¨ç¨‹åºã€‚</p>
<p>å®ƒé€‚ç”¨äºï¼šJupyter Notebookã€Google Colabã€Deepnoteã€Kaggle Notebookã€<a href="https://github.com/mljar/mercury">Mercury</a>ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_demo.gif" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pip3 install bloxs
</code></pre></div><br>
<h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">from bloxs import B
B(1234, &#34;Bloxs in notebook!&#34;)
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/test_bloxs.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="æ¡ˆä¾‹">æ¡ˆä¾‹</h2>
<table>
<thead>
<tr>
<th>Bloxs</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td><img loading="lazy" src="img/number.png" alt=""  />
</td>
<td><code>B(1234, &quot;Bloxs in notebook!&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/percent.png" alt=""  />
</td>
<td><code>B(1999, &quot;Percent change!&quot;, percent_change=10)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/emojis.png" alt=""  />
</td>
<td><code>B(&quot;ğŸ‰ğŸ‰ğŸ‰&quot;, &quot;Works with emojis&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/progress.png" alt=""  />
</td>
<td><code>B(&quot;68%&quot;, &quot;Loading progress&quot;, progress=68)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/progress_color.png" alt=""  />
</td>
<td><code>B(&quot;68%&quot;, &quot;Loading progress&quot;, progress=68, color=&quot;green&quot;)</code> é¢œè‰²colorå‚æ•°å¯ä»¥è®¾ä¸º&quot;blue&quot;, &ldquo;red&rdquo;, &ldquo;green&rdquo; æˆ–åå…­è¿›åˆ¶è¡¨ç¤º (ä¾‹å¦‚&quot;#fa33fa&quot;)</td>
</tr>
<tr>
<td><img loading="lazy" src="img/line_chart.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display line chart&quot;, points=[1,4,2,3,5,6])</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/line_chart_color.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display line chart&quot;, points=[1,4,2,3,5,6], color=&quot;red&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/stepped.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display stepped chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;stepped&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/bar_chart.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display bar chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;bar&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/bar_chart_color.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display bar chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;bar&quot;, color=&quot;green&quot;)</code></td>
</tr>
</tbody>
</table>
<br>
<p>å¯ä»¥åœ¨ä¸€è¡Œå†…æ•´åˆå¤šä¸ªå›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">B([
    B(1999, &#34;Percent change!&#34;, percent_change=10),
    B(&#34;ğŸ‰ğŸ‰ğŸ‰&#34;, &#34;Works with emojis&#34;),
    B(&#34;68%&#34;, &#34;Loading progress&#34;, progress=68),
    B(1234, &#34;Bloxs in notebook!&#34;)
])
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/several_bloxs_2.png" width="100%" />
    
    
</figure>
</div>
<br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">B([
    B(&#34;786&#34;, &#34;Display bar chart&#34;, points=[1,4,2,3,5,6], chart_type=&#34;bar&#34;, color=&#34;green&#34;),
    B(&#34;123&#34;, &#34;Display line chart&#34;, points=[1,4,2,3,5,6], color=&#34;red&#34;),
    B(&#34;123&#34;, &#34;Display stepped chart&#34;, points=[1,4,2,3,5,6], chart_type=&#34;stepped&#34;)
])
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/several_bloxs.png" width="100%" />
    
    
</figure>
</div>
<br>
<p>å¦‚æœæƒ³åœ¨è‡ªå·±ç”µè„‘ä¸­å®éªŒä¸Šè¿°ä»£ç ï¼Œå¯ä»¥ç‚¹å‡» <a href="https://deepnote.com/project/bloxs-ZNGnsap0R7ea8LeZY0uarQ/%2Fnotebook.ipynb">notebook</a> ä¸‹è½½ã€‚</p>
<br>
<h2 id="ç»“åˆmercuryç”¨bloxs">ç»“åˆMercuryç”¨Bloxs</h2>
<p><a href="https://github.com/mljar/mercury">Mercury</a> æ˜¯ä¸€ä¸ªç”¨äºå°†ç¬”è®°æœ¬è½¬æ¢ä¸ºäº¤äº’å¼ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ å®ƒåŸºäº YAML é…ç½®å°†å°éƒ¨ä»¶æ·»åŠ åˆ°ç¬”è®°æœ¬ä¸­ã€‚ ä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªå¸¦æœ‰ bloxs çš„ç¬”è®°æœ¬ï¼Œä»¥åŠä½œä¸º Mercury çš„ Web åº”ç”¨ç¨‹åºçš„åŒä¸€ç¬”è®°æœ¬ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_notebook.gif" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="mercuryç½‘é¡µåº”ç”¨">Mercuryç½‘é¡µåº”ç”¨</h2>
<p><a href="https://mercury.mljar.com/app/5">Demo</a></p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_mercury.gif" width="100%" />
    
    
</figure>
</div>
<p><br><br></p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>pyjanitoræ•°æ®åˆ†ææ¸…æ´åŒ…</title>
      <link>https://hidadeng.github.io/blog/pyjanitor_tutorial/</link>
      <pubDate>Thu, 25 Nov 2021 23:10:10 +0600</pubDate>
      
      <guid>/blog/pyjanitor_tutorial/</guid>
      <description>æ¸…æ´—æ•°æ®ï¼Œä¹Ÿç®€æ´ä»£ç </description>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="https://pyjanitor-devs.github.io/pyjanitor/">official docs</a></p>
</li>
<li>
<p><a href="https://github.com/pyjanitor-devs/pyjanitor">github</a></p>
</li>
</ul>
<br>
<p>pyjanitoræ˜¯å‚ç…§Rè¯­è¨€janitoråŒ…è¯­æ³•ï¼Œä¸ºPythoné‡èº«å®šåˆ¶çš„æ•°æ®æ¸…æ´—åŒ…,å³å¯æ¸…æ´—æ•°æ®ï¼Œåˆå¯è®©ä»£ç ç®€æ´å¹²å‡€ã€‚</p>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="pyjanitor_tutorial.ipynb">click to download the code</a></p>
<br>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyjanitor</span>
</code></pre></div><br>
<h2 id="ä¸ºä»€ä¹ˆç”¨janitor">ä¸ºä»€ä¹ˆç”¨janitorï¼Ÿ</h2>
<p>æ•°æ®é¢„å¤„ç†é€šå¸¸ç”±ä¸€ç³»åˆ—æ­¥éª¤ç»„æˆï¼Œè¿™äº›æ­¥éª¤æ¶‰åŠå°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºå¯ç†è§£/å¯ç”¨çš„æ ¼å¼ã€‚è¿™ä¸€ç³»åˆ—çš„æ­¥éª¤éœ€è¦æŒ‰ç…§ä¸€å®šçš„é¡ºåºè¿è¡Œæ‰èƒ½æˆåŠŸã€‚æˆ‘ä»¬ä»¥åŸºç¡€æ•°æ®æ–‡ä»¶ä¸ºèµ·ç‚¹ï¼Œå¯¹å…¶æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚åˆ é™¤ç©ºè¡Œ/ç©ºè¡Œã€ç”¨å…¶ä»–å€¼æ›¿æ¢å®ƒä»¬ã€æ·»åŠ /é‡å‘½å/åˆ é™¤æ•°æ®åˆ—ã€è¿‡æ»¤è¡Œç­‰ã€‚æ›´æ­£å¼åœ°è¯´ï¼Œè¿™äº›æ­¥éª¤ä»¥åŠå®ƒä»¬çš„å…³ç³»å’Œä¾èµ–å…³ç³»é€šå¸¸è¢«ç§°ä¸ºæœ‰å‘æ— ç¯å›¾ (DAG)ã€‚</p>
<p>pandas API å¯¹ Python æ•°æ®ç§‘å­¦ç”Ÿæ€ç³»ç»Ÿéå¸¸å®è´µï¼Œå®ƒå®ç°äº†æ–¹æ³•å­é›†çš„æ–¹æ³•é“¾ä½œä¸º API çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œé‡ç½®ç´¢å¼• (.reset_index())ã€åˆ é™¤ç©ºå€¼ (.dropna()) ç­‰éƒ½æ˜¯é€šè¿‡é€‚å½“çš„ pd.DataFrame æ–¹æ³•è°ƒç”¨æ¥å®Œæˆçš„ã€‚</p>
<p>å— R ç»Ÿè®¡è¯­è¨€ç”Ÿæ€ç³»ç»Ÿ dplyr åŒ…çš„æ˜“ç”¨æ€§å’Œè¡¨è¾¾èƒ½åŠ›çš„å¯å‘ï¼Œæˆ‘ä»¬å°† pyjanitor å¼€å‘ä¸ºè¯­æ³•åŒ…ï¼Œç”¨äºä¸º Pandas ç”¨æˆ·è¡¨è¾¾æ•°æ®å¤„ç† DAGã€‚</p>
<p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨å£°æ˜å¼çš„æ“ä½œ æ›¿æ¢ä¸ºå…è®¸ é€»è¾‘é¡ºåºçš„æ–¹æ³•é“¾ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢å¸¦æ³¨é‡Šçš„ç¤ºä¾‹ã€‚é¦–å…ˆï¼Œè¿™é‡Œæ˜¯æ•°æ®æ¸…ç†è·¯å¾„çš„æ–‡å­—æè¿°ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªdataframeã€‚</li>
<li>åˆ é™¤ä¸€åˆ—ã€‚</li>
<li>åˆ é™¤ä¸¤ä¸ªç‰¹å®šåˆ—ä¸­å…·æœ‰ç©ºå€¼çš„è¡Œã€‚</li>
<li>é‡å‘½åå¦å¤–ä¸¤åˆ—ã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªæ–°åˆ—ã€‚</li>
</ol>
<p>è®©æˆ‘ä»¬å¯¼å…¥ä¸€äº›åº“å¹¶ä»æœ¬ç¤ºä¾‹çš„ä¸€äº›ç¤ºä¾‹æ•°æ®å¼€å§‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span>

<span class="c1"># Sample Data curated for this example</span>
<span class="n">company_sales</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;SalesMonth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Company1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">],</span>
    <span class="s1">&#39;Company2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">],</span>
    <span class="s1">&#39;Company3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">400.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">675.0</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div><br>
<h2 id="å¸¸è§çš„pandaså®ç°æ–¹å¼">å¸¸è§çš„Pandaså®ç°æ–¹å¼</h2>
<p>ä¸‹é¢æ˜¯ä¼ ç»Ÿçš„Pandasæ–¹å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The Pandas Way</span>

<span class="c1"># 1. åˆ›å»ºä¸€ä¸ªdataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_sales</span><span class="p">)</span>

<span class="c1"># 2.åˆ é™¤ä¸€åˆ—ã€‚ Say &#39;Company1&#39;</span>
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Company1&#39;</span><span class="p">]</span>

<span class="c1"># 3. åˆ é™¤ä¸¤ä¸ªç‰¹å®šåˆ—ä¸­å…·æœ‰ç©ºå€¼çš„è¡Œã€‚ &#39;Company2&#39; and &#39;Company3&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Company2&#39;</span><span class="p">,</span> <span class="s1">&#39;Company3&#39;</span><span class="p">])</span>

<span class="c1"># 4. é‡å‘½åå¦å¤–ä¸¤åˆ—ã€‚ å°†&#39;Company2&#39; æ”¹ä¸º &#39;Amazon&#39;ï¼› å°† &#39;Company3&#39; æ”¹ä¸º &#39;Facebook&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Company2&#39;</span><span class="p">:</span> <span class="s1">&#39;Amazon&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Company3&#39;</span><span class="p">:</span> <span class="s1">&#39;Facebook&#39;</span><span class="p">},</span>
               <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 5. æ·»åŠ ä¸€ä¸ªæ–°åˆ— &#39;Google&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Google&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">450.0</span><span class="p">,</span> <span class="mf">550.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">]</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown">|      | SalesMonth | Amazon | Facebook | Google |
| ---: | :--------- | -----: | -------: | -----: |
|    0 | Jan        |    180 |      400 |    450 |
|    1 | Feb        |    250 |      500 |    550 |
|    3 | April      |    500 |      675 |    800 |
</code></pre></div><br>
<h2 id="ç¨å¾®é«˜çº§ä¸€ç‚¹pandaså®ç°æ–¹å¼">ç¨å¾®é«˜çº§ä¸€ç‚¹Pandaså®ç°æ–¹å¼</h2>
<p>ç¨å¾®é«˜çº§ä¸€ç‚¹çš„ç”¨æˆ·å¯èƒ½ä¼šåˆ©ç”¨å‡½æ•°å¼ APIï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_sales</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&#34;Company1&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Company2&#34;</span><span class="p">,</span> <span class="s2">&#34;Company3&#34;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;Company2&#34;</span><span class="p">:</span> <span class="s2">&#34;Amazon&#34;</span><span class="p">,</span> <span class="s2">&#34;Company3&#34;</span><span class="p">:</span><span class="s2">&#34;Facebook&#34;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Google</span><span class="o">=</span><span class="p">[</span><span class="mf">450.0</span><span class="p">,</span> <span class="mf">550.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown">|      | SalesMonth | Amazon | Facebook | Google |
| ---: | :--------- | -----: | -------: | -----: |
|    0 | Jan        |    180 |      400 |    450 |
|    1 | Feb        |    250 |      500 |    550 |
|    3 | April      |    500 |      675 |    800 |
</code></pre></div><br>
<h2 id="pyjanitorå®ç°æ–¹å¼">PyJanitorå®ç°æ–¹å¼</h2>
<p>å€ŸåŠ©pyjanitoråº“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ³•åé“¾å¼ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_sales</span><span class="p">)</span>
    <span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="s1">&#39;Company1&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Company2&#34;</span><span class="p">,</span> <span class="s2">&#34;Company3&#34;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&#34;Company2&#34;</span><span class="p">,</span> <span class="s2">&#34;Amazon&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&#34;Company3&#34;</span><span class="p">,</span> <span class="s2">&#34;Facebook&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&#34;Google&#34;</span><span class="p">,</span> <span class="p">[</span><span class="mf">450.0</span><span class="p">,</span> <span class="mf">550.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">])</span>

<span class="p">)</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown">|      | SalesMonth | Amazon | Facebook | Google |
| ---: | :--------- | -----: | -------: | -----: |
|    0 | Jan        |    180 |      400 |    450 |
|    1 | Feb        |    250 |      500 |    550 |
|    3 | April      |    500 |      675 |    800 |
</code></pre></div><p>å› æ­¤ï¼Œpyjanitor çš„è¯æºä¸â€œæ¸…æ´åº¦â€æœ‰åŒé‡å…³ç³»ã€‚ é¦–å…ˆï¼Œå®ƒæ˜¯å…³äºä½¿ç”¨æ–¹ä¾¿çš„æ•°æ®æ¸…ç†ä¾‹ç¨‹æ‰©å±• Pandasã€‚ å…¶æ¬¡ï¼Œå®ƒæ˜¯å…³äºä¸ºå¸¸è§çš„ Pandas ä¾‹ç¨‹æä¾›æ›´æ¸…æ™°ã€æ–¹æ³•é“¾æ¥ã€åŸºäºåŠ¨è¯çš„ APIã€‚</p>
<br>
<h2 id="pyjanitoræ›´å¤šåŠŸèƒ½">pyjanitoræ›´å¤šåŠŸèƒ½</h2>
<ul>
<li>æ¸…ç†åˆ—åï¼ˆå¤šç´¢å¼•æ˜¯å¯èƒ½çš„ï¼ï¼‰</li>
<li>åˆ é™¤ç©ºè¡Œå’Œåˆ—</li>
<li>è¯†åˆ«é‡å¤æ¡ç›®</li>
<li>å°†åˆ—ç¼–ç ä¸ºåˆ†ç±»</li>
<li>å°†æ•°æ®æ‹†åˆ†ä¸ºç‰¹å¾å’Œç›®æ ‡ï¼ˆç”¨äºæœºå™¨å­¦ä¹ ï¼‰</li>
<li>æ·»åŠ ã€åˆ é™¤å’Œé‡å‘½ååˆ—</li>
<li>å°†å¤šåˆ—åˆå¹¶ä¸ºä¸€åˆ—</li>
<li>æ—¥æœŸè½¬æ¢ï¼ˆä» matlabã€excelã€unixï¼‰åˆ° Python æ—¥æœŸæ—¶é—´æ ¼å¼</li>
<li>å°†å…·æœ‰åˆ†éš”çš„åˆ†ç±»å€¼çš„å•ä¸ªåˆ—æ‰©å±•ä¸ºè™šæ‹Ÿç¼–ç å˜é‡</li>
<li>åŸºäºåˆ†éš”ç¬¦è¿æ¥å’Œåˆ†ç¦»åˆ—</li>
<li>ç”¨äºæ ¹æ®åˆ—ä¸Šçš„æŸ¥è¯¢è¿‡æ»¤æ•°æ®æ¡†çš„è¯­æ³•ç³–</li>
<li>é‡‘èã€ç”Ÿç‰©ã€åŒ–å­¦ã€å·¥ç¨‹å’Œ pyspark çš„å®éªŒå­æ¨¡å—</li>
</ul>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>æ•°æ®åˆ†æplydataåº“</title>
      <link>https://hidadeng.github.io/blog/plydata/</link>
      <pubDate>Mon, 22 Nov 2021 22:40:10 +0600</pubDate>
      
      <guid>/blog/plydata/</guid>
      <description>è®©æ•°æ®åˆ†æçš„ä»£ç æ›´ç®€æ´</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90plydata%E5%BA%93%E5%AD%A6%E4%B9%A0.zip">https://github.com/hidadeng/DaDengAndHisPython/blob/master/æ•°æ®åˆ†æplydataåº“å­¦ä¹ .zip</a></p>
<p>plydataæ˜¯ä¸€ä¸ªæä¾›æ•°æ®å¤„ç†è¯­æ³•çš„Pythonåº“ï¼Œå€Ÿé‰´äº†Rè¯­è¨€dplyrï¼Œtidyrå’Œforcatsç­‰åŒ…ä¸­çš„ç®¡é“æ“ä½œç¬¦ã€‚</p>
<p>plydataä½¿ç”¨ <code>&gt;&gt;è¿ç®—ç¬¦</code> ä½œä¸ºç®¡é“ç¬¦å·ï¼Œæˆ–è€…ä½¿ç”¨<code>plyï¼ˆdataï¼Œ* verbsï¼‰</code>å‡½æ•°ä»£æ›¿ <code>&gt;&gt;</code>ï¼Œ ç›®å‰ä»…æ”¯æŒå¯¹pandas.DataFrameæ•°æ®è¿›è¡Œæ“ä½œã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">plydata</span>
</code></pre></div><h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">plydata</span> <span class="kn">import</span> <span class="n">define</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">if_else</span><span class="p">,</span> <span class="n">ply</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]})</span>

<span class="n">df</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
</tr>
</tbody>
</table>
<h2 id="define">define</h2>
<p>defineå‡½æ•°åå¾ˆç®€å•ï¼Œå®šä¹‰å˜é‡æˆ–è€…æ“ä½œå˜é‡ã€‚</p>
<p><code>define(data, *args,**kwargs)</code></p>
<ul>
<li>data å¾…æ“ä½œçš„dataframeæ•°æ®</li>
<li>argsã€kwargs æ“ä½œè¿‡ç¨‹åŠç»“æœã€‚</li>
</ul>
<p>æ¯”å¦‚æˆ‘ä»¬æƒ³åœ¨dfä¸­æ–°å»ºä¸€ä¸ªzåˆ—ï¼Œzåˆ—çš„å€¼å®Œå…¨å¤åˆ¶è‡ªxåˆ—ã€‚å¯ä»¥ä½¿ç”¨ä»£ç  define(df, z=&lsquo;x&rsquo;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">define</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„:</strong> dfä¸­æœ‰xåˆ—ï¼Œæ‰€ä»¥è¿™é‡Œçš„ä½¿ç”¨çš„&rsquo;x',è€Œä¸æ˜¯xã€‚</p>
<h2 id="ç®¡é“ç¬¦">&raquo;ç®¡é“ç¬¦</h2>
<p>åˆšåˆšçš„é—®é¢˜å¯ä»¥ä½¿ç”¨ç®¡é“ç¬¦å®ç°ä¸define(df, z=&lsquo;x&rsquo;)ç›¸åŒçš„åŠŸèƒ½ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#ç­‰åŒäºdf[&#39;z&#39;]=df[&#39;x&#39;]</span>
<span class="c1">#ç­‰åŒäºdefine(df, z=&#39;x&#39;)</span>
<span class="n">df</span> <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p>å¦‚æœæœ‰å¤šä¸ªç¯èŠ‚ï¼Œå¯ä»¥ç”¨æ‹¬å·åŒ…è£¹ä½ï¼Œç¯èŠ‚ä¸ç¯èŠ‚ç”¨<code>&gt;&gt;</code>å’Œ<code>æ¢è¡Œ</code>å‰åè¡”æ¥ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬æœ‰å¤šä¸ªæ“ä½œï¼Œæ¯ä¸€æ­¥æ“ä½œå¦‚ä¸‹</p>
<ol>
<li><code>m=2x</code></li>
<li><code>n=m*m</code></li>
<li><code>q=m+n</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">df</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="s1">&#39;2*x&#39;</span><span class="p">)</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s1">&#39;m*m&#39;</span><span class="p">)</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="s1">&#39;m+n&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">m</th>
<th style="text-align:right">n</th>
<th style="text-align:right">q</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">4</td>
<td style="text-align:right">16</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">6</td>
<td style="text-align:right">36</td>
<td style="text-align:right">42</td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢æ‰€æœ‰çš„plydataç›¸å…³æ“ä½œä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®df</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
</tr>
</tbody>
</table>
<h2 id="if_else">if_else</h2>
<p>åœ¨dfä¸­æ–°å»ºzåˆ—ï¼Œzçš„å€¼æ»¡è¶³</p>
<ul>
<li>å½“xå¤§äº1ï¼Œzä¸º1</li>
<li>å½“xå°äºç­‰äº1ï¼Œ zä¸º0</li>
</ul>
<p>ä½¿ç”¨if_else(predicate, true_value, false_value)</p>
<ul>
<li>predicate é€»è¾‘åˆ¤æ–­æ¡ä»¶å­—ç¬¦ä¸²</li>
<li>true_value æ»¡è¶³é€»è¾‘æ¡ä»¶è¿”å›çš„å€¼</li>
<li>false_value ä¸æ»¡è¶³é€»è¾‘æ¡ä»¶è¿”å›çš„å€¼</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#ç­‰åŒäºdefine(df, z=if_else(&#39;x&gt;1&#39;, 1, 0))</span>
<span class="n">df</span> <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">if_else</span><span class="p">(</span><span class="s1">&#39;x&gt;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:left">zero</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:left">one</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h2 id="query">query</h2>
<p>query(data, expr)</p>
<ul>
<li>data å¾…æŸ¥è¯¢çš„dataframeæ•°æ®</li>
<li>expr  æŸ¥è¯¢æ¡ä»¶å­—ç¬¦ä¸²</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">df</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">if_else</span><span class="p">(</span><span class="s1">&#39;x&gt;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> 
 <span class="o">&gt;&gt;</span> <span class="n">query</span><span class="p">(</span><span class="s1">&#39;z==1&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h2 id="ply">ply()</h2>
<p>plyåŠŸèƒ½ç­‰åŒäºç®¡é“ç¬¦&raquo;ï¼Œ åˆšåˆšä¸Šé¢çš„ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">df</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">if_else</span><span class="p">(</span><span class="s1">&#39;x&gt;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> 
 <span class="o">&gt;&gt;</span> <span class="n">query</span><span class="p">(</span><span class="s1">&#39;z==1&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div><p>å¯ä»¥ç”¨ply</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ply</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
    <span class="n">define</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">if_else</span><span class="p">(</span><span class="s1">&#39;x &gt; 1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="n">query</span><span class="p">(</span><span class="s1">&#39;z == 1&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">x</th>
<th style="text-align:left">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:left">two</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:left">three</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h2 id="plydataä¸plotnine">plydataä¸plotnine</h2>
<p>åœ¨Rè¯­è¨€ä¸­ï¼Œç”¨ggplot2ä½œå›¾ç»å¸¸ä¼šç”¨åˆ°ç®¡é“ç¬¦ã€‚è€Œåœ¨Pythonä¸­ï¼Œplydataæä¾›ç®¡é“ç¬¦ï¼Œå¯ä»¥ä¸ä½œå›¾åº“plotnineç»“åˆä½¿ç”¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">geom_line</span><span class="p">,</span> <span class="n">aes</span>
<span class="kn">from</span> <span class="nn">plydata</span> <span class="kn">import</span> <span class="n">define</span><span class="p">,</span> <span class="n">if_else</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)})</span>
<span class="p">(</span><span class="n">df</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;np.sin(x)&#39;</span><span class="p">)</span> 
 <span class="o">&gt;&gt;</span> <span class="n">define</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="n">if_else</span><span class="p">(</span><span class="s1">&#39;y&gt;=0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;pos&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;neg&#34;&#39;</span><span class="p">))</span> 
 <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sign&#39;</span><span class="p">))</span><span class="o">+</span>
     <span class="n">geom_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_27_0.png" width="100%" />
    
    
</figure>

<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>YelpDaset | é…’åº—ç®¡ç†ç±»æ•°æ®é›†10&#43;G</title>
      <link>https://hidadeng.github.io/blog/yelpdataset_10g/</link>
      <pubDate>Sat, 20 Nov 2021 22:40:10 +0600</pubDate>
      
      <guid>/blog/yelpdataset_10g/</guid>
      <description>Yelpæ•°æ®é›†æ˜¯æˆ‘ä»¬ç”¨äºä¸ªäººï¼Œæ•™è‚²å’Œå­¦æœ¯ç›®çš„çš„ä¸šåŠ¡ï¼Œè¯„è®ºå’Œç”¨æˆ·æ•°æ®çš„å­é›†ã€‚å­—æ®µä¸°å¯Œï¼Œé€‚åˆç©æ•°æ®åˆ†æ</description>
      <content:encoded><![CDATA[<h2 id="æ•°æ®é›†ä¸‹è½½">æ•°æ®é›†ä¸‹è½½</h2>
<p>é“¾æ¥:<a href="https://pan.baidu.com/s/1rUfj7NYYAnM3NuFWCHyPpA">https://pan.baidu.com/s/1rUfj7NYYAnM3NuFWCHyPpA</a> å¯†ç :ux8z</p>
<p>åœ¨æ˜¨å¤©å‘çš„æ–‡ç« é‡Œæåˆ°äº†yelpæ•°æ®é›†ï¼Œå®˜ç½‘æ˜¾ç¤º&quot;Yelpæ•°æ®é›†æ˜¯æˆ‘ä»¬ç”¨äºä¸ªäººï¼Œæ•™è‚²å’Œå­¦æœ¯ç›®çš„çš„ä¸šåŠ¡ï¼Œè¯„è®ºå’Œç”¨æˆ·æ•°æ®çš„å­é›†ã€‚ ä»¥JSONæ–‡ä»¶å½¢å¼æä¾›ï¼Œå¯ç”¨äºåœ¨å­¦ä¹ å¦‚ä½•åˆ¶ä½œç§»åŠ¨åº”ç”¨ç¨‹åºçš„åŒæ—¶ï¼Œå‘å­¦ç”Ÿä»‹ç»æ•°æ®åº“ï¼Œå­¦ä¹ NLPæˆ–æä¾›ç¤ºä¾‹ç”Ÿäº§æ•°æ®ã€‚&quot;</p>
<p>yelpå®˜ç½‘æ˜¾ç¤ºï¼Œè¿™ä¸ªæ•°æ®é›†äº®ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>668+wæ¡è¯„è®º</li>
<li>19+wä¸ªå•†ä¸šæœºæ„</li>
<li>20wå¼ å›¾ç‰‡</li>
<li>10ä¸ªéƒ½å¸‚åŒºåŸŸ</li>
<li>å­—æ®µåŒ…æ‹¬:è¥ä¸šæ—¶é—´ã€æ˜¯å¦æ³Šè½¦ã€å¯ç”¨æ€§å’Œç¯å¢ƒ</li>
</ul>
<p><img loading="lazy" src="img/yelp.png" alt=""  />
</p>
<p>åœ¨kaggleä¸Šä¹Ÿèƒ½çœ‹åˆ°ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†çš„æ¡ˆä¾‹ï¼Œè¯´ä¸å®šæœ‰ä½ éœ€è¦çš„åˆ†ææ–¹æ³•ã€‚</p>
<p><img loading="lazy" src="img/kaggle.png" alt=""  />
</p>
<p>æˆ‘å·²ç»ä»yelpå®˜ç½‘ä¸‹è½½äº†æ•°æ®, å‚ç…§kaggleçš„å¾ˆå¤šä¾‹å­ï¼Œå’±ä»¬ä¹Ÿåœ¨è‡ªå·±ç”µè„‘ä¸Šè·‘è·‘ç®€å•çš„åˆ†æ</p>
<h2 id="businessæ•°æ®è¯»å–">businessæ•°æ®è¯»å–</h2>
<p>kaggleä¸­çš„æ•°æ®æ˜¯csvæ–‡ä»¶ï¼Œå’±è¿™é‡Œæ˜¯jsonï¼Œç•¥æœ‰ä¸åŒï¼Œä½†è¯»å–éƒ½å¯ä»¥ç”¨pandasè¯»å–</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#ä¸€å¼€å§‹ç”¨æ³¨é‡Šæ‰çš„ä»£ç ï¼Œæœ‰bugï¼Œç»è¿‡ç™¾åº¦æ‰¾åˆ°lines=Trueè§£å†³æ–¹æ¡ˆ</span>
<span class="c1">#business = pd.read_json(&#39;yelp_dataset/business.json&#39;)</span>
<span class="n">business</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;yelp_dataset/business.json&#39;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">business</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/1.png" alt=""  />
</p>
<br>
<h2 id="è¯„åˆ†åˆ†å¸ƒ">è¯„åˆ†åˆ†å¸ƒ</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
</code></pre></div><pre><code>[(0.12156862745098039, 0.4666666666666667, 0.7058823529411765),
 (1.0, 0.4980392156862745, 0.054901960784313725),
 (0.17254901960784313, 0.6274509803921569, 0.17254901960784313),
 (0.8392156862745098, 0.15294117647058825, 0.1568627450980392),
 (0.5803921568627451, 0.403921568627451, 0.7411764705882353),
 (0.5490196078431373, 0.33725490196078434, 0.29411764705882354),
 (0.8901960784313725, 0.4666666666666667, 0.7607843137254902),
 (0.4980392156862745, 0.4980392156862745, 0.4980392156862745),
 (0.7372549019607844, 0.7411764705882353, 0.13333333333333333),
 (0.09019607843137255, 0.7450980392156863, 0.8117647058823529)]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">rating</span> <span class="o">=</span> <span class="n">business</span><span class="p">[</span><span class="s1">&#39;stars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">rating</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rating</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[:</span><span class="mi">9</span><span class="p">],</span>
            <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#å­—ä½“å€¾æ–œè§’åº¦</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rating Distribution of Yelp&#39;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/output_5_0.png" alt=""  />
</p>
<br>
<h2 id="è¡Œä¸šç»Ÿè®¡">è¡Œä¸šç»Ÿè®¡</h2>
<p>æŸ¥çœ‹è¡Œä¸šåº—å®¶æ•°é‡åˆ†å¸ƒ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">business</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">business</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">category_str</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">business</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">])</span>
<span class="n">category_list</span> <span class="o">=</span> <span class="n">category_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">category_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">category_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>
<span class="n">top15_category</span> <span class="o">=</span> <span class="n">category_df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">15</span><span class="p">]</span>
<span class="n">top15_category</span>
<span class="n">top15_category</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
                    <span class="n">rot</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 20 Category in Yelp&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> 
          <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/output_7_0.png" alt=""  />
</p>
<br>
<h2 id="åŸå¸‚åˆ†å¸ƒ">åŸå¸‚åˆ†å¸ƒ</h2>
<p>æ˜¾ç¤ºyelpä¸­Top20åŸ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">citys</span> <span class="o">=</span> <span class="n">business</span><span class="p">[</span><span class="s1">&#39;city&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">citys</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#é™åºï¼ŒåŸåœ°ä¿®æ”¹åŸå§‹æ•°æ®</span>
<span class="n">citys</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span>   <span class="c1">#æ°´å¹³æ¡å½¢å›¾</span>
           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
           <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 20 city in the Yelp&#39;</span><span class="p">,</span> 
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
          <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/output_9_0.png" alt=""  />
</p>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨pandas_bokehåšå¯è§†åŒ–</title>
      <link>https://hidadeng.github.io/blog/pandas_bokeh_vis/</link>
      <pubDate>Thu, 18 Nov 2021 17:40:10 +0600</pubDate>
      
      <guid>/blog/pandas_bokeh_vis/</guid>
      <description>ç®€æ´æ•°æ®å¯è§†åŒ–</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96pandas_bokeh.zip">ç‚¹å‡»ä¸‹è½½ä»£ç </a></p>
<h2 id="pandas_bokeh">pandas_bokeh</h2>
<p>pandas_bokehå¯ä»¥ä½¿å¾—dataframeç›´æ¥è°ƒç”¨bokehåº•å±‚ä»£ç ã€‚é€šè¿‡ä½¿ç”¨pandas_bokehï¼Œå¯ä»¥åœ¨notebookæˆ–è€…htmlä¸­æ˜¾ç¤ºï¼Œè¯­æ³•ç›¸æ¯”äºbokehæ›´ç®€æ´æ˜“ç”¨ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pandas_bokeh</span>
</code></pre></div><h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>
<p>å¯¹fruits.csvåšä¸€ä¸ªæ¡å½¢å›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fruits.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">fruits</th>
<th style="text-align:right">2015</th>
<th style="text-align:right">2016</th>
<th style="text-align:right">2017</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">è‹¹æœ</td>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">æ¢¨</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">é¦™è•‰</td>
<td style="text-align:right">4</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">è‰è“</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">æ¨±æ¡ƒ</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:left">æ©˜å­</td>
<td style="text-align:right">4</td>
<td style="text-align:right">6</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_bokeh</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span> <span class="c1">#å¿½ç•¥æŸäº›ä¸å½±å“ç¨‹åºçš„æç¤º</span>

<span class="c1">#åœ¨notebookä¸­èƒ½æ˜¾ç¤ºå¯è§†åŒ–ç»“æœ</span>
<span class="n">pandas_bokeh</span><span class="o">.</span><span class="n">output_notebook</span><span class="p">()</span>

<span class="c1">#å°†fruitsåˆ—è®¾ç½®ä¸ºè¡Œç´¢å¼•</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fruits.xlsx&#39;</span><span class="p">)</span>


<span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;fruits&#39;</span><span class="p">,</span> <span class="c1">#å°†fruitsåˆ—é€‰åšxè½´</span>
              <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">],</span> <span class="c1">#å°†å¹´ä»½é€‰åšyè½´</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;æ°´æœä»·æ ¼(å…ƒ/æ–¤)&#39;</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;æ°´æœ&#39;</span><span class="p">,</span>
              <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#æ˜¾ç¤º</span>
</code></pre></div>
<figure >
    
        <img src="img/2.gif" width="800" />
    
    
</figure>

<p>ä¸Šé¢çš„ä¾‹å­å·²ç»å¯ä»¥çœ‹åˆ°è¯¥åº“çš„ç®€æ´ä¼˜ç¾ä¹‹å¤„ï¼Œç°åœ¨æˆ‘ä»¬å¤šå­¦ç‚¹</p>
<h2 id="pandas_bokehè¾“å‡ºè®¾å®š">pandas_bokehè¾“å‡ºè®¾å®š</h2>
<ul>
<li>pandas_bokeh.output_notebook() åœ¨notebookä¸­èƒ½æ˜¾ç¤ºå¯è§†åŒ–ç»“æœ</li>
<li>pandas_bokeh.output_file(filename) å°†ç»“æœè¾“å‡ºåˆ°htmlæ–‡ä»¶ä¸­</li>
</ul>
<h2 id="æ”¯æŒå¯è§†åŒ–å›¾ç§ç±»">æ”¯æŒå¯è§†åŒ–å›¾ç§ç±»</h2>
<ul>
<li>line</li>
<li>bar</li>
<li>point</li>
<li>scatter</li>
<li>histogram</li>
<li>area</li>
<li>pie</li>
<li>map</li>
</ul>
<p>ä»¥barä¸ºä¾‹ï¼Œè°ƒç”¨å¯è§†åŒ–æ¥å£æ—¶ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§ä½¿ç”¨æ–¹æ³•</p>
<ul>
<li>df.plot_bokeh.line(&hellip;)</li>
<li>df.plot_bokeh(kind=&lsquo;line&rsquo;)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fake_stocks.xlsx&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&#34;line&#34;</span><span class="p">,</span> 
              <span class="n">x</span><span class="o">=</span><span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">,</span> <span class="c1">#å°†excelä¸­çš„æ—¥æœŸåˆ—å½“åšxè½´</span>
              <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Google&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">])</span> <span class="c1">#å°†&#39;Google&#39;, &#39;Apple&#39;ä¸¤åˆ—ä½œä¸ºyè½´</span>
</code></pre></div>
<figure >
    
        <img src="img/3.gif" width="800" />
    
    
</figure>

<h2 id="é«˜çº§å‚æ•°">é«˜çº§å‚æ•°</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span>
              <span class="n">logx</span><span class="p">,</span> <span class="n">logy</span><span class="p">,</span> <span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">hovertool</span><span class="p">,</span> 
              <span class="n">zooming</span><span class="p">,</span> <span class="n">panning</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><ul>
<li>kind: æ”¯æŒçš„å›¾ç§ç±»&quot;line&quot;, &ldquo;point&rdquo;, &ldquo;scatter&rdquo;, &ldquo;bar&rdquo; ,&ldquo;histogram&quot;ç­‰</li>
<li>x: é€‰ä¸­æ•°æ®æŸåˆ—åä½œä¸ºxè½´ã€‚å¦‚æœxä¸ä¼ å…¥å‚æ•°ï¼Œä¼šé»˜è®¤ä½¿ç”¨dfçš„ç´¢å¼•ä½œä¸ºxè½´</li>
<li>y: å°†æ•°æ®ä¸­çš„æŸåˆ—æˆ–æŸäº›åˆ—æŒ‡å®šä¸ºyè½´</li>
<li>figsize: å›¾çš„å°ºå¯¸,å¦‚figsize=(600, 350)</li>
<li>title:  å›¾çš„æ ‡é¢˜</li>
<li>xlim/ylim: è®¾ç½®å›¾çš„xè½´å’Œyè½´çš„èŒƒå›´</li>
<li>xlabel/ylabel: è®¾ç½®xè½´å’Œyè½´çš„åå­—</li>
<li>logx/logy: å¸ƒå°”å‹å€¼ï¼Œå¯¹xå’Œyçš„æ•°æ®æ˜¯å¦è¿›è¡Œlogå˜æ¢</li>
<li>xticks/yticks: æ˜¾æ€§å®šä¹‰æ¨ªçºµåæ ‡åˆ»åº¦</li>
<li>color: å¯¹å›¾ä¸­ä½¿ç”¨åŒä¸€çš„é¢œè‰²ï¼Œå¦‚æœæƒ³å®šä¹‰å¤šç§é¢œè‰²ï¼Œè¯·ä½¿ç”¨colormapå‚æ•°</li>
<li>colormap: å¯ä»¥å¯¹å›¾ä¸­çš„ä¸åŒå¯¹è±¡è®¾ç½®é¢œè‰²ï¼Œ ä¼ å…¥çš„æ˜¯é¢œè‰²å­—ç¬¦ä¸²åˆ—è¡¨ã€‚</li>
<li>hovertool: é»˜è®¤Trueï¼Œé¼ æ ‡æ”¾åœ¨å›¾ä¸Šä¼šæ‚¬æµ®æ˜¾ç¤ºå…·ä½“ä¿¡æ¯ã€‚</li>
<li>zooming: å¸ƒå°”å€¼ï¼Œé»˜è®¤Trueæ”¯æŒç¼©æ”¾</li>
<li>panning: å¸ƒå°”å€¼ï¼Œé»˜è®¤Trueæ”¯æŒå¹³ç§»</li>
<li>kwargs**: æ›´å¤šå‚æ•°è®¾å®šè¯·çœ‹å®˜æ–¹æ–‡æ¡£</li>
</ul>
<h2 id="æ–‡æ¡£">æ–‡æ¡£</h2>
<ul>
<li>pandas_bokehæ–‡æ¡£åœ°å€https://github.com/PatrikHlobil/Pandas-Bokeh</li>
<li>Bokehå®˜æ–¹æ–‡æ¡£åœ°å€https://docs.bokeh.org/en/latest/</li>
</ul>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨Pandasåšæ•°æ®é¢„å¤„ç†</title>
      <link>https://hidadeng.github.io/blog/pre_process_in_pandas/</link>
      <pubDate>Tue, 16 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/pre_process_in_pandas/</guid>
      <description>4000å­—è¯¦ç»†è¯´æ˜</description>
      <content:encoded><![CDATA[<blockquote>
<p>src: <a href="https://mp.weixin.qq.com/s/7D2d7BIaFAhPrxtDOWGgLA">https://mp.weixin.qq.com/s/7D2d7BIaFAhPrxtDOWGgLA</a></p>
<p>author: ä¿Šæ¬£</p>
<p>å…¬ä¼—å·: å…³äºæ•°æ®åˆ†æä¸å¯è§†åŒ–</p>
</blockquote>
<p>æ•°æ®é¢„å¤„ç†è¿‡ç¨‹å½“ä¸­, å¤§è‡´ä¼šé‡åˆ°</p>
<ul>
<li>åŠ è½½æ•°æ®</li>
<li>å¤„ç†ç¼ºå¤±å€¼å¦‚ä½•å¤„ç†</li>
<li>å¤„ç†ç¦»æ•£å‹æ•°æ®è¯¥å¦‚ä½•å¤„ç†</li>
<li>æ•°æ®çš„æ ‡å‡†åŒ–</li>
<li>å°†æ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒé›†ä¸æµ‹è¯•é›†</li>
<li>å»æ‰é‡å¤å€¼</li>
</ul>
<br>
<h2 id="åŠ è½½æ•°æ®">åŠ è½½æ•°æ®</h2>
<p>æˆ‘ä»¬å¯¼å…¥å¿…è¦çš„åº“å¹¶ä¸”åŠ è½½æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;data.csv&#34;</span><span class="p">)</span>
</code></pre></div><p>åœ¨è¿›è¡Œæ•°æ®åˆ†æå‰ï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹æ•°æ®çš„æ€»ä½“æƒ…å†µï¼Œä»å®è§‚ä¸Šäº†è§£æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1">#æ˜¾ç¤ºå‰äº”è¡Œæ•°æ®</span>
<span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span> <span class="c1">#æ˜¾ç¤ºæœ«å°¾äº”è¡Œæ•°æ®</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span> <span class="c1">#æŸ¥çœ‹å„å­—æ®µçš„ä¿¡æ¯</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#æŸ¥çœ‹æ•°æ®é›†æœ‰å‡ è¡Œå‡ åˆ—,data.shape[0]æ˜¯è¡Œæ•°,data.shape[1]æ˜¯åˆ—æ•°</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1">#æŸ¥çœ‹æ•°æ®çš„å¤§ä½“æƒ…å†µï¼Œå‡å€¼ï¼Œæœ€å€¼ï¼Œåˆ†ä½æ•°å€¼...</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>   <span class="c1">#å¾—åˆ°åˆ—åçš„list</span>
</code></pre></div><br>
<h2 id="å¤„ç†ç¼ºå¤±å€¼">å¤„ç†ç¼ºå¤±å€¼</h2>
<p>ç¼ºå¤±å€¼ä¸€ç›´éƒ½æ˜¯æ•°æ®é¢„å¤„ç†å½“ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªé—®é¢˜ï¼Œè€Œåœ¨å¤„ç†ç±»ä¼¼çš„é—®é¢˜çš„æ—¶å€™ï¼Œæ–¹å¼æ–¹æ³•ä¹Ÿæ˜¯å¤šç§å¤šæ ·çš„ï¼Œæˆ‘ä»¬ä¸€ä¸€æ¥ä»‹ç»ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;å°æ˜&#39;</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">55</span><span class="p">],[</span><span class="s1">&#39;å°çº¢&#39;</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="s1">&#39;å°ç‹&#39;</span><span class="p">,</span><span class="mi">26</span><span class="p">]]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Weight&#39;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  Name  Age  Weight
0   å°æ˜   25    55.0
1   å°çº¢   28    60.0
2   å°ç‹   26     NaN
</code></pre></div><p>é’ˆå¯¹ä¸Šé¢çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬é€šè¿‡pandasä¸­çš„æ–¹æ³•çœ‹ä¸€ä¸‹ç¼ºå¤±å€¼çš„æƒ…å†µ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">    Name    Age  Weight
0  False  False   False
1  False  False   False
2  False  False    True
</code></pre></div><p>å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ä¹ˆæ¥åšï¼Œæ£€æµ‹æ¯ä¸€åˆ—ç©ºå€¼çš„æ•°é‡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Name      0
Age       0
Weight    1
dtype: int64
</code></pre></div><p>è€Œåœ¨é¢å¯¹ç¼ºå¤±å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€æ–¹é¢å¯ä»¥å°†å…¶å»é™¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  Name  Age  Weight
0   å°æ˜   25    55.0
1   å°çº¢   28    60.0
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ï¼Œä¾‹å¦‚ç”¨å¹³å‡å€¼æ¥å¡«å……</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">    Name  Age  Weight
0   å°æ˜   25    55.0
1   å°çº¢   28    60.0
2   å°ç‹   26    57.5
</code></pre></div><p>é™¤äº†pandaså½“ä¸­çš„æ–¹æ³•ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨sklearnåº“å½“ä¸­çš„ä¸€äº›å‡½æ•°æ–¹æ³•ï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Weight&#39;</span><span class="p">]])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Weight&#39;</span><span class="p">]])</span>
</code></pre></div><p>æœ€åè¿”å›çš„ç»“æœä¹Ÿå’Œä¸Šé¢çš„fillna()æ–¹æ³•è¿”å›çš„ç»“æœä¸€è‡´ï¼Œæˆ‘ä»¬ç”¨å¹³å‡å€¼æ¥ä»£ç ç©ºå€¼ï¼Œé‚£ä¹ˆåŒæ ·é“ç†æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸­ä½æ•°ã€ä¼—æ•°ç­‰ç»Ÿè®¡å€¼æ¥è¿›è¡Œæ›¿æ¢ï¼Œè¿™é‡Œå°±ä¸åšå¤šè¯´</p>
<br>
<h2 id="å¤„ç†ç¦»æ•£å‹æ•°æ®">å¤„ç†ç¦»æ•£å‹æ•°æ®</h2>
<p>å¦å¤–å½“æ•°æ®é›†å½“ä¸­å‡ºç°ç¦»æ•£å‹æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿè¦è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œæ¯•ç«Ÿåœ¨åé¢çš„å»ºæ¨¡è¿‡ç¨‹å½“ä¸­ï¼Œæœºå™¨å­¦ä¹ çš„æ¨¡å‹éœ€è¦çš„æ˜¯è¿ç»­å‹çš„æ•°æ®ã€‚
ç¦»æ•£å‹æ•°æ®ä¹Ÿåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯æœ‰åºçš„ç¦»æ•£å˜é‡ï¼Œå°±æ¯”æ–¹è¯´æ˜¯è¡£æœçš„å°ºç ï¼Œæœ‰Mç çš„ã€ä¹Ÿæœ‰Lç çš„ã€ä¹Ÿè¿˜æœ‰ä¸ä¹‹æ›´å¤§çš„å°ºç ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æ— åºçš„ï¼Œä¾‹å¦‚è¡£æœçš„é¢œè‰²ï¼Œé¢œè‰²ä¹‹é—´æ²¡æœ‰å¤§å°ä¹‹åˆ†ï¼Œå› æ­¤åœ¨ç¼–ç çš„æ—¶å€™ä¹Ÿåº”è¯¥å¦å¤–å¤„ç†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> 
                     <span class="p">[[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="mf">10.1</span><span class="p">,</span><span class="s1">&#39;class1&#39;</span><span class="p">],</span>
                      <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="mf">20.1</span><span class="p">,</span><span class="s1">&#39;class2&#39;</span><span class="p">],</span>
                      <span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="mf">30.1</span><span class="p">,</span><span class="s1">&#39;class1&#39;</span><span class="p">]],</span> <span class="p">)</span>
<span class="n">df_cat</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="s1">&#39;price&#39;</span><span class="p">,</span><span class="s1">&#39;classlabel&#39;</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   color size  price classlabel
0  green    M   10.1     class1
1   blue    L   20.1     class2
2  white    M   30.1     class1
</code></pre></div><p>å¯¹äºæœ‰åºçš„ç¦»æ•£å‹å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨map()å‡½æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">size_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">size_mapping</span><span class="p">)</span>
<span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    1
1    2
2    1
Name: size, dtype: int64
</code></pre></div><p>å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨sklearnåº“ä¸­çš„LabelEncoder()æ–¹æ³•æ¥å¤„ç†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="n">class_le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</code></pre></div><p>è€Œå¯¹äºæ— åºçš„ç¦»æ•£å‹å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç‹¬çƒ­ç¼–ç ï¼Œä¾‹å¦‚å¯¹colorè¿™ä¸€åˆ—è¿›è¡Œç¼–ç è¿‡ä¹‹åä¼šæœ‰color_greenã€color_blueä»¥åŠcolor_whiteä¸‰ä¸ªç‰¹å¾ï¼Œç‰¹å¾å€¼ä¸º0æˆ–è€…1</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&#34;color&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   color_blue  color_green  color_white
0           0            1            0
1           1            0            0
2           0            0            1

</code></pre></div><p>ç„¶åæˆ‘ä»¬å°†æ­¤å¹¶å…¥åˆ°æºæ•°æ®å½“ä¸­å»</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df_cat</span><span class="p">[[</span><span class="s2">&#34;size&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummies</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   size  price  color_blue  color_green  color_white
0     1   10.1           0            1            0
1     2   20.1           1            0            0
2     1   30.1           0            0            1
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ä½†æ˜¯è€ƒè™‘åˆ°åé¢æ­å»ºæ¨¡å‹çš„æ—¶å€™</span><span class="err">ï¼Œ</span><span class="n">å˜é‡ä¸å˜é‡ä¹‹é—´åº”è¯¥ä¿æŒç‹¬ç«‹</span><span class="err">ï¼Œ</span><span class="n">è€Œä¸åº”è¯¥æ˜¯å­˜åœ¨ä¾èµ–çš„å…³ç³»</span><span class="err">ï¼Œ</span><span class="n">å¯¹äºcolorè¿™ä¸€åˆ—ä¸­å­˜åœ¨ä¸‰ç§é¢œè‰²</span><span class="err">ï¼Œ</span><span class="n">åˆ†åˆ«æ˜¯blue</span><span class="err">ã€</span><span class="n">greenä»¥åŠwhite</span><span class="err">ï¼Œ</span><span class="n">å½“å‰ä¸¤ç±»å–å€¼éƒ½ä¸º0çš„æ—¶å€™</span><span class="err">ï¼Œ</span><span class="n">coloråªå¯èƒ½æ˜¯white</span>
<span class="n">æ‰€ä»¥å°†get_dummies</span><span class="p">()</span><span class="n">æ–¹æ³•ä¸­çš„drop_firsté»˜è®¤å€¼ä¸ºFalseæ”¹ä¸ºTrue</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_cat</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&#34;color&#34;</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_cat</span><span class="p">[[</span><span class="s2">&#34;size&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummies</span><span class="p">)</span>
</code></pre></div><br>
<h2 id="æ•°æ®çš„æ ‡å‡†åŒ–">æ•°æ®çš„æ ‡å‡†åŒ–</h2>
<p>ç”±äºä¸åŒçš„å˜é‡ï¼Œå®ƒä»¬å¾€å¾€å­˜åœ¨ä¸åŒçš„å•ä½ä»¥åŠä¸åŒçš„å–å€¼èŒƒå›´ï¼Œæœ‰æ—¶å€™å–å€¼èŒƒå›´çš„å·®å¼‚è¾ƒå¤§ä¼šå¯¹æœºå™¨å­¦ä¹ çš„æ¨¡å‹å¸¦æ¥å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚å› æ­¤ä¸ºäº†æœ€åé¢„æµ‹ç»“æœçš„å¯é æ€§ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå¯¹æ•°æ®æŒ‰æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ï¼Œä½¿ä¹‹è½å…¥ä¸€ä¸ªå°çš„ç‰¹å®šåŒºé—´ã€‚è€Œæ ‡å‡†åŒ–ç®—æ³•æœ‰</p>
<ul>
<li>z-score æ ‡å‡†åŒ–</li>
</ul>
<p>è¿™ç§æ–¹æ³•æ ¹æ®åŸå§‹æ•°æ®çš„å‡å€¼å’Œæ ‡å‡†å·®è¿›è¡Œæ•°æ®çš„æ ‡å‡†åŒ–ï¼Œç»è¿‡å¤„ç†çš„æ•°æ®ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œå³å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1 ï¼Œå½“ç„¶sklearnåº“å½“ä¸­çš„ä»£ç åˆ™æ˜¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div><ul>
<li>çº¿æ€§å½’ä¸€åŒ–</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_train_minmax</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_minmax</span><span class="p">)</span>
</code></pre></div><p>è®­ç»ƒé›†ä¸­çš„æ•°æ®ç»è¿‡è½¬åŒ–ï¼Œå–å€¼èŒƒå›´éƒ½é›†ä¸­åœ¨[0,1]ä¹‹é—´</p>
<ul>
<li>MaxAbsScaler()æ–¹æ³•</li>
</ul>
<p>MaxAbsScaler()æ–¹æ³•å’Œä¸Šè¿°çš„çº¿æ€§å½’ä¸€åŒ–æ•ˆæœç›¸ç±»ä¼¼ï¼Œè®­ç»ƒé›†ä¸­çš„æ•°æ®ç»è¿‡è½¬åŒ–ï¼Œå–å€¼èŒƒå›´åœ¨[-1,1]ä¹‹é—´</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">max_abs_scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">MaxAbsScaler</span><span class="p">()</span>
<span class="n">X_train_maxabs</span> <span class="o">=</span> <span class="n">max_abs_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_maxabs</span> <span class="o">=</span> <span class="n">max_abs_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div><ul>
<li>RobustScaler()æ–¹æ³•</li>
</ul>
<p>è¦æ˜¯å½“æ•°æ®é›†å½“ä¸­å­˜åœ¨å¾ˆå¤šçš„æå€¼çš„æ—¶å€™ï¼Œåˆ©ç”¨å¹³å‡å€¼å’Œæ ‡å‡†å·®æ¥è¿›è¡Œæ•°æ®çš„æ ‡å‡†åŒ–æ•ˆæœå¯èƒ½å¹¶ä¸ç†æƒ³ï¼Œæ¯•ç«Ÿæå€¼ä¼šå½±å“åˆ°å¹³å‡å€¼å’Œæ ‡å‡†å·®çš„è®¡ç®—ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°RobustScaler()æ–¹æ³•ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div><br>
<h2 id="å°†æ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†">å°†æ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†</h2>
<p>åœ¨å»ºæ¨¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®é›†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒé›†ä¸Šé¢å»ºç«‹æ¨¡å‹ï¼Œè®­ç»ƒä¸ä¼˜åŒ–æ¨¡å‹ï¼Œç„¶åå†å°†æ¨¡å‹æ”¾åˆ°æµ‹è¯•é›†ä¸Šé¢ï¼Œè¯„ä¼°ä¸€ä¸‹æ¨¡å‹çš„æ€§èƒ½ä»¥åŠä¼˜åŒ–çš„æ•ˆæœï¼Œåœ¨sklearnåº“ä¸­ä¹Ÿæœ‰ç›¸å¯¹åº”çš„æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div><p>ä¸Šé¢çš„å˜é‡yå…·ä½“æŒ‡çš„æ˜¯è¢«é¢„æµ‹çš„å› å˜é‡ï¼Œè€Œxåˆ™æ˜¯åœ¨é¢„æµ‹ä¸­ä½¿ç”¨çš„è‡ªå˜é‡</p>
<br>
<h2 id="å»é™¤é‡å¤å€¼">å»é™¤é‡å¤å€¼</h2>
<p>åœ¨pandaså½“ä¸­ä¹Ÿæœ‰å¯¹åº”çš„æ–¹æ³•æ¥å»é™¤æ‰é‡å¤å€¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span>

<span class="c1">## ä»£ç ä¸‹è½½</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hidadeng</span><span class="o">/</span><span class="n">DaDengAndHisPython</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="mi">4000</span><span class="n">å­—å½’çº³æ€»ç»“PandasSklearnæ•°æ®é¢„å¤„ç†</span><span class="o">.</span><span class="n">ipynb</span>
</code></pre></div><p><br><br></p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨Pandaså¤„ç†æ–‡æœ¬æ•°æ®</title>
      <link>https://hidadeng.github.io/blog/text_analysis_in_pandas/</link>
      <pubDate>Tue, 16 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/text_analysis_in_pandas/</guid>
      <description>2000å­—è¯¦ç»†è¯´æ˜</description>
      <content:encoded><![CDATA[<blockquote>
<p>src: <a href="https://mp.weixin.qq.com/s/MmfEtyKaMqNn_Ik1oJtitQ">https://mp.weixin.qq.com/s/MmfEtyKaMqNn_Ik1oJtitQ</a></p>
<p>author: ä¿Šæ¬£</p>
<p>å…¬ä¼—å·: å…³äºæ•°æ®åˆ†æä¸å¯è§†åŒ–</p>
</blockquote>
<br>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/%E6%96%87%E6%9C%AC%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86Pandas%E7%AF%87.ipynb">ç‚¹å‡»Pandasæœ¬æ–‡ä»£ç ä¸‹è½½</a></p>
<p>ä»Šå¤©æˆ‘ä»¬æ¥è°ˆè®ºä¸€ä¸‹pandasåº“å½“ä¸­æ–‡æœ¬æ•°æ®çš„æ“ä½œï¼Œå¸Œæœ›å¤§å®¶å†çœ‹å®Œæœ¬ç¯‡æ–‡ç« ä¹‹åä¼šæœ‰ä¸å°‘çš„æ”¶è·ï¼Œæˆ‘ä»¬å¤§è‡´ä¼šè®²</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬æ•°æ®çš„DataFrame</li>
<li>å¸¸ç”¨å¤„ç†æ–‡æœ¬æ•°æ®çš„æ–¹æ³•çš„æ€»ç»“</li>
<li>æ­£åˆ™è¡¨è¾¾å¼ä¸DataFrameå†…éƒ¨æ–¹æ³•çš„ç»“åˆ</li>
</ul>
<br>
<h2 id="åˆ›å»ºæ–‡æœ¬å†…å®¹çš„æ•°æ®">åˆ›å»ºæ–‡æœ¬å†…å®¹çš„æ•°æ®</h2>
<p>æˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬æ•°æ®çš„DataFrameï¼Œæ¥ä¾›æˆ‘ä»¬åé¢ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
   <span class="s2">&#34;å§“&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;æ&#34;</span><span class="p">,</span><span class="s2">&#34;ç‹&#34;</span><span class="p">,</span><span class="s2">&#34;æˆ´&#34;</span><span class="p">,</span> <span class="s2">&#34;æ&#34;</span><span class="p">,</span> <span class="s2">&#34;å¼ &#34;</span><span class="p">],</span>
   <span class="s2">&#34;å&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å&#34;</span><span class="p">,</span><span class="s2">&#34;ç¡•&#34;</span><span class="p">,</span><span class="s2">&#34;å»ºä¸š&#34;</span><span class="p">,</span> <span class="s2">&#34;å››&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸‰&#34;</span><span class="p">],</span>
   <span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34; æµ™æ±ŸçœÂ·å®æ³¢å¸‚ &#34;</span><span class="p">,</span> <span class="s2">&#34;   æµ™æ±ŸçœÂ·æ­å·å¸‚    &#34;</span><span class="p">,</span> <span class="s2">&#34;  æµ™æ±ŸçœÂ·ä¸½æ°´å¸‚  &#34;</span><span class="p">,</span> <span class="s2">&#34;  æµ™æ±ŸçœÂ·è¡¢å·å¸‚ &#34;</span><span class="p">,</span> <span class="s2">&#34;  æµ™æ±ŸçœÂ·æ¹–å·å¸‚           &#34;</span><span class="p">],</span>
   <span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;Tomoplplplut1248781&#34;</span><span class="p">,</span> <span class="s2">&#34;Smopopo857&#34;</span><span class="p">,</span> <span class="s2">&#34;Adahuhuifhhjfj&#34;</span><span class="p">,</span> <span class="s2">&#34;Tull1945121&#34;</span><span class="p">,</span> <span class="s2">&#34;ZPWERERTFD599557&#34;</span><span class="p">],</span>
   <span class="s2">&#34;é‚®ç®±åœ°å€&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;tom02159@163.com&#34;</span><span class="p">,</span> <span class="s2">&#34;smitt7821@163.com&#34;</span><span class="p">,</span> <span class="s2">&#34;adams623@163.com&#34;</span><span class="p">,</span> <span class="s2">&#34;tull0305@163.com&#34;</span><span class="p">,</span> <span class="s2">&#34;five7532@163.com&#34;</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | å§“   | å   | æˆ·ç±åœ°å€      | å¾®ä¿¡ID              | é‚®ç®±åœ°å€          |
|---:|:-----|:-----|:--------------|:--------------------|:------------------|
|  0 | æ   | å   | æµ™æ±ŸçœÂ·å®æ³¢å¸‚ | Tomoplplplut1248781 | tom02159@163.com  |
|  1 | ç‹   | ç¡•   | æµ™æ±ŸçœÂ·æ­å·å¸‚ | Smopopo857          | smitt7821@163.com |
|  2 | æˆ´   | å»ºä¸š | æµ™æ±ŸçœÂ·ä¸½æ°´å¸‚ | Adahuhuifhhjfj      | adams623@163.com  |
|  3 | æ   | å››   | æµ™æ±ŸçœÂ·è¡¢å·å¸‚ | Tull1945121         | tull0305@163.com  |
|  4 | å¼    | ä¸‰   | æµ™æ±ŸçœÂ·æ¹–å·å¸‚ | ZPWERERTFD599557    | five7532@163.com  |
</code></pre></div><br>
<h2 id="å¸¸ç”¨å¤„ç†æ–‡æœ¬æ•°æ®çš„æ–¹æ³•æ€»ç»“">å¸¸ç”¨å¤„ç†æ–‡æœ¬æ•°æ®çš„æ–¹æ³•æ€»ç»“</h2>
<p>Pythonå½“ä¸­ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²æ•°æ®çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼ŒåŸºæœ¬ä¸Šéƒ½å¯ä»¥åœ¨DataFrameå†…éƒ¨æ‹¿æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚lower()æ–¹æ³•å’Œupper()æ–¹æ³•ï¼Œç»™å­—æ¯å¤§å°å†™</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    tomoplplplut1248781
1             smopopo857
2         adahuhuifhhjfj
3            tull1945121
4       zpwerertfd599557
Name: å¾®ä¿¡ID, dtype: object
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    19
1    10
2    14
3    11
4    16
Name: å¾®ä¿¡ID, dtype: int64
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬çœ‹åˆ°æˆ·ç±åœ°å€è¿™ä¸€åˆ—ä¸­çš„æ•°æ®æœ‰å¾ˆå¤šçš„ç©ºæ ¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0                æµ™æ±ŸçœÂ·å®æ³¢å¸‚ 
1             æµ™æ±ŸçœÂ·æ­å·å¸‚    
2               æµ™æ±ŸçœÂ·ä¸½æ°´å¸‚  
3                æµ™æ±ŸçœÂ·è¡¢å·å¸‚ 
4      æµ™æ±ŸçœÂ·æ¹–å·å¸‚           
Name: æˆ·ç±åœ°å€, dtype: object
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤„ç†å­—ç¬¦ä¸²æ—¶çš„strip()æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    æµ™æ±ŸçœÂ·å®æ³¢å¸‚
1    æµ™æ±ŸçœÂ·æ­å·å¸‚
2    æµ™æ±ŸçœÂ·ä¸½æ°´å¸‚
3    æµ™æ±ŸçœÂ·è¡¢å·å¸‚
4    æµ™æ±ŸçœÂ·æ¹–å·å¸‚
Name: æˆ·ç±åœ°å€, dtype: object
</code></pre></div><p>ä¸ä¹‹ç›¸ç±»ä¼¼çš„è¿˜æœ‰lstrip()æ–¹æ³•ä»¥åŠrstrip()æ–¹æ³•ï¼Œè¿™é‡Œå°±ä¸åšèµ˜è¿°ã€‚</p>
<p>åœ¨å­—ç¬¦ä¸²çš„å¤„ç†è¿‡ç¨‹å½“ä¸­ï¼Œstartswith()æ–¹æ³•å’Œendswith()æ–¹æ³•ä¹Ÿæ˜¯ç”¨çš„éå¸¸çš„é¢‘ç¹ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³è¦æŒ‘é€‰å‡ºæˆ·ç±åœ°å€æ˜¯â€œå®æ³¢å¸‚â€çš„æ•°æ®ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&#34;å®æ³¢å¸‚&#34;</span><span class="p">)]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   å§“  å     æˆ·ç±åœ°å€                 å¾®ä¿¡ID              é‚®ç®±åœ°å€
0  æ  å  æµ™æ±ŸçœÂ·å®æ³¢å¸‚  Tomoplplplut1248781  tom02159@163.com
</code></pre></div><p>å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨replace()æ–¹æ³•æ¥å®ç°å½“ä¸­çš„å­—ç¬¦ä¸²çš„æ›¿æ¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">,</span> <span class="s2">&#34;--&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    æµ™æ±Ÿçœ--å®æ³¢å¸‚
1    æµ™æ±Ÿçœ--æ­å·å¸‚
2    æµ™æ±Ÿçœ--ä¸½æ°´å¸‚
3    æµ™æ±Ÿçœ--è¡¢å·å¸‚
4    æµ™æ±Ÿçœ--æ¹–å·å¸‚
Name: æˆ·ç±åœ°å€, dtype: object
</code></pre></div><p>é‚£æ—¢ç„¶ç”¨åˆ°äº†replace()æ–¹æ³•ï¼Œé‚£ä¹ˆsplit()æ–¹æ³•ä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    [æµ™æ±Ÿçœ, å®æ³¢å¸‚]
1    [æµ™æ±Ÿçœ, æ­å·å¸‚]
2    [æµ™æ±Ÿçœ, ä¸½æ°´å¸‚]
3    [æµ™æ±Ÿçœ, è¡¢å·å¸‚]
4    [æµ™æ±Ÿçœ, æ¹–å·å¸‚]
Name: æˆ·ç±åœ°å€, dtype: object
</code></pre></div><p>åœ¨ç»è¿‡spilit()æ–¹æ³•çš„åˆ‡å‰²è¿‡ä¹‹åå°±å˜æˆäº†åˆ—è¡¨çš„å½¢å¼ï¼Œç„¶åå¯ä»¥é€šè¿‡get()æ–¹æ³•æˆ–è€…[]æ¥è·å–é‡Œé¢çš„å…ƒç´ ï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div><p>æˆ–è€…</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    æµ™æ±Ÿçœ
1    æµ™æ±Ÿçœ
2    æµ™æ±Ÿçœ
3    æµ™æ±Ÿçœ
4    æµ™æ±Ÿçœ
Name: æˆ·ç±åœ°å€, dtype: object
</code></pre></div><p>é‚£ä¹ˆè·å–åˆ—è¡¨å½“ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨split()æ–¹æ³•å½“ä¸­æ·»åŠ expand=Trueè¿™ä¸ªå‚æ•°ï¼Œæ¥å°†ä¸Šé¢åˆ—è¡¨å½¢å¼çš„æ•°æ®è½¬åŒ–æˆDataFrameæ ¼å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">      0    1
0  æµ™æ±Ÿçœ  å®æ³¢å¸‚
1  æµ™æ±Ÿçœ  æ­å·å¸‚
2  æµ™æ±Ÿçœ  ä¸½æ°´å¸‚
3  æµ™æ±Ÿçœ  è¡¢å·å¸‚
4  æµ™æ±Ÿçœ  æ¹–å·å¸‚
</code></pre></div><p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åé¢æ·»åŠ []æ¥è·å–æˆ‘ä»¬æƒ³è¦çš„å…ƒç´ </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Â·&#34;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    å®æ³¢å¸‚
1    æ­å·å¸‚
2    ä¸½æ°´å¸‚
3    è¡¢å·å¸‚
4    æ¹–å·å¸‚
Name: 1, dtype: object
</code></pre></div><br>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼ä¸dataframeå†…éƒ¨æ–¹æ³•çš„ç»“åˆ">æ­£åˆ™è¡¨è¾¾å¼ä¸DataFrameå†…éƒ¨æ–¹æ³•çš„ç»“åˆ</h2>
<p>å‡å¦‚æˆ‘ä»¬æƒ³è¦æå–æ–‡æœ¬æ•°æ®å†…éƒ¨çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¯ä»¥ç»“åˆæ­£åˆ™è¡¨è¾¾å¼æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³è¦æå–â€œå¾®ä¿¡IDâ€è¿™ä¸€åˆ—å½“ä¸­çš„å­—æ¯å’Œæ•°å­—ï¼Œå¹¶ä¸”å°†ä¸¤è€…åˆ†å¼€æ¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">two_groups</span> <span class="o">=</span> <span class="s2">&#34;([a-zA-Z]+)([0-9]+)&#34;</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">two_groups</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">              0        1
0  Tomoplplplut  1248781
1       Smopopo      857
2           NaN      NaN
3          Tull  1945121
4    ZPWERERTFD   599557
</code></pre></div><p>å½“ç„¶äº†ï¼Œå¦‚æœæƒ³æ˜¯è¦æå–æ–‡æœ¬æ•°æ®ä¸­çš„éƒ¨åˆ†æ•°æ®ï¼Œå¯ä»¥ç›´æ¥åœ¨stræ–¹æ³•åé¢æ·»åŠ ç´¢å¼•ï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;é‚®ç®±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    @163.com
1    @163.com
2    @163.com
3    @163.com
4    @163.com
Name: é‚®ç®±åœ°å€, dtype: object
</code></pre></div><p>å½“ç„¶ï¼Œä»å¦å¤–ä¸€ä¸ªè§’åº¦è®²ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®è®¤æ–‡æœ¬æ•°æ®æ˜¯å¦ç¬¦åˆæŸç§è§„å¾‹ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">two_groups</span> <span class="o">=</span> <span class="s2">&#34;([a-zA-Z]+)([0-9]+)&#34;</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">two_groups</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0     True
1     True
2    False
3     True
4     True
Name: å¾®ä¿¡ID, dtype: bool
</code></pre></div><p>å½“ä¸­æœ‰ä¸€ä¸ªä¸ºFalseï¼Œä¸æ»¡è¶³å­—æ¯+æ•°å­—çš„è§„å¾‹ï¼Œæˆ‘ä»¬å†è¿›ä¸€æ­¥ï¼Œå°†æ»¡è¶³æ¡ä»¶çš„æ•°æ®æå–å‡ºæ¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;å¾®ä¿¡ID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">two_groups</span><span class="p">)]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   å§“  å     æˆ·ç±åœ°å€                 å¾®ä¿¡ID               é‚®ç®±åœ°å€
0  æ  å  æµ™æ±ŸçœÂ·å®æ³¢å¸‚  Tomoplplplut1248781   tom02159@163.com
1  ç‹  ç¡•  æµ™æ±ŸçœÂ·æ­å·å¸‚           Smopopo857  smitt7821@163.com
3  æ  å››  æµ™æ±ŸçœÂ·è¡¢å·å¸‚          Tull1945121   tull0305@163.com
4  å¼   ä¸‰  æµ™æ±ŸçœÂ·æ¹–å·å¸‚     ZPWERERTFD599557   five7532@163.com
</code></pre></div><p>é’ˆå¯¹æ–‡æœ¬æ•°æ®è€Œè¨€ï¼Œcontains()æ–¹æ³•ä¹Ÿèƒ½å¤Ÿæ´¾ä¸Šç”¨åœºï¼Œä¾‹å¦‚ä¸‹é¢çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   å§“   å                  æˆ·ç±åœ°å€                 å¾®ä¿¡ID               é‚®ç®±åœ°å€
0  æ   å              æµ™æ±ŸçœÂ·å®æ³¢å¸‚   Tomoplplplut1248781   tom02159@163.com
1  ç‹   ç¡•           æµ™æ±ŸçœÂ·æ­å·å¸‚               Smopopo857  smitt7821@163.com
2  æˆ´  å»ºä¸š             æµ™æ±ŸçœÂ·ä¸½æ°´å¸‚         Adahuhuifhhjfj   adams623@163.com
3  æ   å››              æµ™æ±ŸçœÂ·è¡¢å·å¸‚           Tull1945121   tull0305@163.com
4  å¼    ä¸‰    æµ™æ±ŸçœÂ·æ¹–å·å¸‚                ZPWERERTFD599557   five7532@163.com
5  é»„   äº”               æµ™æ±ŸçœÂ·å®æ³¢å¸‚        hunhunhu45652  1erdcvf127@16.com
</code></pre></div><p>æˆ‘ä»¬ç”¨contains()æ¥æå–å‡ºæˆ·ç±åœ°å€ä¸ºâ€œå®æ³¢å¸‚â€çš„å†…å®¹ï¼Œå¯ä»¥è¿™ä¹ˆåš</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æˆ·ç±åœ°å€&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&#34;å®æ³¢å¸‚&#34;</span><span class="p">)]</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   å§“  å     æˆ·ç±åœ°å€                 å¾®ä¿¡ID               é‚®ç®±åœ°å€
0  æ  å  æµ™æ±ŸçœÂ·å®æ³¢å¸‚  Tomoplplplut1248781   tom02159@163.com
5  é»„  äº”  æµ™æ±ŸçœÂ·å®æ³¢å¸‚        hunhunhu45652  1erdcvf127@16.com
</code></pre></div><p>æš‚æ—¶å°±è¿™äº›äº†ï¼Œä¸‹ä¸€ç¯‡åŸåˆ›çš„æ–‡ç« å®‰æ’åœ¨å‘¨å¤©ï¼ŒéæŠ€æœ¯æ–¹é¢çš„ï¼ŒæœŸå¾…ä¸€ä¸‹ï¼Ÿ</p>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>æ¨è20ä¸ªå¥½ç”¨åˆ°çˆ†çš„Pandaså‡½æ•°æ–¹æ³•</title>
      <link>https://hidadeng.github.io/blog/pandas_20_most_usefull_functions/</link>
      <pubDate>Tue, 16 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/pandas_20_most_usefull_functions/</guid>
      <description>4000å­—è¯¦ç»†è¯´æ˜</description>
      <content:encoded><![CDATA[<p>ä»Šå¤©åˆ†äº«å‡ ä¸ªä¸ä¸ºäººçŸ¥çš„pandaså‡½æ•°ï¼Œå¤§å®¶å¯èƒ½å¹³æ—¶çœ‹åˆ°çš„ä¸å¤šï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥å€’æ˜¯éå¸¸çš„æ–¹ä¾¿ï¼Œä¹Ÿèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ•°æ®åˆ†æäººå‘˜å¤§å¹…åº¦åœ°æé«˜å·¥ä½œæ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›å¤§å®¶çœ‹å®Œä¹‹åèƒ½å¤Ÿæœ‰æ‰€æ”¶è·</p>
<br>
<br>
<h2 id="itemsæ–¹æ³•">items()æ–¹æ³•</h2>
<p>pandaså½“ä¸­çš„<code>items()</code>æ–¹æ³•å¯ä»¥ç”¨æ¥éå†æ•°æ®é›†å½“ä¸­çš„æ¯ä¸€åˆ—ï¼ŒåŒæ—¶è¿”å›åˆ—åä»¥åŠæ¯ä¸€åˆ—å½“ä¸­çš„å†…å®¹ï¼Œé€šè¿‡ä»¥å…ƒç»„çš„å½¢å¼ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="s1">&#39;marsupial&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1864</span><span class="p">,</span> <span class="mi">22000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">]},</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;panda&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;koala&#39;</span><span class="p">])</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       | species   |   population |
|:------|:----------|-------------:|
| panda | bear      |         1864 |
| polar | bear      |        22000 |
| koala | marsupial |        80000 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;label: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;content: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div><pre><code>label: species
content: panda         bear
polar         bear
koala    marsupial
Name: species, dtype: object
==================================================
label: population
content: panda     1864
polar    22000
koala    80000
Name: population, dtype: int64
==================================================
</code></pre>
<p>ç›¸ç»§çš„æ‰“å°å‡ºäº†â€˜speciesâ€™å’Œâ€˜populationâ€™è¿™ä¸¤åˆ—çš„åˆ—åå’Œç›¸åº”çš„å†…å®¹</p>
<br>
<h2 id="iterrowsæ–¹æ³•">iterrows()æ–¹æ³•</h2>
<p>è€Œå¯¹äº<code>iterrows()</code>æ–¹æ³•è€Œè¨€ï¼Œå…¶åŠŸèƒ½åˆ™æ˜¯éå†æ•°æ®é›†å½“ä¸­çš„æ¯ä¸€è¡Œï¼Œè¿”å›æ¯ä¸€è¡Œçš„ç´¢å¼•ä»¥åŠå¸¦æœ‰åˆ—åçš„æ¯ä¸€è¡Œçš„å†…å®¹ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;label: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;content: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div><pre><code>label: panda
content: species       bear
population    1864
Name: panda, dtype: object
==================================================
label: polar
content: species        bear
population    22000
Name: polar, dtype: object
==================================================
label: koala
content: species       marsupial
population        80000
Name: koala, dtype: object
==================================================
</code></pre>
<br>
<h2 id="insertæ–¹æ³•">insert()æ–¹æ³•</h2>
<p><code>insert()</code>æ–¹æ³•ä¸»è¦æ˜¯ç”¨äºåœ¨æ•°æ®é›†å½“ä¸­çš„ç‰¹å®šä½ç½®å¤„æ’å…¥æ•°æ®ã€‚åœ¨DataFrameæ•°æ®é›†å½“ä¸­ï¼Œåˆ—çš„ç´¢å¼•ä¹Ÿæ˜¯ä»0å¼€å§‹çš„</p>
<p>ç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#åœ¨ç¬¬äºŒåˆ—æ’å…¥sizeå­—æ®µï¼Œå†…å®¹å¦‚ä¸‹</span>
<span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;size&#34;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">])</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">
|       | species   |   size |   population |
|:------|:----------|-------:|-------------:|
| panda | bear      |   2000 |         1864 |
| polar | bear      |   3000 |        22000 |
| koala | marsupial |   4000 |        80000 |
</code></pre></div><br>
<h2 id="assignæ–¹æ³•">assign()æ–¹æ³•</h2>
<p><code>assign()</code>æ–¹æ³•å¯ä»¥ç”¨æ¥åœ¨æ•°æ®é›†å½“ä¸­æ·»åŠ æ–°çš„åˆ—ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">size_1</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">population</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       | species   |   size |   population |   size_1 |
|:------|:----------|-------:|-------------:|---------:|
| panda | bear      |   2000 |         1864 |   3387.2 |
| polar | bear      |   3000 |        22000 |  39632   |
| koala | marsupial |   4000 |        80000 | 144032   |
</code></pre></div><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªlambdaåŒ¿åå‡½æ•°ï¼Œåœ¨æ•°æ®é›†å½“ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„åˆ—ï¼Œå‘½åä¸º<strong>size_1</strong>ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡assign()æ–¹æ³•æ¥åˆ›å»ºä¸æ­¢ä¸€ä¸ªåˆ—</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">size_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">population</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">,</span>
               <span class="n">size_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">population</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       | species   |   size |   population |   size_1 |   size_2 |
|:------|:----------|-------:|-------------:|---------:|---------:|
| panda | bear      |   2000 |         1864 |   3387.2 |   2992.4 |
| polar | bear      |   3000 |        22000 |  39632   |  35210   |
| koala | marsupial |   4000 |        80000 | 144032   | 128010   |
</code></pre></div><br>
<h2 id="evalæ–¹æ³•">eval()æ–¹æ³•</h2>
<p><code>eval()</code>æ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥æ‰§è¡Œç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºçš„è¿ç®—è¿‡ç¨‹çš„ï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&#34;size_3 = size_1 + size_2&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       | species   |   size |   population |   size_1 |   size_2 |   size_3 |
|:------|:----------|-------:|-------------:|---------:|---------:|---------:|
| panda | bear      |   2000 |         1864 |   3387.2 |   2992.4 |   6379.6 |
| polar | bear      |   3000 |        22000 |  39632   |  35210   |  74842   |
| koala | marsupial |   4000 |        80000 | 144032   | 128010   | 272042   |
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶å¯¹æ‰§è¡Œå¤šä¸ªè¿ç®—è¿‡ç¨‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;
</span><span class="s1">size_3 = size_1 + size_2
</span><span class="s1">size_4 = size_1 - size_2
</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       | species   |   size |   population |   size_1 |   size_2 |   size_3 |   size_4 |
|:------|:----------|-------:|-------------:|---------:|---------:|---------:|---------:|
| panda | bear      |   2000 |         1864 |   3387.2 |   2992.4 |   6379.6 |    394.8 |
| polar | bear      |   3000 |        22000 |  39632   |  35210   |  74842   |   4422   |
| koala | marsupial |   4000 |        80000 | 144032   | 128010   | 272042   |  16022   |
</code></pre></div><br>
<h2 id="popæ–¹æ³•">pop()æ–¹æ³•</h2>
<p>pop()æ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥åˆ é™¤æ‰æ•°æ®é›†ä¸­ç‰¹å®šçš„æŸä¸€åˆ—æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&#34;size_3&#34;</span><span class="p">)</span>
</code></pre></div><p>è€ŒåŸå…ˆçš„æ•°æ®é›†å½“ä¸­å°±æ²¡æœ‰è¿™ä¸ªâ€˜size_3â€™è¿™ä¸€ä¾‹çš„æ•°æ®äº†</p>
<br>
<h2 id="truncateæ–¹æ³•">truncate()æ–¹æ³•</h2>
<p><code>truncate()</code>æ–¹æ³•ä¸»è¦æ˜¯æ ¹æ®è¡Œç´¢å¼•æ¥ç­›é€‰æŒ‡å®šè¡Œçš„æ•°æ®çš„ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]},</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | A   | B   | C   |
|---:|:----|:----|:----|
|  1 | a   | f   | k   |
|  2 | b   | g   | l   |
|  3 | c   | h   | m   |
|  4 | d   | i   | n   |
|  5 | e   | j   | o   |
</code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨<code>truncate()</code>æ–¹æ³•æ¥åšä¸€ä¸‹å°è¯•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">before</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">after</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | A   | B   | C   |
|---:|:----|:----|:----|
|  2 | b   | g   | l   |
|  3 | c   | h   | m   |
|  4 | d   | i   | n   |
</code></pre></div><p>æˆ‘ä»¬çœ‹åˆ°å‚æ•°beforeå’Œafterå­˜åœ¨äºtruncate()æ–¹æ³•ä¸­ï¼Œç›®çš„å°±æ˜¯æŠŠè¡Œç´¢å¼•2ä¹‹å‰å’Œè¡Œç´¢å¼•4ä¹‹åçš„æ•°æ®æ’é™¤åœ¨å¤–ï¼Œç­›é€‰å‡ºå‰©ä½™çš„æ•°æ®</p>
<br>
<h2 id="countæ–¹æ³•">count()æ–¹æ³•</h2>
<p><code>count()</code>æ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥è®¡ç®—æŸä¸€åˆ—å½“ä¸­éç©ºå€¼çš„ä¸ªæ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&#34;Name&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;John&#34;</span><span class="p">,</span> <span class="s2">&#34;Myla&#34;</span><span class="p">,</span> <span class="s2">&#34;Lewis&#34;</span><span class="p">,</span> <span class="s2">&#34;John&#34;</span><span class="p">,</span> <span class="s2">&#34;John&#34;</span><span class="p">],</span>
                   <span class="s2">&#34;Age&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mf">24.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">26</span><span class="p">],</span>
                   <span class="s2">&#34;Single&#34;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]})</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | Name   |   Age |   Single |
|---:|:-------|------:|---------:|
|  0 | John   |    24 |        1 |
|  1 | Myla   |   nan |        1 |
|  2 | Lewis  |    25 |      nan |
|  3 | John   |    33 |        1 |
|  4 | John   |    26 |        0 |
</code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨count()æ–¹æ³•æ¥è®¡ç®—ä¸€ä¸‹æ•°æ®é›†å½“ä¸­éç©ºå€¼çš„ä¸ªæ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</code></pre></div><pre><code>Name      5
Age       4
Single    4
dtype: int64
</code></pre>
<br>
<h2 id="add_prefixæ–¹æ³•add_suffixæ–¹æ³•">add_prefix()æ–¹æ³•/add_suffix()æ–¹æ³•</h2>
<p><code>add_prefix()</code>æ–¹æ³•å’Œ<code>add_suffix()</code>æ–¹æ³•åˆ†åˆ«ä¼šç»™åˆ—åä»¥åŠè¡Œç´¢å¼•æ·»åŠ åç¼€å’Œå‰ç¼€ï¼Œå¯¹äº<code>Series()</code>æ•°æ®é›†è€Œè¨€ï¼Œå‰ç¼€ä¸åç¼€æ˜¯æ·»åŠ åœ¨è¡Œç´¢å¼•å¤„ï¼Œè€Œå¯¹äº<code>DataFrame()</code>æ•°æ®é›†è€Œè¨€ï¼Œå‰ç¼€ä¸åç¼€æ˜¯æ·»åŠ åœ¨åˆ—ç´¢å¼•å¤„ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">s</span>
</code></pre></div><pre><code>0    1
1    2
2    3
3    4
dtype: int64
</code></pre>
<p>æˆ‘ä»¬ä½¿ç”¨add_prefix()æ–¹æ³•ä¸add_suffix()æ–¹æ³•åœ¨Series()æ•°æ®é›†ä¸Š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;row_&#39;</span><span class="p">)</span>
</code></pre></div><pre><code>row_0    1
row_1    2
row_2    3
row_3    4
dtype: int64
</code></pre>
<p>åˆä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s1">&#39;_row&#39;</span><span class="p">)</span>
</code></pre></div><pre><code>0_row    1
1_row    2
2_row    3
3_row    4
dtype: int64
</code></pre>
<p>è€Œå¯¹äº<code>DataFrame()</code>å½¢å¼æ•°æ®é›†è€Œè¨€ï¼Œ<code>add_prefix()</code>æ–¹æ³•ä»¥åŠ<code>add_suffix()</code>æ–¹æ³•æ˜¯å°†å‰ç¼€ä¸åç¼€æ·»åŠ åœ¨åˆ—ç´¢å¼•å¤„çš„</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> 
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   A |   B |
|---:|----:|----:|
|  0 |   1 |   3 |
|  1 |   2 |   4 |
|  2 |   3 |   5 |
|  3 |   4 |   6 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&#34;column_&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   column_A |   column_B |
|---:|----:|----:|
|  0 |   1 |   3 |
|  1 |   2 |   4 |
|  2 |   3 |   5 |
|  3 |   4 |   6 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s2">&#34;_column&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   A_column |   B_column |
|---:|----:|----:|
|  0 |   1 |   3 |
|  1 |   2 |   4 |
|  2 |   3 |   5 |
|  3 |   4 |   6 |
</code></pre></div><br>
<h2 id="clipæ–¹æ³•">clip()æ–¹æ³•</h2>
<p><code>clip()</code>æ–¹æ³•ä¸»è¦æ˜¯é€šè¿‡è®¾ç½®é˜ˆå€¼æ¥æ”¹å˜æ•°æ®é›†å½“ä¸­çš„æ•°å€¼ï¼Œå½“æ•°å€¼è¶…è¿‡é˜ˆå€¼çš„æ—¶å€™ï¼Œå°±åšå‡ºç›¸åº”çš„è°ƒæ•´</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;col_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">
|    |   col_0 |   col_1 |
|---:|--------:|--------:|
|  0 |       9 |      -2 |
|  1 |      -3 |      -7 |
|  2 |       0 |       6 |
|  3 |      -1 |       8 |
|  4 |       5 |      -5 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   col_0 |   col_1 |
|---:|--------:|--------:|
|  0 |       4 |      -2 |
|  1 |      -3 |      -4 |
|  2 |       0 |       4 |
|  3 |      -1 |       4 |
|  4 |       4 |      -4 |
</code></pre></div><p>æˆ‘ä»¬çœ‹åˆ°å‚æ•°lowerå’Œupperåˆ†åˆ«ä»£è¡¨é˜ˆå€¼çš„ä¸Šé™ä¸ä¸‹é™ï¼Œæ•°æ®é›†å½“ä¸­è¶…è¿‡ä¸Šé™ä¸ä¸‹é™çš„å€¼ä¼šè¢«æ›¿ä»£ã€‚</p>
<br>
<h2 id="filteræ–¹æ³•">filter()æ–¹æ³•</h2>
<p>pandaså½“ä¸­çš„<code>filter()</code>æ–¹æ³•æ˜¯ç”¨æ¥ç­›é€‰å‡ºç‰¹å®šèŒƒå›´çš„æ•°æ®çš„ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])),</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   one |   two |   three |
|:---|------:|------:|--------:|
| A  |     1 |     2 |       3 |
| B  |     4 |     5 |       6 |
| C  |     7 |     8 |       9 |
| D  |    10 |    11 |      12 |
</code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨filter()æ–¹æ³•æ¥ç­›é€‰æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   one |   three |
|:---|------:|--------:|
| A  |     1 |       3 |
| B  |     4 |       6 |
| C  |     7 |       9 |
| D  |    10 |      12 |
</code></pre></div><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥ç­›é€‰æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#å­—æ®µåeç»“å°¾çš„åˆ—</span>
<span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;e$&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   one |   three |
|:---|------:|--------:|
| A  |     1 |       3 |
| B  |     4 |       6 |
| C  |     7 |       9 |
| D  |    10 |      12 |

</code></pre></div><p>å½“ç„¶é€šè¿‡å‚æ•°axisæ¥è°ƒæ•´ç­›é€‰è¡Œæ–¹å‘æˆ–è€…æ˜¯åˆ—æ–¹å‘çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   one |   two |   three |
|:---|------:|------:|--------:|
| B  |     4 |     5 |       6 |
</code></pre></div><br>
<h2 id="firstæ–¹æ³•">first()æ–¹æ³•</h2>
<p>å½“æ•°æ®é›†å½“ä¸­çš„è¡Œç´¢å¼•æ˜¯æ—¥æœŸçš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•æ¥ç­›é€‰å‰é¢å‡ è¡Œçš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">index_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2021-11-11&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">index_1</span><span class="p">)</span>
<span class="n">ts</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|                     |   A |
|:--------------------|----:|
| 2021-11-11 00:00:00 |   1 |
| 2021-11-13 00:00:00 |   2 |
| 2021-11-15 00:00:00 |   3 |
| 2021-11-17 00:00:00 |   4 |
| 2021-11-19 00:00:00 |   5 |
</code></pre></div><br>
<p>æˆ‘ä»¬ä½¿ç”¨first()æ–¹æ³•æ¥è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ç­›é€‰å‡ºå‰é¢3å¤©çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ts</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;3D&#39;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|                     |   A |
|:--------------------|----:|
| 2021-11-11 00:00:00 |   1 |
| 2021-11-13 00:00:00 |   2 |
</code></pre></div><br>
<h2 id="isinæ–¹æ³•">isin()æ–¹æ³•</h2>
<p>isin()æ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥ç¡®è®¤æ•°æ®é›†å½“ä¸­çš„æ•°å€¼æ˜¯å¦è¢«åŒ…å«åœ¨ç»™å®šçš„åˆ—è¡¨å½“ä¸­</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> 
                            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> 
                            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> 
                            <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])),</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   one |   two |   three |
|:---|------:|------:|--------:|
| A  |     0 |     0 |       1 |
| B  |     0 |     1 |       0 |
| C  |     0 |     0 |       0 |
| D  |     0 |     0 |       1 |
</code></pre></div><p>è‹¥æ˜¯æ•°å€¼è¢«åŒ…å«åœ¨åˆ—è¡¨å½“ä¸­äº†ï¼Œä¹Ÿå°±æ˜¯3ã€5ã€12å½“ä¸­ï¼Œè¿”å›çš„æ˜¯Trueï¼Œå¦åˆ™å°±è¿”å›False</p>
<br>
<h2 id="dfplotareaæ–¹æ³•">df.plot.area()æ–¹æ³•</h2>
<p>ä¸‹é¢æˆ‘ä»¬æ¥è®²ä¸€ä¸‹å¦‚ä½•åœ¨Pandaså½“ä¸­é€šè¿‡ä¸€è¡Œä»£ç æ¥ç»˜åˆ¶å›¾è¡¨ï¼Œå°†æ‰€æœ‰çš„åˆ—éƒ½é€šè¿‡é¢ç§¯å›¾çš„æ–¹å¼æ¥ç»˜åˆ¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">65</span><span class="p">],</span>
    <span class="s1">&#39;signups&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
    <span class="s1">&#39;visits&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
<span class="p">},</span> 
    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2021/01/01&#39;</span><span class="p">,</span> 
                        <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2021/07/01&#39;</span><span class="p">,</span> 
                        <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|                     |   sales |   signups |   visits |
|:--------------------|--------:|----------:|---------:|
| 2021-01-31 00:00:00 |      30 |         7 |       20 |
| 2021-02-28 00:00:00 |      20 |         9 |       42 |
| 2021-03-31 00:00:00 |      38 |         6 |       28 |
| 2021-04-30 00:00:00 |      95 |        12 |       62 |
| 2021-05-31 00:00:00 |     106 |        18 |       81 |
| 2021-06-30 00:00:00 |      65 |        13 |       50 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</code></pre></div>
<figure >
    
        <img src="img/output_79_0.png" width="800" />
    
    
</figure>

<br>
<h2 id="dfplotbaræ–¹æ³•">df.plot.bar()æ–¹æ³•</h2>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•é€šè¿‡ä¸€è¡Œä»£ç æ¥ç»˜åˆ¶æŸ±çŠ¶å›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;label&#39;</span><span class="p">:[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="s1">&#39;values&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">]})</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | label   |   values |
|---:|:--------|---------:|
|  0 | A       |       10 |
|  1 | B       |       30 |
|  2 | C       |       50 |
|  3 | D       |       70 |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> 
                 <span class="n">y</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> 
                 <span class="n">rot</span><span class="o">=-</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_83_0.png" />
    
    
</figure>

<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®ä¸åŒçš„ç±»åˆ«æ¥ç»˜åˆ¶æŸ±çŠ¶å›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">age</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="n">weight</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span> 
                   <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight</span><span class="p">},</span> 
                   <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_85_0.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/output_86_0.png" width="800" />
    
    
</figure>

<br>
<h2 id="dfplotboxæ–¹æ³•">df.plot.box()æ–¹æ³•</h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç®±å‹å›¾çš„å…·ä½“çš„ç»˜åˆ¶ï¼Œé€šè¿‡pandasä¸€è¡Œä»£ç æ¥å®ç°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |         A |          B |          C |
|---:|----------:|-----------:|-----------:|
|  0 | -1.59132  |  1.47926   |  1.16891   |
|  1 | -0.649097 |  0.0501129 | -0.81485   |
|  2 |  1.31677  |  1.00035   |  0.0662983 |
|  3 | -1.04484  |  0.445727  |  0.0140137 |
|  4 |  0.217317 | -0.692044  | -0.758549  |
|  5 | -0.566574 | -0.159038  |  0.781744  |
|  6 | -0.903068 |  1.50697   |  1.2605    |
|  7 |  1.38627  | -0.0539971 | -0.0619803 |
|  8 | -1.50639  | -0.187649  |  1.00115   |
|  9 | -1.84435  | -1.37282   |  0.905218  |
| 10 | -0.400618 |  0.503642  |  1.20152   |
| 11 | -0.164643 |  1.58712   | -0.0475168 |
| 12 |  1.99742  | -0.928291  |  0.502433  |
| 13 | -1.25877  |  2.0764    | -0.840626  |
| 14 | -0.293273 | -2.09935   | -0.152372  |
| 15 | -0.686338 |  0.798964  |  1.4551    |
| 16 |  0.407321 |  0.601732  |  0.456718  |
| 17 |  0.594827 | -1.8498    |  1.22704   |
| 18 | -0.345245 | -1.27973   | -0.0971918 |
| 19 |  1.91415  |  0.656389  | -1.15816   |
| 20 |  0.149819 |  1.10037   | -0.0785313 |
| 21 | -0.311471 | -1.10781   |  0.707936  |
| 22 |  0.614726 | -0.142359  | -1.23091   |
| 23 |  1.46869  |  1.27063   |  0.797499  |
| 24 | -1.02252  |  0.819603  | -0.220382  |
</code></pre></div><br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/output_90_0.png" width="800" />
    
    
</figure>

<br>
<h2 id="dfplotpieæ–¹æ³•">df.plot.pie()æ–¹æ³•</h2>
<p>æ¥ä¸‹æ¥æ˜¯é¥¼å›¾çš„ç»˜åˆ¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.33</span><span class="p">,</span> <span class="mf">4.87</span> <span class="p">,</span> <span class="mf">5.97</span><span class="p">],</span>
                   <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2439.7</span><span class="p">,</span> <span class="mf">6051.8</span><span class="p">,</span> <span class="mf">6378.1</span><span class="p">]},</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Venus&#39;</span><span class="p">,</span> <span class="s1">&#39;Earth&#39;</span><span class="p">])</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div>
<figure >
    
        <img src="img/output_92_0.png" width="800" />
    
    
</figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰æŠ˜çº¿å›¾ã€ç›´æ–¹å›¾ã€æ•£ç‚¹å›¾ç­‰ç­‰ï¼Œæ­¥éª¤ä¸æ–¹å¼éƒ½ä¸ä¸Šè¿°çš„æŠ€å·§æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œå¤§å®¶æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å¦å¤–å»å°è¯•ã€‚</p>
<br>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/4000%E5%AD%97%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E_%E6%8E%A8%E8%8D%9020%E4%B8%AA%E5%A5%BD%E7%94%A8%E5%88%B0%E7%88%86%E7%9A%84Pandas%E5%87%BD%E6%95%B0%E6%96%B9%E6%B3%95.ipynb">https://github.com/hidadeng/DaDengAndHisPython/blob/master/4000å­—è¯¦ç»†è¯´æ˜_æ¨è20ä¸ªå¥½ç”¨åˆ°çˆ†çš„Pandaså‡½æ•°æ–¹æ³•.ipynb</a></p>
<br>
<blockquote>
<p>src: <a href="https://mp.weixin.qq.com/s/PEhYrNbZyI9Prl3OwrBcAw">https://mp.weixin.qq.com/s/PEhYrNbZyI9Prl3OwrBcAw</a></p>
<p>author: ä¿Šæ¬£
å…¬ä¼—å·: å…³äºæ•°æ®åˆ†æä¸å¯è§†åŒ–</p>
</blockquote>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>æ¨è|pandaså¿…çŸ¥å¿…ä¼š50ä¾‹</title>
      <link>https://hidadeng.github.io/blog/pandas_must_know_50_examples/</link>
      <pubDate>Tue, 16 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/pandas_must_know_50_examples/</guid>
      <description>pandaså¸¸ç”¨çŸ¥è¯†8000å­—è¯¦ç»†è¯´æ˜</description>
      <content:encoded><![CDATA[<blockquote>
<p>src: <a href="https://mp.weixin.qq.com/s/j71IPWmT57g3VTajGhgN7Q">https://mp.weixin.qq.com/s/j71IPWmT57g3VTajGhgN7Q</a>
author: ä¿Šæ¬£
å…¬ä¼—å·: å…³äºæ•°æ®åˆ†æä¸å¯è§†åŒ–</p>
</blockquote>
<br>
<p>æœ¬ç¯‡æˆ‘ä»¬ç»§ç»­å‰é¢pandasç³»åˆ—æ•™ç¨‹çš„æ¢è®¨ï¼Œä»Šå¤©å°ç¼–ä¼šä»‹ç»pandasåº“å½“ä¸­ä¸€äº›éå¸¸åŸºç¡€çš„æ–¹æ³•ä¸å‡½æ•°ï¼Œå¸Œæœ›å¤§å®¶çœ‹äº†ä¹‹åä¼šæœ‰æ‰€æ”¶è·ã€‚</p>
<h2 id="å‡†å¤‡éœ€è¦çš„æ•°æ®é›†">å‡†å¤‡éœ€è¦çš„æ•°æ®é›†</h2>
<p>æˆ‘ä»¬å…ˆå‡†å¤‡ç”Ÿæˆä¸€äº›éšæœºæ•°ï¼Œä½œä¸ºåé¢éœ€è¦ç”¨åˆ°çš„æ•°æ®é›†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&#34;1/1/2000&#34;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">,</span> <span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="s2">&#34;e&#34;</span><span class="p">])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
                  <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">])</span>

</code></pre></div><br>
<h2 id="head-and-tail">Head and tail</h2>
<p>head()å’Œtail()æ–¹æ³•æ˜¯ç”¨æ¥æŸ¥çœ‹æ•°æ®é›†å½“ä¸­çš„å‰å‡ è¡Œå’Œæœ«å°¾å‡ è¡Œçš„ï¼Œé»˜è®¤æ˜¯æŸ¥çœ‹5è¡Œï¼Œå½“ç„¶è¯»è€…æœ‹å‹ä¹Ÿå¯ä»¥è‡ªè¡Œè®¾å®šè¡Œæ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">series2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">series2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><pre><code>0    0.578276
1    0.643313
2   -0.336030
3   -0.422468
4   -0.493812
dtype: float64
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># åŒç†</span>
<span class="n">series2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div><pre><code>95    1.307962
96    1.165135
97    0.717692
98    0.605668
99    0.264990
dtype: float64
</code></pre>
<br>
<h2 id="æ•°æ®çš„ç»Ÿè®¡åˆ†æ">æ•°æ®çš„ç»Ÿè®¡åˆ†æ</h2>
<p>åœ¨pandaså½“ä¸­ç”¨describe()æ–¹æ³•æ¥å¯¹è¡¨æ ¼ä¸­çš„æ•°æ®åšä¸€ä¸ªæ¦‚æ‹¬æ€§çš„ç»Ÿè®¡åˆ†æï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">series2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div><pre><code>count    100.000000
mean       0.106277
std        1.027541
min       -2.554005
25%       -0.510912
50%        0.028765
75%        0.795444
max        2.512260
dtype: float64
</code></pre>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®å¥½è¾“å‡ºçš„åˆ†ä½</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">series2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
</code></pre></div><pre><code>count    100.000000
mean       0.106277
std        1.027541
min       -2.554005
5%        -1.450067
25%       -0.510912
50%        0.028765
75%        0.795444
95%        1.757926
max        2.512260
dtype: float64
</code></pre>
<p>å¯¹äºç¦»æ•£å‹çš„æ•°æ®æ¥è¯´ï¼Œdescribe()æ–¹æ³•ç»™å‡ºçš„ç»“æœåˆ™ä¼šç®€æ´å¾ˆå¤š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">,</span> <span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="s2">&#34;a&#34;</span><span class="p">])</span>
<span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div><pre><code>count     10
unique     4
top        a
freq       5
dtype: object
</code></pre>
<p>è¦æ˜¯è¡¨æ ¼ä¸­æ—¢åŒ…å«äº†ç¦»æ•£å‹æ•°æ®ï¼Œä¹ŸåŒ…å«äº†è¿ç»­å‹çš„æ•°æ®ï¼Œé»˜è®¤çš„è¯ï¼Œdescribe()æ˜¯ä¼šé’ˆå¯¹<strong>è¿ç»­å‹æ•°æ®</strong>è¿›è¡Œç»Ÿè®¡åˆ†æ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&#34;a&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;Yes&#34;</span><span class="p">,</span> <span class="s2">&#34;Yes&#34;</span><span class="p">,</span> <span class="s2">&#34;No&#34;</span><span class="p">,</span> <span class="s2">&#34;No&#34;</span><span class="p">],</span> <span class="s2">&#34;b&#34;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">)})</span>
<span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       |        b |
|:------|---------:|
| count | 4        |
| mean  | 0.967026 |
| std   | 0.859657 |
| min   | 0.204027 |
| 25%   | 0.233797 |
| 50%   | 0.947075 |
| 75%   | 1.6803   |
| max   | 1.76993  |
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè®©å…¶å¼ºåˆ¶ç»Ÿè®¡åˆ†æç¦»æ•£å‹æ•°æ®æˆ–è€…è¿ç»­å‹æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;object&#34;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|        | a   |
|:-------|:----|
| count  | 4   |
| unique | 2   |
| top    | Yes |
| freq   | 2   |
</code></pre></div><p>åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè¿ç»­å‹çš„æ•°æ®è¿›è¡Œç»Ÿè®¡åˆ†æ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;number&#34;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|       |        b |
|:------|---------:|
| count | 4        |
| mean  | 0.967026 |
| std   | 0.859657 |
| min   | 0.204027 |
| 25%   | 0.233797 |
| 50%   | 0.947075 |
| 75%   | 1.6803   |
| max   | 1.76993  |
</code></pre></div><p>å¦‚æœæˆ‘ä»¬éƒ½è¦å»åšç»Ÿè®¡åˆ†æï¼Œå¯ä»¥è¿™ä¹ˆæ¥æ‰§è¡Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&#34;all&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|        | a   |          b |
|:-------|:----|-----------:|
| count  | 4   |   4        |
| unique | 2   | nan        |
| top    | Yes | nan        |
| freq   | 2   | nan        |
| mean   | nan |   0.967026 |
| std    | nan |   0.859657 |
| min    | nan |   0.204027 |
| 25%    | nan |   0.233797 |
| 50%    | nan |   0.947075 |
| 75%    | nan |   1.6803   |
| max    | nan |   1.76993  |
</code></pre></div><br>
<h2 id="æœ€å¤§æœ€å°å€¼çš„ä½ç½®">æœ€å¤§/æœ€å°å€¼çš„ä½ç½®</h2>
<p>idxmin()å’Œidxmax()æ–¹æ³•æ˜¯ç”¨æ¥æŸ¥æ‰¾è¡¨æ ¼å½“ä¸­æœ€å¤§/æœ€å°å€¼çš„ä½ç½®ï¼Œè¿”å›çš„æ˜¯å€¼çš„ç´¢å¼•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">s1</span>
</code></pre></div><pre><code>0    2.244266
1    1.398258
2   -1.827026
3   -0.058691
4    0.275471
dtype: float64
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(),</span> <span class="n">s1</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</code></pre></div><pre><code>(2, 0)
</code></pre>
<p>ç”¨åœ¨DataFrameä¸Šé¢çš„è¯ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">])</span>
<span class="n">df1</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    |   0 |
|:---|----:|
| A  |   2 |
| B  |   3 |
| C  |   2 |
</code></pre></div><p>åŒç†ï¼Œæˆ‘ä»¬å°†axiså‚æ•°æ”¹æˆ1</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | 0   |
|---:|:----|
|  0 | B   |
|  1 | B   |
|  2 | A   |
|  3 | B   |
|  4 | B   |
</code></pre></div><br>
<h2 id="value_countsæ–¹æ³•">value_counts()æ–¹æ³•</h2>
<p>pandaså½“ä¸­çš„value_counts()æ–¹æ³•ä¸»è¦ç”¨äºæ•°æ®è¡¨çš„è®¡æ•°ä»¥åŠæ’åºï¼Œç”¨æ¥æŸ¥çœ‹è¡¨æ ¼å½“ä¸­ï¼ŒæŒ‡å®šåˆ—æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°æ®å€¼å¹¶ä¸”è®¡ç®—ä¸åŒå€¼åœ¨è¯¥åˆ—å½“ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;åŸå¸‚&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;åŒ—äº¬&#39;</span><span class="p">,</span> <span class="s1">&#39;å¹¿å·&#39;</span><span class="p">,</span> <span class="s1">&#39;ä¸Šæµ·&#39;</span><span class="p">,</span> <span class="s1">&#39;ä¸Šæµ·&#39;</span><span class="p">,</span> <span class="s1">&#39;æ­å·&#39;</span><span class="p">,</span> <span class="s1">&#39;æˆéƒ½&#39;</span><span class="p">,</span> <span class="s1">&#39;é¦™æ¸¯&#39;</span><span class="p">,</span> <span class="s1">&#39;å—äº¬&#39;</span><span class="p">,</span> <span class="s1">&#39;åŒ—äº¬&#39;</span><span class="p">,</span> <span class="s1">&#39;åŒ—äº¬&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;æ”¶å…¥&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">5500</span><span class="p">,</span> <span class="mi">5500</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">5200</span><span class="p">,</span> <span class="mi">5600</span><span class="p">],</span>
                   <span class="s1">&#39;å¹´é¾„&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">]})</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&#34;åŸå¸‚&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div><pre><code>åŒ—äº¬    3
ä¸Šæµ·    2
å¹¿å·    1
æ­å·    1
å—äº¬    1
é¦™æ¸¯    1
æˆéƒ½    1
Name: åŸå¸‚, dtype: int64
</code></pre>
<p>å¯ä»¥çœ‹åˆ°åŒ—äº¬å‡ºç°äº†3æ¬¡ï¼Œä¸Šæµ·å‡ºç°äº†2æ¬¡ï¼Œå¹¶ä¸”é»˜è®¤é‡‡ç”¨çš„æ˜¯é™åºæ¥æ’åˆ—çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç”¨å‡åºçš„æ–¹å¼æ¥æ’åˆ—ä¸€ä¸‹æ”¶å…¥è¿™ä¸€åˆ—</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;æ”¶å…¥&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><pre><code>5600     1
5000     1
8000     1
5200     1
50000    1
4000     1
10000    2
5500     2
Name: æ”¶å…¥, dtype: int64
</code></pre>
<p>åŒæ—¶é‡Œé¢ä¹Ÿè¿˜å¯ä»¥åˆ©ç”¨å‚æ•°normalize=Trueï¼Œæ¥è®¡ç®—ä¸åŒå€¼çš„è®¡æ•°å æ¯”</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;å¹´é¾„&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><pre><code>32    0.1
34    0.1
50    0.1
40    0.1
43    0.1
45    0.1
25    0.4
Name: å¹´é¾„, dtype: float64
</code></pre>
<br>
<h2 id="æ•°æ®åˆ†ç»„">æ•°æ®åˆ†ç»„</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨cut()æ–¹æ³•ä»¥åŠqcut()æ–¹æ³•æ¥å¯¹è¡¨æ ¼ä¸­çš„è¿ç»­å‹æ•°æ®åˆ†ç»„ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹cut()æ–¹æ³•ï¼Œå‡è®¾ä¸‹é¢è¿™ç»„æ•°æ®ä»£è¡¨çš„æ˜¯å°ç»„æ¯ä¸ªæˆå‘˜çš„å¹´é¾„</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ages</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">32</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div><pre><code>[(1.907, 20.6], (1.907, 20.6], (1.907, 20.6], (39.2, 57.8], (20.6, 39.2], ..., (1.907, 20.6], (1.907, 20.6], (20.6, 39.2], (20.6, 39.2], (20.6, 39.2]]
Length: 16
Categories (5, interval[float64]): [(1.907, 20.6] &lt; (20.6, 39.2] &lt; (39.2, 57.8] &lt; (57.8, 76.4] &lt; (76.4, 95.0]]
</code></pre>
<p>ç”±ä¸Šå¯ä»¥çœ‹åˆ°ç”¨cut()æ–¹æ³•å°†æ•°æ®å¹³åˆ†æˆäº†5ä¸ªåŒºé—´ï¼Œä¸”åŒºé—´ä¸¤è¾¹éƒ½æœ‰æ‰©å±•ä»¥åŒ…å«<strong>æœ€å¤§å€¼å’Œæœ€å°å€¼</strong>ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™æ¯ä¸€ä¸ªåŒºé—´åŠ ä¸Šæ ‡è®°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">u</span><span class="s2">&#34;å©´å„¿&#34;</span><span class="p">,</span><span class="sa">u</span><span class="s2">&#34;å°‘å¹´&#34;</span><span class="p">,</span><span class="sa">u</span><span class="s2">&#34;é’å¹´&#34;</span><span class="p">,</span><span class="sa">u</span><span class="s2">&#34;ä¸­å¹´&#34;</span><span class="p">,</span><span class="sa">u</span><span class="s2">&#34;è€å¹´&#34;</span><span class="p">])</span>
</code></pre></div><pre><code>['å©´å„¿', 'å©´å„¿', 'å©´å„¿', 'é’å¹´', 'å°‘å¹´', ..., 'å©´å„¿', 'å©´å„¿', 'å°‘å¹´', 'å°‘å¹´', 'å°‘å¹´']
Length: 16
Categories (5, object): ['å©´å„¿' &lt; 'å°‘å¹´' &lt; 'é’å¹´' &lt; 'ä¸­å¹´' &lt; 'è€å¹´']
</code></pre>
<p>è€Œå¯¹äºqcut()æ–¹æ³•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåŒºé—´æ¥è¿›è¡Œåˆ†ç»„ï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;å°æœ‹å‹&#39;</span><span class="p">,</span><span class="s1">&#39;å¤§å­©å­&#39;</span><span class="p">])</span>
</code></pre></div><pre><code>['å°æœ‹å‹', 'å°æœ‹å‹', 'å°æœ‹å‹', 'å¤§å­©å­', 'å¤§å­©å­', ..., 'å°æœ‹å‹', 'å°æœ‹å‹', 'å°æœ‹å‹', 'å°æœ‹å‹', 'å°æœ‹å‹']
Length: 16
Categories (2, object): ['å°æœ‹å‹' &lt; 'å¤§å­©å­']
</code></pre>
<p>è¿™é‡Œå°†å¹´é¾„è¿™ç»„æ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†[0, 0.5, 1]ï¼Œä¸€ç»„æ˜¯æ ‡ä¸Šæ ‡è®°å°æœ‹å‹ï¼Œå¦ä¸€ç»„æ˜¯å¤§å­©å­ï¼Œä¸è¿‡é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨çš„cut()æ–¹æ³•æ¯”è¾ƒå¤š</p>
<p><br><br></p>
<h2 id="å¼•ç”¨å‡½æ•°">å¼•ç”¨å‡½æ•°</h2>
<p>è¦æ˜¯åœ¨è¡¨æ ¼å½“ä¸­å¼•ç”¨å…¶ä»–çš„æ–¹æ³•ï¼Œæˆ–è€…æ˜¯è‡ªå»ºçš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨é€šè¿‡pandaså½“ä¸­çš„ä»¥ä¸‹è¿™å‡ ä¸ªæ–¹æ³•</p>
<ul>
<li>pipe()</li>
<li>apply()å’Œapplymap()</li>
<li>agg()å’Œtransform()</li>
</ul>
<br>
<h2 id="pipeæ–¹æ³•">pipe()æ–¹æ³•</h2>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹pipe()è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªå·±å®šä¹‰å¥½çš„å‡½æ•°ï¼Œä»¥é“¾è·¯çš„å½¢å¼ä¸€ä¸ªæ¥ç€ä¸€ä¸ªä¼ ç»™æˆ‘ä»¬è¦å¤„ç†çš„æ•°æ®é›†ä¸Š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">extract_city_name</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&#34;state_name&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;state_and_code&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">add_country_name</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">country_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&#34;state_and_country&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;state_name&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">country_name</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div><p>ç„¶åæˆ‘ä»¬ç”¨pip()è¿™ä¸ªæ–¹æ³•æ¥å°†ä¸Šé¢æˆ‘ä»¬å®šä¹‰çš„å‡½æ•°ä¸²è”èµ·æ¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df_p</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&#34;city_and_code&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;Arizona, AZ&#34;</span><span class="p">]})</span>
<span class="n">df_p</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&#34;state_and_code&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;Arizona, AZ&#34;</span><span class="p">]})</span>
<span class="n">df_p</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">extract_city_name</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_country_name</span><span class="p">,</span> <span class="n">country_name</span><span class="o">=</span><span class="s2">&#34;_USA&#34;</span><span class="p">)</span>

</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|    | state_and_code   | state_name   | state_and_country   |
|---:|:-----------------|:-------------|:--------------------|
|  0 | Arizona, AZ      | Arizona      | Arizona_USA         |
</code></pre></div><br>
<h2 id="applyæ–¹æ³•å’Œapplymapæ–¹æ³•">apply()æ–¹æ³•å’Œapplymap()æ–¹æ³•</h2>
<p>apply()æ–¹æ³•å¯ä»¥å¯¹è¡¨æ ¼ä¸­çš„æ•°æ®æŒ‰ç…§è¡Œæˆ–è€…æ˜¯åˆ—æ–¹å‘è¿›è¡Œå¤„ç†ï¼Œé»˜è®¤æ˜¯æŒ‰ç…§åˆ—æ–¹å‘ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">A   -0.101751
B   -0.360288
C   -0.637433
dtype: float64
</code></pre></div><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡axiså‚æ•°æ¥è¿›è¡Œè°ƒèŠ‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0   -0.803675
1   -0.179640
2   -1.200973
3    0.156888
4    0.381631
5    0.049274
6    1.174923
7    0.612591
dtype: float64
</code></pre></div><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨åŒ¿åå‡½æ•°lambdaçš„å½¢å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">A    1.922863
B    2.874672
C    1.943930
dtype: float64
</code></pre></div><p>ä¹Ÿå¯ä»¥è°ƒç”¨è‡ªå·±å®šä¹‰çš„å‡½æ•°æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</code></pre></div><p>æˆ‘ä»¬ç”¨ä¸Šapply()æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">normalize</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">          A         B         C
0  1.149795  0.390263 -0.813770
1  0.805843 -0.532374  0.859627
2  0.047824 -0.085334 -0.067179
3 -0.903319 -1.215023  1.149538
4 -1.100144  1.442467 -1.128216
</code></pre></div><p>apply()æ–¹æ³•ä½œç”¨äºæ•°æ®é›†å½“ä¸­çš„æ¯ä¸ªè¡Œæˆ–è€…æ˜¯åˆ—ï¼Œè€Œapplymap()æ–¹æ³•åˆ™æ˜¯å¯¹æ•°æ®é›†å½“ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¿›è¡Œå¤„ç†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;key2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;data1&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                   <span class="s1">&#39;data2&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">)})</span>
<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  key1   key2  data1  data2
0    a    one      1     10
1    c    two      2     11
2    b  three      3     12
3    b   four      4     13
4    d   five      5     14
</code></pre></div><p>æˆ‘ä»¬æ¥è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="k">def</span> <span class="nf">add_A</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&#34;A&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">add_A</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  key1    key2 data1 data2
0   Aa    Aone    A1   A10
1   Ac    Atwo    A2   A11
2   Ab  Athree    A3   A12
3   Ab   Afour    A4   A13
4   Ad   Afive    A5   A14
</code></pre></div><p>æˆ‘ä»¬ç„¶åä¹Ÿå¯ä»¥é€šè¿‡lambda()è‡ªå®šä¹‰å‡½æ•°æ–¹æ³•ï¼Œç„¶åæ¥å»é™¤æ‰è¿™ä¸ªA</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">add_A</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  key1   key2 data1 data2
0    a    one     1    10
1    c    two     2    11
2    b  three     3    12
3    b   four     4    13
4    d   five     5    14
</code></pre></div><br>
<h2 id="aggæ–¹æ³•å’Œtransformæ–¹æ³•">agg()æ–¹æ³•å’Œtransform()æ–¹æ³•</h2>
<p>agg()æ–¹æ³•æœ¬æ„ä¸Šæ˜¯èšåˆå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”¨äºç»Ÿè®¡åˆ†æçš„ä¸€ç³»åˆ—æ–¹æ³•éƒ½æ”¾ç½®å…¶ä¸­ï¼Œå¹¶ä¸”æ”¾ç½®å¤šä¸ª</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
</code></pre></div><pre><code>A    2.042573
B    2.189269
C   -1.066976
dtype: float64
</code></pre>
<p>å½“ç„¶ï¼Œå½“ä¸­çš„np.suméƒ¨åˆ†ä¹Ÿå¯ä»¥ç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºï¼Œä¾‹å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&#34;sum&#34;</span><span class="p">)</span>
</code></pre></div><pre><code>A    2.042573
B    2.189269
C   -1.066976
dtype: float64
</code></pre>
<p>æˆ‘ä»¬å°è¯•åœ¨å½“ä¸­æ”¾ç½®å¤šä¸ªç»Ÿè®¡åˆ†æçš„å‡½æ•°æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&#34;sum&#34;</span><span class="p">,</span> <span class="s2">&#34;mean&#34;</span><span class="p">,</span> <span class="s2">&#34;median&#34;</span><span class="p">])</span>
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å’ŒlambdaåŒ¿åå‡½æ•°æ··åˆç€æ­é…</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&#34;sum&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">                 A         B         C
sum      -0.066486 -1.288341 -1.236244
&lt;lambda&gt; -0.013297 -0.257668 -0.247249
</code></pre></div><p>æˆ–è€…å’Œè‡ªå·±å®šä¹‰çš„å‡½æ•°æ–¹æ³•æ··åˆç€ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">my_mean</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
<span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&#34;sum&#34;</span><span class="p">,</span> <span class="n">my_mean</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">                A         B         C
sum     -4.850201 -1.544773  0.429007
my_mean -0.970040 -0.308955  0.085801
</code></pre></div><p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨agg()æ–¹æ³•ä¸­æ·»åŠ å­—å…¸ï¼Œå®ç°ä¸åŒçš„åˆ—ä½¿ç”¨ä¸åŒçš„å‡½æ•°æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&#34;A&#34;</span><span class="p">:</span> <span class="s2">&#34;sum&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">:</span> <span class="s2">&#34;mean&#34;</span><span class="p">})</span>

</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">A   -0.801753
B    0.097550
dtype: float64
</code></pre></div><br>
<h2 id="ç´¢å¼•å’Œåˆ—åçš„é‡å‘½å">ç´¢å¼•å’Œåˆ—åçš„é‡å‘½å</h2>
<p>é’ˆå¯¹ç´¢å¼•å’Œåˆ—åçš„é‡å‘½åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡pandaså½“ä¸­çš„rename()æ–¹æ³•æ¥å®ç°ï¼Œä¾‹å¦‚æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®é›†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">],</span>
                   <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">,</span> <span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="s2">&#34;e&#34;</span><span class="p">])</span>
<span class="n">df1</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">          A         B         C
a  0.343690  0.869984 -1.929814
b  1.025613  0.470155 -0.242463
c -0.400908 -0.362684  0.226857
d -1.339706 -0.302005 -1.784452
e -0.957026 -0.813600  0.215098
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥æ“ä½œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;A&#34;</span><span class="p">:</span> <span class="s2">&#34;one&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">:</span> <span class="s2">&#34;two&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">:</span> <span class="s2">&#34;three&#34;</span><span class="p">},</span>
           <span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;apple&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;banana&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">:</span> <span class="s2">&#34;cat&#34;</span><span class="p">})</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">             one       two     three
apple   0.383813  0.588964 -0.162386
banana -0.462068 -2.938896  0.935492
cat    -0.059807 -1.987281  0.095432
d      -0.085230  2.013733 -1.324039
e      -0.678352  0.306776  0.808697
</code></pre></div><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥æ‹†å¼€æ¥ï¼Œå•ç‹¬å¯¹è¡Œæˆ–è€…æ˜¯åˆ—è¿›è¡Œé‡å‘½åï¼Œå¯¹åˆ—çš„é‡å‘½åå¯ä»¥è¿™ä¹ˆæ¥åš</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&#34;A&#34;</span><span class="p">:</span> <span class="s2">&#34;one&#34;</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">:</span> <span class="s2">&#34;two&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">:</span> <span class="s2">&#34;three&#34;</span><span class="p">},</span> 
           <span class="n">axis</span> <span class="o">=</span> <span class="s2">&#34;columns&#34;</span><span class="p">)</span>

</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">        one       two     three
a -0.997108 -1.383011  0.474298
b  1.009910  0.286303  1.120783
c  1.130700 -0.566922  1.841451
d -0.350438 -0.171079 -0.079804
e  0.988050 -0.524604  0.653306
</code></pre></div><br>
<h2 id="æ’åº">æ’åº</h2>
<p>åœ¨pandaså½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ•°æ®é›†å½“ä¸­çš„å€¼æ¥è¿›è¡Œæ’åº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&#34;one&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
     <span class="s2">&#34;two&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> 
     <span class="s2">&#34;three&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">df1</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   one  two  three
0    2    1      5
1    1    3      4
2    1    2      3
3    1    4      2
</code></pre></div><p>æˆ‘ä»¬æŒ‰ç…§â€œthreeâ€è¿™ä¸€åˆ—å½“ä¸­çš„æ•°å€¼æ¥è¿›è¡Œæ’åº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&#34;three&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   one  two  three
3    1    4      2
2    1    2      3
1    1    3      4
0    2    1      5
</code></pre></div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¾ç…§å¤šåˆ—è¿›è¡Œæ’åº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;one&#34;</span><span class="p">,</span> <span class="s2">&#34;two&#34;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   one  two  three
2    1    2      3
1    1    3      4
3    1    4      2
0    2    1      5
</code></pre></div><p>åœ¨â€œoneâ€è¿™ä¸€åˆ—ç›¸ç­‰çš„æ—¶å€™ï¼Œæ¯”è¾ƒâ€œtwoâ€è¿™ä¸€åˆ—æ•°å€¼çš„å¤§å°ï¼Œåœ¨æ’åºçš„è¿‡ç¨‹å½“ä¸­ï¼Œé»˜è®¤é‡‡ç”¨çš„éƒ½æ˜¯å‡åºï¼Œæˆ‘ä»¬å¯ä»¥æ”¹æˆé™åºæ¥è¿›è¡Œç¼–æ’</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;two&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   one  two  three
3    1    4      2
1    1    3      4
2    1    2      3
0    2    1      5
</code></pre></div><br>
<h2 id="æ•°æ®ç±»å‹çš„è½¬æ¢">æ•°æ®ç±»å‹çš„è½¬æ¢</h2>
<p>æœ€åæ¶‰åŠåˆ°çš„æ˜¯æ•°æ®ç±»å‹çš„è½¬æ¢ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¾—çŸ¥é“å¦‚ä½•æ¥æŸ¥çœ‹æ•°æ®çš„ç±»å‹ï¼Œpandaså½“ä¸­æœ‰ç›¸åº”çš„æ–¹æ³•å¯ä»¥å¤„ç†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&#34;A&#34;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&#34;float16&#34;</span><span class="p">),</span>
        <span class="s2">&#34;B&#34;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span>
        <span class="s2">&#34;C&#34;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&#34;uint8&#34;</span><span class="p">)),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df2</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">          A         B    C
0 -0.498779 -0.501512    0
1 -0.055817 -0.528227  254
2 -0.914551  0.763298    1
3 -0.916016  1.366833    0
4  1.993164  1.834457    0
</code></pre></div><p>æˆ‘ä»¬é€šè¿‡dtypeså±æ€§æ¥æŸ¥çœ‹æ•°æ®çš„ç±»å‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">A    float16
B    float64
C      uint8
dtype: object
</code></pre></div><p>è€Œé€šè¿‡astype()æ–¹æ³•æ¥å®ç°æ•°æ®ç±»å‹çš„è½¬æ¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df2</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;int64&#34;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">0    0
1    0
2    0
3    2
4    1
Name: B, dtype: int64
</code></pre></div><br>
<h2 id="æ ¹æ®æ•°æ®ç±»å‹æ¥ç­›é€‰">æ ¹æ®æ•°æ®ç±»å‹æ¥ç­›é€‰</h2>
<p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®ç›¸å¯¹åº”çš„æ•°æ®ç±»å‹æ¥è¿›è¡Œç­›é€‰ï¼Œè¿ç”¨pandaså½“ä¸­çš„select_dtypesæ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªæ•°æ®é›†åŒ…å«äº†å„ç§æ•°æ®ç±»å‹çš„</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&#34;string_1&#34;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&#34;abcde&#34;</span><span class="p">),</span>
        <span class="s2">&#34;int64_1&#34;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
        <span class="s2">&#34;uint8_1&#34;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;u1&#34;</span><span class="p">),</span>
        <span class="s2">&#34;float64_1&#34;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">),</span>
        <span class="s2">&#34;bool1&#34;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="s2">&#34;bool2&#34;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
        <span class="s2">&#34;dates_1&#34;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&#34;now&#34;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
        <span class="s2">&#34;category_1&#34;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&#34;ABCDE&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;category&#34;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  string_1  int64_1  uint8_1  ...  bool2                      dates_1  category_1
0      a      1      3  ...  False 2021-11-10 10:43:05.957685         A
1      b      2      4  ...   True 2021-11-11 10:43:05.957685         B
2      c      3      5  ...  False 2021-11-12 10:43:05.957685         C
3      d      4      6  ...  False 2021-11-13 10:43:05.957685         D
4      e      5      7  ...   True 2021-11-14 10:43:05.957685         E
</code></pre></div><p>æˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹å„ä¸ªåˆ—çš„æ•°æ®ç±»å‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>

</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">string_1              object
int64_1                int64
uint8_1                uint8
float64_1            float64
bool1                   bool
bool2                   bool
dates_1       datetime64[ns]
category_1          category
dtype: object
</code></pre></div><p>æˆ‘ä»¬ç­›é€‰ç±»å‹ä¸ºå¸ƒå°”å€¼çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">bool</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   bool1  bool2
0   True  False
1  False   True
2   True  False
3   True  False
4  False   True
</code></pre></div><p>ç­›é€‰å‡ºæ•°æ®ç±»å‹ä¸ºæ•´å‹çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">   int64_1
0      1
1      2
2      3
3      4
4      5
</code></pre></div><br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨DataFrameä¸­ä½¿ç”¨If-Elseæ¡ä»¶è¯­å¥åˆ›å»ºæ–°åˆ—</title>
      <link>https://hidadeng.github.io/blog/how_to_use_ifelse_in_pandas/</link>
      <pubDate>Sat, 30 Oct 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/how_to_use_ifelse_in_pandas/</guid>
      <description>ä¸¤ä¸ªnumpyå‡½æ•°æå®šè¿™ä¸€éš¾é¢˜</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211031%E5%A6%82%E4%BD%95%E5%9C%A8DataFrame%E4%B8%AD%E4%BD%BF%E7%94%A8If-Else%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E5%88%9B%E5%BB%BA%E6%96%B0%E5%88%97">https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211031å¦‚ä½•åœ¨DataFrameä¸­ä½¿ç”¨If-Elseæ¡ä»¶è¯­å¥åˆ›å»ºæ–°åˆ—</a></p>
<br>
<p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›æ ¹æ® DataFrame å…¶ä»–åˆ—(å­—æ®µ) çš„å€¼å‘ DataFrame æ·»åŠ ä¸€åˆ—ã€‚</p>
<p>è™½ç„¶è¿™å¬èµ·æ¥å¾ˆç®€å•ï¼Œä½†å¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨ if-else æ¡ä»¶æ¥å®Œæˆå®ƒå¯èƒ½ä¼šå˜å¾—æœ‰ç‚¹å¤æ‚ã€‚ å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œä½¿ç”¨ numpy ä¸¤ä¸ªå‡½æ•°<strong>np.where()ã€np.select()</strong> å°±èƒ½å®ç°è¿™ä¸€éœ€æ±‚ã€‚</p>
<h2 id="å¯¼å…¥æ•°æ®">å¯¼å…¥æ•°æ®</h2>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å« 4,000 å¤šæ¡ Dataquest æ¨æ–‡çš„æ•°æ®é›†,å­—æ®µåŒ…æ‹¬ï¼š</p>
<ul>
<li>date  twitterå‘é€çš„æ—¥æœŸ</li>
<li>time  æ¨æ–‡å‘é€æ—¶é—´</li>
<li>tweet   æ¨æ–‡å†…å®¹</li>
<li>mentions    è°æåˆ°äº†è¯¥æ¨æ–‡</li>
<li>photos    å›¾ç‰‡é“¾æ¥</li>
<li>replies_count  æ¨æ–‡å›å¤æ•°</li>
<li>retweets_count  æ¨æ–‡å†è½¬å‘æ•°</li>
<li>likes_count  æ¨æ–‡è·å¾—çš„ç‚¹èµæ•°</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tweets.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df1.png" width="100%" />
    
    
</figure>

<p><br><br></p>
<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>æˆ‘ä»¬çœ‹åˆ°æ•°æ®é›†ä¸­çš„<strong>photos</strong>å­—æ®µæ˜¯å›¾ç‰‡é“¾æ¥</p>
<ul>
<li>å¦‚æœæŸæ¡è®°å½•æœ‰ä¿¡æ¯ï¼Œä¼šæ˜¾ç¤ºå›¾ç‰‡é“¾æ¥åˆ—è¡¨</li>
<li>å¦‚æœä¸å«å›¾ç‰‡ï¼Œè¯¥å­—æ®µå¯¹åº”çš„æ•°æ®æ˜¯ç©ºåˆ—è¡¨</li>
</ul>
<p>æˆ‘ä»¬åªæƒ³æŸ¥çœ‹å¸¦æœ‰å›¾ç‰‡çš„æ¨æ–‡æ˜¯å¦è·å¾—æ›´å¤šäº¤äº’ï¼Œå› æ­¤æˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦å›¾ç‰‡ URLã€‚ è®©æˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ªåä¸º <strong>has_image</strong> çš„æ–°åˆ—ï¼Œè¯¥åˆ—å°†åŒ…å«å¸ƒå°”å€¼</p>
<ul>
<li>å¦‚æœæ¨æ–‡åŒ…å«å›¾åƒï¼Œåˆ™ä¸º Trueï¼Œå¦åˆ™ä¸º Falseã€‚</li>
</ul>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åˆ›å»ºä¸€ä¸ª<strong>has_image</strong>å­—æ®µï¼Ÿ</p>
<p><br><br></p>
<h2 id="npwhere">np.where()</h2>
<p>np.where(condition, value if condition is true, value if condition is false)</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ numpy çš„å†…ç½® where() å‡½æ•°ã€‚ è¿™ä¸ªå‡½æ•°ä¾æ¬¡æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šæˆ‘ä»¬è¦æµ‹è¯•çš„æ¡ä»¶ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸåˆ™åˆ†é…ç»™æ–°åˆ—çš„å€¼ï¼Œå¦‚æœæ¡ä»¶ä¸ºå‡åˆ™åˆ†é…ç»™æ–°åˆ—çš„å€¼ã€‚ å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s1">&#39;has_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;photos&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;[]&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df2.png" width="100%" />
    
    
</figure>

<br>
<h2 id="npselect">np.select()</h2>
<p>è¿™ç§æ–¹æ³•å¾ˆå¥½ç”¨ï¼Œä½†å¦‚æœæˆ‘ä»¬æ–°å»ºåˆ—çš„å€¼ä¸æ­¢Trueã€Falseå‘¢ï¼Ÿ</p>
<p>ä¾‹å¦‚æˆ‘ä»¬æŠŠ<strong>likes_count</strong> è¿›è¡Œåˆ†ç±»ï¼Œä¸åŒå–å€¼èŒƒå›´å®šä¹‰ä¸ºä¸åŒçš„ç±»åˆ«</p>
<ul>
<li>tier_4  å°‘äº2ä¸ªèµ</li>
<li>tier_3  3-9 ä¸ªèµ</li>
<li>tier_2  10-15 ä¸ªèµ</li>
<li>tier_1  16+ ä¸ªèµ</li>
</ul>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åä¸º <strong>np.select()</strong> çš„å‡½æ•°ã€‚æˆ‘ä»¬å°†ç»™å®ƒä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæˆ‘ä»¬çš„æ¡ä»¶åˆ—è¡¨ï¼Œä»¥åŠä¸€ä¸ªæˆ‘ä»¬æƒ³è¦åˆ†é…ç»™æ–°åˆ—ä¸­æ¯ä¸€è¡Œçš„å€¼çš„ç›¸å…³åˆ—è¡¨ã€‚</p>
<p>è¿™æ„å‘³ç€é¡ºåºå¾ˆé‡è¦ï¼šå¦‚æœæ»¡è¶³æ¡ä»¶åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œåˆ™å€¼åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå€¼å°†åˆ†é…ç»™è¯¥è¡Œçš„æ–°åˆ—ã€‚å¦‚æœæ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œåˆ™å°†åˆ†é…ç¬¬äºŒä¸ªå€¼ï¼Œä¾æ­¤ç±»æ¨ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒåœ¨ Python ä»£ç ä¸­çš„è¡¨ç°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># create a list of our conditions</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">),</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">),</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likes_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span>
    <span class="p">]</span>

<span class="c1"># create a list of the values we want to assign for each condition</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tier_4&#39;</span><span class="p">,</span> <span class="s1">&#39;tier_3&#39;</span><span class="p">,</span> <span class="s1">&#39;tier_2&#39;</span><span class="p">,</span> <span class="s1">&#39;tier_1&#39;</span><span class="p">]</span>

<span class="c1"># create a new column and use np.select to assign values to it using our lists as arguments</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

<span class="c1"># display updated DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df3.png" width="100%" />
    
    
</figure>

<br>
<h2 id="æ•°æ®æŒ–æ˜è¯¾">æ•°æ®æŒ–æ˜è¯¾</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Pandaså°æ¡ˆä¾‹ | å¯¹æŸå…¬å¸åŒå¹´çš„æŸæŒ‡æ ‡æ‰¹é‡æ±‡æ€»</title>
      <link>https://hidadeng.github.io/blog/pandas_example_company_analysis/</link>
      <pubDate>Thu, 20 May 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/pandas_example_company_analysis/</guid>
      <description>å­¦ä¼špandasåŒ…ï¼Œèµ°åˆ°å“ªé‡Œéƒ½ä¸æ€•</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="%E4%BB%A3%E7%A0%81.zip">ç‚¹å‡»æ­¤å¤„ä¸‹è½½ä»£ç </a></p>
<br>
<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>å¦‚ä½•å°†æ•°æ®ä¸­ï¼ŒåŒä¸€è‚¡ç¥¨ä»£ç åŒä¸€å¹´çš„æŸä¸ªå­—æ®µåŠ æ€»æˆä¸€æ¡ï¼Ÿ</p>
<p>æˆ‘æƒ³æŠŠæŸå…¬å¸åŒä¸€å¹´çš„æ•°æ®varåŠ æ€»åˆ°ä¸€èµ·</p>
<h2 id="æ€è·¯">æ€è·¯</h2>
<p>å¯ä»¥é€šè¿‡pandasåº“å®ç°è¿™ä¸ªéœ€æ±‚</p>
<ol>
<li>è·å–å…¬å¸è‚¡ç¥¨ä»£ç åˆ—è¡¨</li>
<li>è·å–æŸå…¬å¸å¹´ä»½åˆ—è¡¨</li>
<li>å¯¹æŸä¸ªå…¬å¸åŒå¹´çš„varè¿›è¡ŒåŠ æ€»  (varä»£æŒ‡ä¸€ä¸ªå­—æ®µæˆ–å˜é‡)</li>
<li>forå¾ªç¯å¯¹æ‰€æœ‰çš„å…¬å¸é‡å¤2-3æ“ä½œ</li>
</ol>
<br>
<h2 id="å‡†å¤‡æ•°æ®">å‡†å¤‡æ•°æ®</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#å¼ºåˆ¶è‚¡ç¥¨ä»£ç è½¬ä¸ºstrç±»å‹</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data.xlsx&#39;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;code&#34;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df1.png" width="800" />
    
    
</figure>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<br>
<h2 id="å®éªŒä»£ç ">å®éªŒä»£ç </h2>
<h3 id="1-è·å–å…¬å¸è‚¡ç¥¨ä»£ç åˆ—è¡¨">1. è·å–å…¬å¸è‚¡ç¥¨ä»£ç åˆ—è¡¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">codes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">codes</span>
</code></pre></div><pre><code>array(['000001', '000002', '000004', '000005', '000006'], dtype=object)
</code></pre>
<h3 id="2-è·å–æŸå…¬å¸å¹´ä»½åˆ—è¡¨">2. è·å–æŸå…¬å¸å¹´ä»½åˆ—è¡¨</h3>
<p>ä»¥000001ä¸ºä¾‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">years</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;000001&#39;</span><span class="p">][</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">years</span>
</code></pre></div><pre><code>{2000, 2002, 2007, 2008, 2010, 2013, 2019}
</code></pre>
<h3 id="3-å¯¹æŸä¸ªå…¬å¸åŒå¹´çš„baladdedè¿›è¡ŒåŠ æ€»">3. å¯¹æŸä¸ªå…¬å¸åŒå¹´çš„baladdedè¿›è¡ŒåŠ æ€»</h3>
<p>ä»¥000001å…¬å¸2000å¹´ä¸ºä¾‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;000001&#39;</span><span class="p">]</span>
<span class="n">ndf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df2.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ndf</span><span class="p">[</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2000</span><span class="p">]</span>
</code></pre></div>
<figure >
    
        <img src="img/df3.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ndf</span><span class="p">[</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2000</span><span class="p">][</span><span class="s1">&#39;baladded&#39;</span><span class="p">]</span>
</code></pre></div><pre><code>0   -65856130.0
1   -65856130.0
Name: baladded, dtype: float64
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">ndf</span><span class="p">[</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2000</span><span class="p">][</span><span class="s1">&#39;baladded&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div><pre><code>-131712260.0
</code></pre>
<h3 id="forå¾ªç¯å¯¹æ‰€æœ‰çš„å…¬å¸é‡å¤2-3æ“ä½œ">forå¾ªç¯å¯¹æ‰€æœ‰çš„å…¬å¸é‡å¤2-3æ“ä½œ</h3>
<p>æ±‡æ€»ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">codes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes</span><span class="p">:</span>
    <span class="n">years</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">code</span><span class="p">][</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">code</span><span class="p">]</span>
        <span class="n">baladded_sum</span> <span class="o">=</span> <span class="n">ndf</span><span class="p">[</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;baladded&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">baladded_sum</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
<span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;baladded_sum&#39;</span><span class="p">])</span>
<span class="n">result_df</span>
</code></pre></div>
<figure >
    
        <img src="img/df4.png" width="800" />
    
    
</figure>

<p>ä¿å­˜ç»“æœ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">result_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;result.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div><br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
