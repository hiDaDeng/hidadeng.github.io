<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>å¯è§†åŒ– on å¤§é‚“å’Œä»–çš„PYTHON</title>
    <link>/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/</link>
    <description>Recent content in å¯è§†åŒ– on å¤§é‚“å’Œä»–çš„PYTHON</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Thu, 28 Apr 2022 10:40:10 +0600</lastBuildDate><atom:link href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>TransBigDataåº“ | å‡ºç§Ÿè½¦GPSæ•°æ®å¤„ç†</title>
      <link>https://hidadeng.github.io/blog/trans_big_data_examples_taxi_data/</link>
      <pubDate>Thu, 28 Apr 2022 10:40:10 +0600</pubDate>
      
      <guid>/blog/trans_big_data_examples_taxi_data/</guid>
      <description>åœ°ç†ä¿¡æ¯æ•°æ®å¤„ç†åŒ…TransBigData</description>
      <content:encoded><![CDATA[<h2 id="taxi-gpsæ•°æ®å¤„ç†">Taxi GPSæ•°æ®å¤„ç†</h2>
<p>Bç«™-åŒæµå°æ—­å­¦é•¿</p>
<iframe
    src="//player.bilibili.com/player.html?bvid=BV1na411i7sd&page=3"
    scrolling="no"
    height="500px"
    width="800px"
    frameborder="no"
    framespacing="0"
    allowfullscreen="true"
>
</iframe>

<br>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="taxi_code_trans_big_data.zip">download the code</a></p>
<br>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ TransBigData åŒ…æ¥é«˜æ•ˆå¤„ç† Taxi GPS æ•°æ®ã€‚é¦–å…ˆï¼Œå¯¼å…¥ TransBigData å¹¶ä½¿ç”¨ pandas è¯»å–æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">mapclassify</span><span class="o">==</span><span class="mf">2.4.3</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">transbigdata</span><span class="o">==</span><span class="mf">0.4.7</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">keplergl</span><span class="o">==</span><span class="mf">0.3.2</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">transbigdata</span> <span class="k">as</span> <span class="nn">tbd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Read data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/TaxiData-Sample.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Lng&#39;</span><span class="p">,</span> <span class="s1">&#39;Lat&#39;</span><span class="p">,</span> <span class="s1">&#39;OpenStatus&#39;</span><span class="p">,</span> <span class="s1">&#39;Speed&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df1.png" alt="png"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Read the GeoDataFrame of the study area</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;data/sz.json&#39;</span><span class="p">)</span>
<span class="n">sz</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">sz</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df2.png" alt="png"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span> 
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</code></pre></div><p><img loading="lazy" src="img/output_4_0.png" alt="png"  />
</p>
<br>
<h2 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h2>
<p>TransBigData é›†æˆäº†å‡ ç§å¸¸ç”¨çš„æ•°æ®é¢„å¤„ç†æ–¹æ³•ã€‚ ä½¿ç”¨<code>tbd.clean_outofshape</code>æ–¹æ³•ï¼Œç»™å®šç ”ç©¶åŒºåŸŸçš„æ•°æ®å’ŒGeoDataFrameï¼Œå¯ä»¥åˆ é™¤ç ”ç©¶åŒºåŸŸå¤–çš„æ•°æ®ã€‚ <code>tbd.clean_taxi_status</code> æ–¹æ³•å¯ä»¥è¿‡æ»¤æ‰ä¹˜å®¢çŠ¶æ€ï¼ˆOpenStatusï¼‰ç¬æ—¶å˜åŒ–çš„æ•°æ®ã€‚ ä½¿ç”¨é¢„å¤„ç†æ–¹å¼æ—¶ï¼Œéœ€è¦å°†å¯¹åº”çš„åˆ—åä½œä¸ºå‚æ•°ä¼ å…¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Data Preprocessing</span>
<span class="c1"># Delete the data outside of the study area</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">clean_outofshape</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Lng&#39;</span><span class="p">,</span> <span class="s1">&#39;Lat&#39;</span><span class="p">],</span> <span class="n">accuracy</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># Delete the data with instantaneous changes in passenger status</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">clean_taxi_status</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;OpenStatus&#39;</span><span class="p">])</span>
</code></pre></div><br>
<h2 id="æ•°æ®ç½‘æ ¼åŒ–">æ•°æ®ç½‘æ ¼åŒ–</h2>
<p>æ•°æ®åˆ†å¸ƒæœ€åŸºæœ¬çš„è¡¨è¾¾æ–¹å¼æ˜¯åœ°ç†ç½‘æ ¼çš„å½¢å¼ï¼›</p>
<p>æ•°æ®ç½‘æ ¼åŒ–åï¼Œæ¯ä¸ª GPS æ•°æ®ç‚¹æ˜ å°„åˆ°ç›¸åº”çš„ç½‘æ ¼ã€‚ å¯¹äºæ•°æ®ç½‘æ ¼åŒ–ï¼Œé¦–å…ˆéœ€è¦ç¡®å®šç½‘æ ¼åŒ–å‚æ•°ï¼ˆå¯ä»¥ç†è§£ä¸ºå®šä¹‰ä¸€ä¸ªç½‘æ ¼åæ ‡ç³»ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># æ•°æ®ç½‘æ ¼åŒ–</span>
<span class="c1"># å®šä¹‰è¾¹ç•Œå¹¶ç”Ÿæˆç½‘æ ¼å‚æ•°ï¼ˆç»çº¬åº¦ï¼‰</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">113.6</span><span class="p">,</span> <span class="mf">22.4</span><span class="p">,</span> <span class="mf">114.8</span><span class="p">,</span> <span class="mf">22.9</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">area_to_params</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">accuracy</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div><pre><code>{'slon': 113.6, 'slat': 22.4, 'deltalon': 0.004872390756896538, 'deltalat': 0.004496605206422906, 'theta': 0, 'method': 'rect', 'gridsize': 500}
</code></pre>
<p>è·å¾—ç½‘æ ¼åŒ–å‚æ•°åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å°† GPS æ˜ å°„åˆ°å…¶å¯¹åº”çš„ç½‘æ ¼ä¸Šã€‚</p>
<p>ä½¿ç”¨ <code>tbd.GPS_to_grids</code>ï¼Œå®ƒå°†ç”Ÿæˆ <code>LONCOL</code> åˆ—å’Œ <code>LATCOL</code> åˆ—ã€‚ ä¸¤åˆ—ä¸€èµ·å¯ä»¥æŒ‡å®šä¸€ä¸ªç½‘æ ¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Mapping GPS data to grids</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;LONCOL&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;LATCOL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">GPS_to_grid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Lng&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Lat&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df3.png" alt="png"  />
</p>
<p>è®¡ç®—æ¯ä¸ªç½‘æ ¼ä¸­çš„æ•°æ®é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Aggregate data into grids</span>
<span class="n">datatest</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;LONCOL&#39;</span><span class="p">,</span> <span class="s1">&#39;LATCOL&#39;</span><span class="p">])[</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">datatest</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df4.png" alt="png"  />
</p>
<p>å°†ç”Ÿæˆç½‘æ ¼çš„geometryå¹¶å°†å…¶è½¬æ¢ä¸º GeoDataFrame</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Generate the geometry for grids</span>
<span class="n">datatest</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">grid_to_polygon</span><span class="p">([</span><span class="n">datatest</span><span class="p">[</span><span class="s1">&#39;LONCOL&#39;</span><span class="p">],</span> <span class="n">datatest</span><span class="p">[</span><span class="s1">&#39;LATCOL&#39;</span><span class="p">]],</span> <span class="n">params</span><span class="p">)</span>

<span class="c1"># Change it into GeoDataFrame</span>
<span class="c1"># import geopandas as gpd</span>
<span class="n">datatest</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">datatest</span><span class="p">)</span>
<span class="n">datatest</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df5.png" alt="png"  />
</p>
<p>ç»˜åˆ¶ç”Ÿæˆçš„ç½‘æ ¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plot the grids</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># tbd.plot_map(plt, bounds, zoom=10, style=4)</span>
<span class="n">datatest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Counting of Taxi GPS Trajectory Points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_16_0.png" alt="png"  />

â€‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plot the grids</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># ç¡®å®šå›¾å½¢é«˜ä¸º6ï¼Œå®½ä¸º8ï¼›å›¾å½¢æ¸…æ™°åº¦</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">datatest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;quantiles&#39;</span><span class="p">)</span>
<span class="c1"># plt.legend(fontsize=10)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Counting of Taxi GPS Trajectory Points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_17_0.png" alt="png"  />

â€‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plot the grids</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span> <span class="c1"># ç¡®å®šå›¾å½¢é«˜ä¸º6ï¼Œå®½ä¸º8ï¼›å›¾å½¢æ¸…æ™°åº¦</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">datatest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;OrRd&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;quantiles&#39;</span><span class="p">)</span>
<span class="c1"># plt.legend(fontsize=10)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Counting of Taxi GPS Trajectory Points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_18_0.png" alt="png"  />

â€‹</p>
<br>
<h2 id="origin-destinationod-æå–å’Œæ±‡æ€»å‡ºç§Ÿè½¦è¡Œç¨‹">Origin-destination(OD) æå–å’Œæ±‡æ€»å‡ºç§Ÿè½¦è¡Œç¨‹</h2>
<p>ä½¿ç”¨ <code>tbd.taxigps_to_od</code> æ–¹æ³•å¹¶ä¼ å…¥å¯¹åº”çš„åˆ—åæ¥æå–å‡ºç§Ÿè½¦è¡Œç¨‹ ODï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Extract taxi OD from GPS data</span>
<span class="n">oddata</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">taxigps_to_od</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Lng&#39;</span><span class="p">,</span> <span class="s1">&#39;Lat&#39;</span><span class="p">,</span> <span class="s1">&#39;OpenStatus&#39;</span><span class="p">])</span>
<span class="n">oddata</span>
</code></pre></div><p><img loading="lazy" src="img/df6.png" alt="png"  />
</p>
<p>èšåˆæå–çš„ OD å¹¶ç”Ÿæˆ LineString GeoDataFrame</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Gridding and aggragate data</span>
<span class="n">od_gdf</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">odagg_grid</span><span class="p">(</span><span class="n">oddata</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">od_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df7.png" alt="png"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plot the grids</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span> <span class="c1"># ç¡®å®šå›¾å½¢é«˜ä¸º6ï¼Œå®½ä¸º8ï¼›å›¾å½¢æ¸…æ™°åº¦</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># data_grid_count.plot(ax=ax1, column=&#39;VehicleNum&#39;, legend=True, cmap=&#39;OrRd&#39;, scheme=&#39;quantiles&#39;)</span>

<span class="n">od_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;quantiles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OD Trips&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_23_0.png" alt="png"  />

â€‹</p>
<br>
<h2 id="å°†-od-èšåˆæˆå¤šè¾¹å½¢">å°† OD èšåˆæˆå¤šè¾¹å½¢</h2>
<p><code>TransBigData</code> è¿˜æä¾›äº†å°† OD èšåˆæˆå¤šè¾¹å½¢çš„æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Aggragate OD data to polygons </span>
<span class="c1"># without passing gridding parameters, the algorithm will map the data </span>
<span class="c1"># to polygons directly using their coordinates</span>
<span class="n">od_gdf</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">odagg_shape</span><span class="p">(</span><span class="n">oddata</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">round_accuracy</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span> <span class="c1"># ç¡®å®šå›¾å½¢é«˜ä¸º6ï¼Œå®½ä¸º8ï¼›å›¾å½¢æ¸…æ™°åº¦</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">od_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OD Trips&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div><p><img loading="lazy" src="img/output_25_0.png" alt="png"  />
</p>
<br>
<h2 id="åŸºäº-matplotlib-çš„åœ°å›¾ç»˜åˆ¶">åŸºäº Matplotlib çš„åœ°å›¾ç»˜åˆ¶</h2>
<p><code>TransBigData</code> è¿˜åœ¨ matplotlib ä¸­æä¾›åº•å›¾åŠ è½½ã€‚ åœ¨ä½¿ç”¨æ­¤æ–¹æ³•ä¹‹å‰ï¼Œæ‚¨éœ€è¦è®¾ç½®æ‚¨çš„ mapboxtoken å’Œåº•å›¾çš„å­˜å‚¨ä½ç½®ï¼Œè¯·å‚è§ï¼š<a href="https://transbigdata.readthedocs.io/en/latest/plot_map.html">æ­¤é“¾æ¥</a>ã€‚<code>tbd.plot_map</code> æ·»åŠ åº•å›¾å’Œ tbd.plotscale ä»¥æ·»åŠ æ¯”ä¾‹å’ŒæŒ‡å—é’ˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Load basemap</span>
<span class="n">tbd</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Define an ax for colorbar</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OD</span><span class="se">\n</span><span class="s1">Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Plot the OD</span>
<span class="n">od_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot the polygons</span>
<span class="n">sz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Add compass and scale</span>
<span class="n">tbd</span><span class="o">.</span><span class="n">plotscale</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">textsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">compasssize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">accuracy</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_27_0.png" alt="png"  />

â€‹</p>
<br>
## æå–å‡ºç§Ÿè½¦è½¨è¿¹
ä½¿ç”¨`the.taxigps_traj_point`æ–¹æ³•ï¼Œè¾“å…¥GPSæ•°æ®å’ŒODæ•°æ®ï¼Œå¯ä»¥æå–è½¨è¿¹ç‚¹
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data_deliver</span><span class="p">,</span> <span class="n">data_idle</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">taxigps_traj_point</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">oddata</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VehicleNum&#39;</span><span class="p">,</span> 
                                                                  <span class="s1">&#39;Time&#39;</span><span class="p">,</span> 
                                                                  <span class="s1">&#39;Lng&#39;</span><span class="p">,</span> 
                                                                  <span class="s1">&#39;Lat&#39;</span><span class="p">,</span> 
                                                                  <span class="s1">&#39;OpenStatus&#39;</span><span class="p">])</span>
<span class="n">data_deliver</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df8.png" alt="png"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data_idle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p><img loading="lazy" src="img/df9.png" alt="png"  />
</p>
<p>ç”Ÿæˆè½¨è¿¹å›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">traj_deliver</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">points_to_traj</span><span class="p">(</span><span class="n">data_deliver</span><span class="p">)</span>
<span class="n">traj_deliver</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_33_0.png" alt="png"  />

â€‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">traj_idle</span> <span class="o">=</span> <span class="n">tbd</span><span class="o">.</span><span class="n">points_to_traj</span><span class="p">(</span><span class="n">data_idle</span><span class="p">[</span><span class="n">data_idle</span><span class="p">[</span><span class="s1">&#39;OpenStatus&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">traj_idle</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div><p>â€‹ <br>
<img loading="lazy" src="img/output_34_1.png" alt="png"  />

â€‹</p>
<br>
<h2 id="è½¨è¿¹å¯è§†åŒ–trajectories-visualization">è½¨è¿¹å¯è§†åŒ–Trajectories visualization</h2>
<p><code>TransBigData</code> çš„å†…ç½®å¯è§†åŒ–åŠŸèƒ½åˆ©ç”¨äº†å¯è§†åŒ–åŒ… <code>keplergl</code> ï¼Œä½¿ç”¨ç®€å•ä»£ç å³å¯åœ¨ Jupyter notebook ä¸Šäº¤äº’å¼åœ°æ˜¾ç¤ºè½¨è¿¹æ•°æ®ã€‚</p>
<p>è¦ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œè¯·ä¸º python å®‰è£… <code>keplergl</code> åŒ…ï¼š</p>
<blockquote>
<p>pip3 install keplergl</p>
</blockquote>
<p>å®‰è£…åï¼Œéœ€è¦æŒ‰ç…§ <a href="https://transbigdata.readthedocs.io/en/latest/visualization.html">link</a> é…ç½®jupyter notebook</p>
<p>Visualization of trajectory data:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">tbd</span><span class="o">.</span><span class="n">visualization_trip</span><span class="p">(</span><span class="n">data_deliver</span><span class="p">)</span>
</code></pre></div><pre><code>Processing trajectory data...
Generate visualization...
User Guide: https://docs.kepler.gl/docs/keplergl-jupyter
</code></pre>
<p><img loading="lazy" src="img/trajec.png" alt=""  />
</p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>PyPlutchikåº“ | å¯è§†åŒ–æ–‡æœ¬çš„æƒ…ç»ªè½®(æƒ…ç»ªæŒ‡çº¹)</title>
      <link>https://hidadeng.github.io/blog/pyplutchik_emotion_circle/</link>
      <pubDate>Sun, 03 Apr 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/pyplutchik_emotion_circle/</guid>
      <description>è¶Šæ¥è¶Šå¤šçš„ç¤¾äº¤ç½‘ç»œå­¦è€…ï¼Œ ä¸ºæµ‹é‡æƒ…ç»ªï¼Œ åŸºäº**å¿ƒç†å­¦å®¶ Robert Plutchik** æå‡ºçš„æ¨¡å‹ï¼ˆé€šå¸¸ç®€ç§°ä¸ºâ€œ**Plutchikè½®**â€ï¼Œäººç±»çš„æƒ…ç»ªä¸€å…±æœ‰8å¤§ç±»ï¼‰åˆ¶ä½œäº†å¤§é‡çš„æƒ…ç»ªå¯è§†åŒ–ä½œå“ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒPlutchikè½®å¯ä»¥çœ‹åšæƒ…ç»ªæŒ‡çº¹ï¼Œä¾‹å¦‚ä¸åŒçš„ç”µå½±é¢˜æåœ¨8ç±»æƒ…ç»ªçš„åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„ã€‚</description>
      <content:encoded><![CDATA[<p>è¶Šæ¥è¶Šå¤šçš„ç¤¾äº¤ç½‘ç»œå­¦è€…ï¼Œ ä¸ºæµ‹é‡æƒ…ç»ªï¼Œ åŸºäº<strong>å¿ƒç†å­¦å®¶ Robert Plutchik</strong> æå‡ºçš„æ¨¡å‹ï¼ˆé€šå¸¸ç®€ç§°ä¸ºâ€œ<strong>Plutchikè½®</strong>â€ï¼Œäººç±»çš„æƒ…ç»ªä¸€å…±æœ‰8å¤§ç±»ï¼‰åˆ¶ä½œäº†å¤§é‡çš„æƒ…ç»ªå¯è§†åŒ–ä½œå“ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒPlutchikè½®å¯ä»¥çœ‹åšæƒ…ç»ªæŒ‡çº¹ï¼Œä¾‹å¦‚ä¸åŒçš„ç”µå½±é¢˜æåœ¨8ç±»æƒ…ç»ªçš„åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/imdb_full.png" width="100%" />
    
    
</figure>
</div>
<p>ä»Šå¤©ä»‹ç» <strong>PyPlutchik</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ª Python åº“ï¼Œä¸“é—¨ç”¨äºåœ¨æ–‡æœ¬æˆ–è¯­æ–™åº“ä¸­å¯è§†åŒ– Plutchik çš„æƒ…ç»ªã€‚ PyPlutchik ç»˜åˆ¶ Plutchik çš„èŠ±æœµï¼Œæ¯ä¸ªæƒ…æ„ŸèŠ±ç“£çš„å¤§å°å–å†³äºè¯­æ–™åº“ä¸­æ£€æµ‹åˆ°æˆ–æ³¨é‡Šäº†å¤šå°‘æƒ…æ„Ÿï¼Œä¹Ÿä»£è¡¨æ¯ä¸ªæƒ…æ„ŸèŠ±ç“£çš„ä¸‰ä¸ªå¼ºåº¦ç¨‹åº¦ã€‚</p>
<br>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pip3 install pyplutchik
</code></pre></div><br>
<h2 id="usage">Usage</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyplutchik</span> <span class="kn">import</span> <span class="n">plutchik</span>

<span class="n">emotions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;joy&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="s1">&#39;trust&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
            <span class="s1">&#39;fear&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;surprise&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="s1">&#39;sadness&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;disgust&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s1">&#39;anger&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
            <span class="s1">&#39;anticipation&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
            
<span class="n">plutchik</span><span class="p">(</span><span class="n">emotions</span><span class="p">)</span>
</code></pre></div><br>
<h2 id="åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§</h2>
<p>PyPlutchik æä¾›äº†ä¸€ä¸ªå³æ’å³ç”¨çš„å·¥å…·ï¼Œç”¨äºåœ¨æ–‡æœ¬æˆ–è¯­æ–™åº“ä¸­å®šé‡è¡¨ç¤º Plutchik çš„æƒ…ç»ªã€‚ å®ƒå°Šé‡ Plutchik è½®ä¸­æ¯ä¸ªèŠ±ç“£çš„åŸå§‹é¢œè‰²å’Œç©ºé—´ä½ç§»ã€‚</p>
<p>åœ¨ Pyplutchik ä¸­ï¼Œç”¨æˆ·å¯ä»¥åªä¼ é€’ä¸€ä¸ªå­—å…¸ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œå…¶ä¸­å­—å…¸çš„é”®å¿…é¡»æ˜¯ 8 ç§åŸºæœ¬æƒ…ç»ªã€‚ æ¯ä¸ªå€¼å¿…é¡»æ˜¯ âˆˆ [0, 1]ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/example01.png" width="100%" />
    
    
</figure>
</div>
<br>
<p>æ¯ç±»æƒ…ç»ªå­˜åœ¨ä¸‰ç§å¼ºåº¦ï¼Œä¸‹è¡¨æ˜¯Pyplutchikçš„8å¤§ç±»æƒ…ç»ªä¸‰ç§å¼ºåº¦æ±‡æ€»ã€‚</p>
<p>ç”¨æˆ·è¿˜å¯ä»¥ç»™æ¯ä¸ªæƒ…ç»ªä¼ å…¥ä¸€ä¸ªé•¿åº¦æ˜¯3çš„åˆ—è¡¨ï¼Œä¾æ¬¡è¡¨ç¤ºæƒ…ç»ªåœ¨ä½ã€ä¸­ã€é«˜ä¸‰ç§å¼ºåº¦çš„ç¨‹åº¦ï¼Œæ•°å€¼0 å’Œ 1 ä¹‹é—´ã€‚</p>
<table>
<thead>
<tr>
<th>Lower intensity</th>
<th>Emotion</th>
<th>Higher intensity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Annoyance</td>
<td>Anger</td>
<td>Rage</td>
</tr>
<tr>
<td>Interest</td>
<td>Anticipation</td>
<td>Vigilance</td>
</tr>
<tr>
<td>Serenity</td>
<td>Joy</td>
<td>Ecstasy</td>
</tr>
<tr>
<td>Acceptance</td>
<td>Trust</td>
<td>Admiration</td>
</tr>
<tr>
<td>Apprehension</td>
<td>Fear</td>
<td>Terror</td>
</tr>
<tr>
<td>Distraction</td>
<td>Surprise</td>
<td>Amazement</td>
</tr>
<tr>
<td>Pensiveness</td>
<td>Sadness</td>
<td>Grief</td>
</tr>
<tr>
<td>Boredom</td>
<td>Disgust</td>
<td>Loathing</td>
</tr>
</tbody>
</table>
<div style="text-align: center;">
<figure >
    
        <img src="img/example02.png" width="100%" />
    
    
</figure>
</div>
<br>
<p>PyPlutchik ä¹Ÿå¯è¡¨å¾ç”¨æˆ·æ•°æ®ä¸­çš„ä¸»è¦äºŒå…ƒã€æ¬¡è¦äºŒå…ƒã€äºŒå…ƒå’Œç›¸åçš„æƒ…ç»ªã€‚ å®ƒä¼šè‡ªåŠ¨ä»å­—å…¸çš„å…³é”®å­—ä¸­äº†è§£ç”¨æˆ·æƒ³è¦æ˜¾ç¤ºä»€ä¹ˆæ ·çš„äºŒå…ƒç»„ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/example03.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="ç»˜å›¾æŠ€å·§">ç»˜å›¾æŠ€å·§</h2>
<p>å¯ä»¥ä¸“æ³¨äºæƒ…ç»ªå­é›†ï¼Œä¸ä¼šå¿½è§†å…¶ä»–æƒ…ç»ªï¼Œå°†æƒ…ç»ªåˆ—è¡¨ä½œä¸ºå‚æ•°â€œ<strong>highlight_emotions</strong>â€çš„å€¼ä¼ é€’ï¼š</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/highlight_emotions.png" width="100%" />
    
    <figcaption><small><i>å¼ºè°ƒæŸäº›æƒ…ç»ª</i></small></figcaption>
</figure>
</div>
<p>æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒåŒä¸€äºšé©¬é€Šè¯­æ–™åº“çš„ä¸åŒå­ç»„ï¼Œå°†æˆ‘ä»¬çš„å¯è§†åŒ–å¹¶æ’æ”¾ç½®ï¼Œå¹¶ä»…çªå‡ºæ˜¾ç¤ºæ„¤æ€’ã€åŒæ¶å’Œææƒ§çš„èŠ±ç“£ï¼Œä»¥è½»æ¾å‘ç°è¿™äº›è´Ÿé¢æƒ…ç»ªåœ¨ 5 æ˜Ÿè¯„è®ºä¸­çš„è¡¨ç°å¦‚ä½•ä½äº 1 æ˜Ÿè¯„è®º .</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/amazon.png" width="100%" />
    
    <figcaption><small><i>å¼ºè°ƒæŸäº›æƒ…ç»ª</i></small></figcaption>
</figure>
</div>
<br>
<p>æˆ–è€…å¯ä»¥éšè—åæ ‡ã€åˆ»åº¦å’Œæ ‡ç­¾ï¼Œåªç»˜åˆ¶èŠ±ç“£ï¼Œä½¿ç”¨å‚æ•° <code>show_coordinates = False</code> å’Œ <code>show_ticklabels = False</code>ã€‚ä¸‹å›¾æ˜¯imdbä¸åŒç”µå½±çš„æƒ…ç»ªè½®</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/imdb_full.png" width="100%" />
    
    <figcaption><small><i>å¼ºè°ƒæŸäº›æƒ…ç»ª</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="æŸ¥çœ‹æ–‡æ¡£">æŸ¥çœ‹æ–‡æ¡£</h2>
<p>æœ‰å…³æ‰€æœ‰å‚æ•°çš„æ–‡æ¡£å’Œç¤ºä¾‹åº“ï¼Œè¯·å‚è§<a href="Documentation.html">æ–‡æ¡£</a></p>
<p><a href="PyPlutchik.zip"><strong>æ–‡æ¡£ä¸‹è½½</strong></a></p>
<p>ğŸ”¥ PyPlutchik 2.0 å³å°†æ¨å‡ºï¼ æ–°åŠŸèƒ½åŒ…æ‹¬ä»æ–‡æœ¬ä¸­æå–æƒ…æ„Ÿå¹¶æ£€æŸ¥éä¸»é¢˜è¯å…¸ã€‚ æ•¬è¯·æœŸå¾…â€¦â€¦ğŸ”¥</p>
<br>
<h2 id="è¯´æ˜">è¯´æ˜</h2>
<p>å¦‚æœä½¿ç”¨PyPlutchikï¼Œè¯·åœ¨æ–‡çŒ®ä¸­è¯´æ˜ï¼Œæ ¼å¼å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Semeraro A, Vilella S, Ruffo G (2021) PyPlutchik: Visualising and comparing emotion-annotated corpora PLOS ONE 16(9):e0256503.https://doi.org/10.1371/journal.pone.0256503
</code></pre></div><br>
<h2 id="semeraroçš„ç ”ç©¶">Semeraroçš„ç ”ç©¶</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Semeraro, Alfonso, Salvatore Vilella, Giancarlo Ruffo, and Massimo Stella. &#34;Writing about COVID-19 vaccines: Emotional profiling unravels how mainstream and alternative press framed AstraZeneca, Pfizer and vaccination campaigns.&#34; *arXiv preprint arXiv:2201.07538* (2022).
</code></pre></div><ul>
<li><strong>æ‘˜è¦</strong>: è‡ª 2020 å¹´ 11 æœˆå®£å¸ƒ COVID-19 ç–«è‹—ä»¥æ¥ï¼Œåª’ä½“å’Œç¤¾äº¤åª’ä½“å¯¹ COVID-19 ç–«è‹—è¿›è¡Œäº†å¤§é‡è¾©è®ºã€‚ç”±äºå¤§å¤šæ•°ç ”ç©¶éƒ½é›†ä¸­åœ¨ç¤¾äº¤åª’ä½“ä¸­çš„ COVID-19 è™šå‡ä¿¡æ¯ä¸Šï¼Œä¸å…¶ä»–æ¥æºç›¸æ¯”ï¼Œä¸»æµæ–°é—»åª’ä½“å¦‚ä½•æ„å»º COVID-19 å™è¿°å¾ˆå°‘å—åˆ°å…³æ³¨ã€‚ä¸ºäº†å¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œæˆ‘ä»¬ä½¿ç”¨è®¤çŸ¥ç½‘ç»œç§‘å­¦å’Œè‡ªç„¶è¯­è¨€å¤„ç†æ¥é‡å»º 5745 æ¡å…³äº COVID-19 ç–«è‹—çš„æ–°é—»çš„éšæ—¶é—´å˜åŒ–çš„è¯­ä¹‰å’Œæƒ…æ„Ÿæ¡†æ¶ã€‚æˆ‘ä»¬çš„æ•°æ®é›†æ¶µç›–äº† 8 ä¸ªæœˆå†…çš„ 17 ä¸ªç½‘ç‚¹ï¼Œå…¶ä¸­åŒ…æ‹¬åœ¨ Facebookï¼ˆ500 ä¸‡æ€»è‚¡æ•°ï¼‰å’Œ Twitterï¼ˆ20 ä¸‡è‚¡æ€»è‚¡æ•°ï¼‰ä¸Šå¤§é‡è½¬å‘çš„æ„å¤§åˆ©æ–°é—»æ–‡ç« ã€‚æˆ‘ä»¬å‘ç°ä¸»æµæ¶ˆæ¯æ¥æºæ„å»ºâ€œç–«è‹—/ç–«è‹—â€çš„æ€»ä½“æ¦‚å¿µçš„æ–¹å¼å§‹ç»ˆå…·æœ‰é«˜åº¦çš„ä¿¡ä»»/é¢„æœŸå’Œè¾ƒå°‘çš„åŒæ¶ã€‚åœ¨æ›¿ä»£æ¥æºæ„å»º COVID-19 ç–«è‹—çš„æ–¹å¼ä¸­ï¼Œè¿™äº›æƒ…ç»ªä¸¥é‡ç¼ºå¤±ã€‚åœ¨ç–«è‹—çš„ç‰¹å®šå®ä¾‹ä¸­å‘ç°äº†æ›´å¤šå·®å¼‚ã€‚å¦ç±»æ–°é—»åŒ…æ‹¬ä»¥å¼ºçƒˆçš„æ‚²ä¼¤æ¥æè¿°é˜¿æ–¯åˆ©åº·ç–«è‹—çš„æ ‡é¢˜ï¼Œè€Œä¸»æµæ ‡é¢˜ä¸­æ²¡æœ‰ã€‚ä¸â€œé˜¿æ–¯åˆ©åº·â€ç›¸æ¯”ï¼Œä¸»æµæ–°é—»æœ€åˆå°†â€œè¾‰ç‘â€ä¸å‰¯ä½œç”¨ï¼ˆä¾‹å¦‚â€œè¿‡æ•â€ã€â€œååº”â€ã€â€œå‘çƒ§â€ï¼‰ç›¸å…³è”æ›´å¤šã€‚éšç€åä¸€ç§ç–«è‹—çš„æš‚åœï¼Œåœ¨ 2021 å¹´ 3 æœˆ 15 æ—¥ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§è¯­ä¹‰/æƒ…æ„Ÿè½¬å˜ï¼šå³ä½¿æ˜¯ä¸»æµæ–‡ç« æ ‡é¢˜éƒ½å°†â€œé˜¿æ–¯åˆ©åº·â€æ¡†å®šä¸ºåœ¨è¯­ä¹‰ä¸Šæ›´ä¸°å¯Œä¸å‰¯ä½œç”¨çš„è´Ÿé¢å…³è”ï¼Œè€Œâ€œè¾‰ç‘â€åˆ™ç»å†äº†ç§¯æçš„æ•ˆä»·è½¬å˜ï¼Œä¸»è¦ä¸å…¶æ›´é«˜çš„æ•ˆç‡æœ‰å…³ã€‚è¡€æ “å½¢æˆä¸å¯æ€•çš„æ¦‚å¿µè”æƒ³ä¸€èµ·è¿›å…¥äº†ç–«è‹—çš„æ¡†æ¶ï¼Œè€Œæ­»äº¡è¿™ä¸ªè¯ç»å†äº†æƒ…æ„Ÿè½¬å˜ï¼Œåœ¨æ›¿ä»£æ ‡é¢˜ä¸­è½¬å‘ææƒ§ï¼Œåœ¨ä¸»æµæ ‡é¢˜ä¸­å¤±å»äº†å¸Œæœ›çš„å†…æ¶µï¼Œç¼ºä¹é¢„æœŸã€‚æˆ‘ä»¬çš„å‘ç°æ­ç¤ºäº†åª’ä½“é‡‡ç”¨çš„å›´ç»• COVID-19 ç–«è‹—çš„æƒ…æ„Ÿå™è¿°çš„å…³é”®æ–¹é¢ï¼Œå¼ºè°ƒäº†äº†è§£æ›¿ä»£åª’ä½“å’Œä¸»æµåª’ä½“å¦‚ä½•æŠ¥é“ç–«è‹—æ¥ç§æ–°é—»çš„å¿…è¦æ€§ã€‚</li>
<li><strong>Keywords</strong>: natural language processing, text analysis, complex networks, cognitive network science, COVID-19, COVID-19 vaccines
<div style="text-align: center;">
<figure >
    
        <img src="img/figure2.png" width="100%" />
    
    
</figure>
</div>
<div style="text-align: center;">
<figure >
    
        <img src="img/figure3.png" width="100%" />
    
    
</figure>
</div>
<div style="text-align: center;">
<figure >
    
        <img src="img/figure4.png" width="100%" />
    
    
</figure>
</div></li>
</ul>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>BloxsåŒ… | å¯åœ¨notebookä¸­ä½¿ç”¨çš„äº¤äº’å¯è§†åŒ–åŒ…</title>
      <link>https://hidadeng.github.io/blog/bloxs_interactive_visualization/</link>
      <pubDate>Fri, 01 Apr 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/bloxs_interactive_visualization/</guid>
      <description>Bloxsæ˜¯ä¸€ä¸ªç®€å•çš„ python å¯äº¤äº’çš„å¯è§†åŒ–åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä»¥ä¸€ç§æœ‰å¸å¼•åŠ›çš„æ–¹å¼ï¼ˆä»¥å—å½¢å¼ï¼‰æ˜¾ç¤ºä¿¡æ¯ã€‚ éå¸¸é€‚åˆåœ¨ç¬”è®°æœ¬ä¸­æ„å»ºä»ªè¡¨æ¿ã€æŠ¥å‘Šå’Œåº”ç”¨ç¨‹åºã€‚</description>
      <content:encoded><![CDATA[<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<br>
<p>Bloxsæ˜¯ä¸€ä¸ªç®€å•çš„ python å¯äº¤äº’çš„å¯è§†åŒ–åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä»¥ä¸€ç§æœ‰å¸å¼•åŠ›çš„æ–¹å¼ï¼ˆä»¥å—å½¢å¼ï¼‰æ˜¾ç¤ºä¿¡æ¯ã€‚ éå¸¸é€‚åˆåœ¨ç¬”è®°æœ¬ä¸­æ„å»ºä»ªè¡¨æ¿ã€æŠ¥å‘Šå’Œåº”ç”¨ç¨‹åºã€‚</p>
<p>å®ƒé€‚ç”¨äºï¼šJupyter Notebookã€Google Colabã€Deepnoteã€Kaggle Notebookã€<a href="https://github.com/mljar/mercury">Mercury</a>ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_demo.gif" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pip3 install bloxs
</code></pre></div><br>
<h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">from bloxs import B
B(1234, &#34;Bloxs in notebook!&#34;)
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/test_bloxs.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="æ¡ˆä¾‹">æ¡ˆä¾‹</h2>
<table>
<thead>
<tr>
<th>Bloxs</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td><img loading="lazy" src="img/number.png" alt=""  />
</td>
<td><code>B(1234, &quot;Bloxs in notebook!&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/percent.png" alt=""  />
</td>
<td><code>B(1999, &quot;Percent change!&quot;, percent_change=10)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/emojis.png" alt=""  />
</td>
<td><code>B(&quot;ğŸ‰ğŸ‰ğŸ‰&quot;, &quot;Works with emojis&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/progress.png" alt=""  />
</td>
<td><code>B(&quot;68%&quot;, &quot;Loading progress&quot;, progress=68)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/progress_color.png" alt=""  />
</td>
<td><code>B(&quot;68%&quot;, &quot;Loading progress&quot;, progress=68, color=&quot;green&quot;)</code> é¢œè‰²colorå‚æ•°å¯ä»¥è®¾ä¸º&quot;blue&quot;, &ldquo;red&rdquo;, &ldquo;green&rdquo; æˆ–åå…­è¿›åˆ¶è¡¨ç¤º (ä¾‹å¦‚&quot;#fa33fa&quot;)</td>
</tr>
<tr>
<td><img loading="lazy" src="img/line_chart.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display line chart&quot;, points=[1,4,2,3,5,6])</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/line_chart_color.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display line chart&quot;, points=[1,4,2,3,5,6], color=&quot;red&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/stepped.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display stepped chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;stepped&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/bar_chart.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display bar chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;bar&quot;)</code></td>
</tr>
<tr>
<td><img loading="lazy" src="img/bar_chart_color.png" alt=""  />
</td>
<td><code>B(&quot;123&quot;, &quot;Display bar chart&quot;, points=[1,4,2,3,5,6], chart_type=&quot;bar&quot;, color=&quot;green&quot;)</code></td>
</tr>
</tbody>
</table>
<br>
<p>å¯ä»¥åœ¨ä¸€è¡Œå†…æ•´åˆå¤šä¸ªå›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">B([
    B(1999, &#34;Percent change!&#34;, percent_change=10),
    B(&#34;ğŸ‰ğŸ‰ğŸ‰&#34;, &#34;Works with emojis&#34;),
    B(&#34;68%&#34;, &#34;Loading progress&#34;, progress=68),
    B(1234, &#34;Bloxs in notebook!&#34;)
])
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/several_bloxs_2.png" width="100%" />
    
    
</figure>
</div>
<br>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">B([
    B(&#34;786&#34;, &#34;Display bar chart&#34;, points=[1,4,2,3,5,6], chart_type=&#34;bar&#34;, color=&#34;green&#34;),
    B(&#34;123&#34;, &#34;Display line chart&#34;, points=[1,4,2,3,5,6], color=&#34;red&#34;),
    B(&#34;123&#34;, &#34;Display stepped chart&#34;, points=[1,4,2,3,5,6], chart_type=&#34;stepped&#34;)
])
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/several_bloxs.png" width="100%" />
    
    
</figure>
</div>
<br>
<p>å¦‚æœæƒ³åœ¨è‡ªå·±ç”µè„‘ä¸­å®éªŒä¸Šè¿°ä»£ç ï¼Œå¯ä»¥ç‚¹å‡» <a href="https://deepnote.com/project/bloxs-ZNGnsap0R7ea8LeZY0uarQ/%2Fnotebook.ipynb">notebook</a> ä¸‹è½½ã€‚</p>
<br>
<h2 id="ç»“åˆmercuryç”¨bloxs">ç»“åˆMercuryç”¨Bloxs</h2>
<p><a href="https://github.com/mljar/mercury">Mercury</a> æ˜¯ä¸€ä¸ªç”¨äºå°†ç¬”è®°æœ¬è½¬æ¢ä¸ºäº¤äº’å¼ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ å®ƒåŸºäº YAML é…ç½®å°†å°éƒ¨ä»¶æ·»åŠ åˆ°ç¬”è®°æœ¬ä¸­ã€‚ ä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªå¸¦æœ‰ bloxs çš„ç¬”è®°æœ¬ï¼Œä»¥åŠä½œä¸º Mercury çš„ Web åº”ç”¨ç¨‹åºçš„åŒä¸€ç¬”è®°æœ¬ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_notebook.gif" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="mercuryç½‘é¡µåº”ç”¨">Mercuryç½‘é¡µåº”ç”¨</h2>
<p><a href="https://mercury.mljar.com/app/5">Demo</a></p>
<div style="text-align: center;">
<figure >
    
        <img src="img/bloxs_mercury.gif" width="100%" />
    
    
</figure>
</div>
<p><br><br></p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>TechWeekly-16 æ¯å‘¨æœ‰è¶£æœ‰ç”¨çš„æŠ€æœ¯åˆ†äº«</title>
      <link>https://hidadeng.github.io/blog/techweekly16/</link>
      <pubDate>Fri, 01 Apr 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/techweekly16/</guid>
      <description>æœ¬æœŸTechWeeklyä¸»è¦æ˜¯ä¸€äº›cssã€jsç±»é¡¹ç›®ï¼Œå¯ä»¥èµ·åˆ°ç‚¹ç¼€ç½‘ç«™çš„æ•ˆæœã€‚</description>
      <content:encoded><![CDATA[<p>æœ¬æœŸTechWeeklyä¸»è¦æ˜¯ä¸€äº›cssã€jsç±»é¡¹ç›®ï¼Œå¯ä»¥èµ·åˆ°ç‚¹ç¼€ç½‘ç«™çš„æ•ˆæœã€‚</p>
<p>å»ºè®®å¤§å®¶å¦‚æœæœ‰æ—¶é—´ï¼Œå¯ä»¥äº†è§£ä¸‹html/cssï¼Œå¾ˆç®€å•çš„ã€‚å¦‚æœä½¿ç”¨Hugoè¿™ç±»å»ºç«™æ¡†æ¶ï¼Œå¯ä»¥è‡ªå·±ä¿®æ”¹ä¸‹å­—ä½“é¢œè‰²ï¼Œä»¥ç¬¦åˆè‡ªå·±çš„å®¡ç¾ã€‚ä»¥åä¼šè€ƒè™‘åœ¨è¿™ä¸ªåšå®¢ç«™ç‚¹ä¸­ç”¨åˆ°ï¼Œäºæ˜¯æ•´ç†å‡ºæ¥æœ¬æœŸTechWeeklyã€‚</p>
<br>
<h2 id="animatecss">Animate.css</h2>
<p><a href="https://animate.style/">https://animate.style/</a></p>
<p>CSSç½‘é¡µåŠ¨ç”»åº“</p>
<div style="text-align: center;">
<figure >
    <a href="https://animate.style/">
        <img src="img/animate.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®Animateç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="tabler">Tabler</h2>
<p><a href="https://github.com/tabler/tabler">https://github.com/tabler/tabler</a></p>
<p>Tabler æ˜¯åŸºäº Bootstrap æ„å»ºçš„å…è´¹å¼€æº HTML Dashboard UI Kit</p>
<div style="text-align: center;">
<figure >
    <a href="https://preview.tabler.io/">
        <img src="img/tabler.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®tablerç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="flowbite">Flowbite</h2>
<p><a href="https://github.com/themesberg/flowbite">https://github.com/themesberg/flowbite</a></p>
<p>ä½¿ç”¨ Tailwind CSS æ„å»ºçš„æœ€å—æ¬¢è¿çš„äº¤äº’å¼ UI ç»„ä»¶åº“</p>
<div style="text-align: center;">
<figure >
    <a href="https://flowbite.com/">
        <img src="img/flowbite.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®flowbiteç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="sheetjs">SheetJs</h2>
<p><a href="https://github.com/SheetJS/sheetjs">https://github.com/SheetJS/sheetjs</a></p>
<ul>
<li>
<p>ç®€åŒ–çš„ç”µå­è¡¨æ ¼</p>
</li>
<li>
<p>é˜…è¯»ã€ç¼–è¾‘å’Œå¯¼å‡ºç”µå­è¡¨æ ¼</p>
</li>
<li>
<p>é€‚ç”¨äºç½‘ç»œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ï¼Œ</p>
</li>
<li>
<p>åœ¨ Office 365 ä¸­å— Microsoft ä¿¡ä»»</p>
</li>
</ul>
<div style="text-align: center;">
<figure >
    <a href="https://sheetjs.com/">
        <img src="img/sheetjs.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®ç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="d3">D3</h2>
<p><a href="https://github.com/d3/d3">https://github.com/d3/d3</a></p>
<p>D3.js æ˜¯ä¸€ä¸ª JavaScript å¯è§†åŒ–åº“ã€‚ D3 èƒ½ä½¿ HTMLã€SVG å’Œ CSS ç­‰æ–‡ä»¶å°†æ•°æ®å¯è§†åŒ–å˜ä¸ºç°å®ã€‚</p>
<div style="text-align: center;">
<figure >
    <a href="https://d3js.org/">
        <img src="img/d3.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®ç½‘ç«™</i></small></figcaption>
</figure>
</div>
<p>ä¸‹é¢æ˜¯D3åˆ¶ä½œçš„æ ·ä¾‹</p>
<div style="text-align: center;">
<figure >
    <a href="https://observablehq.com/@d3/gallery">
        <img src="img/d31.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®D3çš„Gallery</i></small></figcaption>
</figure>
</div>
<div style="text-align: center;">
<figure >
    <a href="https://observablehq.com/@d3/gallery">
        <img src="img/d32.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®D3çš„Gallery</i></small></figcaption>
</figure>
</div>
<div style="text-align: center;">
<figure >
    <a href="https://observablehq.com/@d3/gallery">
        <img src="img/d33.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®D3çš„Gallery</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="budibase">budibase</h2>
<p><a href="https://github.com/Budibase/budibase">https://github.com/Budibase/budibase</a></p>
<p>åœ¨å‡ åˆ†é’Ÿå†…æ„å»ºç»„ç»‡å†…ç½‘çš„åº”ç”¨ç¨‹åºï¼Œæ”¯æŒSupports PostgreSQL, MySQL, MSSQL, MongoDB, Rest API, Docker, K8s</p>
<div style="text-align: center;">
<figure >
    <a href="https://budibase.com/">
        <img src="img/budibase.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®budibaseç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="vitae">vitae</h2>
<p><a href="https://pkg.mitchelloharawild.com/vitae/">https://pkg.mitchelloharawild.com/vitae/</a></p>
<p>ä½¿ç”¨Rmarkdownåˆ¶ä½œä¸ªäººç®€å†</p>
<div style="text-align: center;">
<figure >
    <a href="https://pkg.mitchelloharawild.com/vitae/">
        <img src="img/vitae.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®budibaseç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="nextra">nextra</h2>
<p><a href="https://github.com/shuding/nextra">https://github.com/shuding/nextra</a></p>
<p>Nextra æ˜¯ä¸€ä¸ª Next.js å’Œ MDX é©±åŠ¨çš„æ— ä»£ç ç«™ç‚¹ç”Ÿæˆå™¨ã€‚1åˆ†é’Ÿå³å¯åˆ¶ä½œå‡ºä¸‹å›¾çš„é™æ€ç½‘ç«™ã€‚</p>
<div style="text-align: center;">
<figure >
    <a href="https://nextra.vercel.app/">
        <img src="img/nextra.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»å›¾ç‰‡è®¿é—®nextraç½‘ç«™</i></small></figcaption>
</figure>
</div>
<br>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>streamlit|ä»»åŠ¡å‘¨æœŸè¡¨ç”Ÿæˆå™¨</title>
      <link>https://hidadeng.github.io/blog/periodic-table-creator/</link>
      <pubDate>Tue, 29 Mar 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/periodic-table-creator/</guid>
      <description>è¿™ä¸ªå‘¨æœŸè¡¨ç”Ÿæˆå™¨çš„æƒ³æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå…³äº è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡å‘¨æœŸè¡¨çš„åšå®¢ã€‚ åœ¨ Streamlit çš„å¸®åŠ©ä¸‹å¹¶å—åˆ°æ­¤ Bokehçš„å¯å‘ï¼Œå®ƒæˆä¸ºäº†ä¸€ä¸ªåŠ¨æ€çš„åˆ›å»ºè€…ï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„å…ƒç´ å‘¨æœŸè¡¨è¿›è¡Œå®šåˆ¶ ï¼</description>
      <content:encoded><![CDATA[<iframe
    src="//player.bilibili.com/player.html?bvid=BV1mu411i7Jv&page=1"
    scrolling="no"
    height="500px"
    width="800px"
    frameborder="no"
    framespacing="0"
    allowfullscreen="true"
>
</iframe>

<p>è¿™ä¸ª<strong>å‘¨æœŸè¡¨ç”Ÿæˆå™¨</strong>çš„æƒ³æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå…³äº <a href="https://www.innerdoc.com/periodic-table-of-nlp-tasks/">è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡å‘¨æœŸè¡¨</a> çš„åšå®¢ã€‚ åœ¨ Streamlit çš„å¸®åŠ©ä¸‹å¹¶å—åˆ°æ­¤ Bokeh <a href="https://docs.bokeh.org/en/latest/docs/gallery/periodic.html">å›¾åº“ç¤ºä¾‹</a> çš„å¯å‘ï¼Œå®ƒæˆä¸ºäº†ä¸€ä¸ªåŠ¨æ€çš„åˆ›å»ºè€…ï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„å…ƒç´ å‘¨æœŸè¡¨è¿›è¡Œå®šåˆ¶ ï¼</p>
<p>å¤§é‚“çš„ä½œç”¨ä»…ä»…æ˜¯å°†å…¶æ±‰åŒ–ï¼Œæ²¡æœ‰åšå¸ƒå±€ä¸Šçš„æ–°åˆ›æ–°ã€‚</p>
<br>
<h2 id="ä¸‹è½½">ä¸‹è½½</h2>
<p>ç‚¹å‡»ä¸‹è½½<a href="periodic-table-creator.zip"><strong>periodic-table-creator</strong></a>é¡¹ç›®å‹ç¼©æ–‡ä»¶å¤¹</p>
<br>
<p>ä¸‹é¢æ˜¯è‡ªå®šä¹‰çš„<strong>ä»»åŠ¡å‘¨æœŸè¡¨</strong>ç¤ºä¾‹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼šå¯¹äºè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼</p>
<p><img loading="lazy" src="img/periodic-table-generator-customize-content.png" alt="alt text"  />
</p>
<br>
<h2 id="å®‰è£…è¿è¡Œ">å®‰è£…&amp;è¿è¡Œ</h2>
<p>æ‰“å¼€å‘½ä»¤è¡Œ(ç»ˆç«¯),</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pip3 install streamlit==1.8.1
pip3 install bokeh==2.4.1


#åˆ‡æ¢è‡³é¡¹ç›®æ–‡ä»¶å¤¹periodic-table-creator
cd periodic-table-creator

#è¿è¡Œstreamlit
streamlit run periodic_table_creator.py
</code></pre></div><p>æ­¤æ—¶åœ¨å‘½ä»¤è¡Œä¸­ä¼šå‡ºç°</p>
<p><img loading="lazy" src="img/terminal.png" alt=""  />
</p>
<p>ç‚¹å‡»<strong>Local URL</strong>å¯¹åº”çš„é“¾æ¥ï¼Œæˆ–è€…å°†è¯¥é“¾æ¥å¤åˆ¶ç²˜è´´åˆ°æµè§ˆå™¨ï¼Œå³å¯è®¿é—®ã€‚</p>
<p><img loading="lazy" src="img/firstrun.png" alt=""  />
</p>
<br>
<h2 id="å¯¼å…¥æ•°æ®">å¯¼å…¥æ•°æ®</h2>
<p>åˆ›å»ºè‡ªå·±ç‰¹æœ‰çš„<strong>ä»»åŠ¡å‘¨æœŸè¡¨</strong>éœ€è¦å¯¼å…¥è‡ªç”±çš„csvæ•°æ®ã€‚å¯ä»¥[ç‚¹å‡»è¿™é‡Œ] (periodic-table-creator/periodic_nlp.csv) ä¸‹è½½å¹¶æŸ¥çœ‹æ•°æ®æ ¼å¼ï¼Œæˆ–è€…è¿è¡Œæ¡ˆä¾‹æ—¶ï¼Œ ç‚¹å‡»æŒ‰é’®&quot;Edit CSV text&quot; æŸ¥çœ‹ç¤ºä¾‹æ•°æ®æ ¼å¼ã€‚</p>
<ul>
<li>è¡¨çš„å­—ç¬¦å(åˆ—å): <code>atomicnumber;group;period;symbol;elementname;groupname;color;url;excerpt</code></li>
<li>csvæ–‡ä»¶çš„åˆ†éš”ç¬¦ä½¿ç”¨è‹±æ–‡æ ¼å¼ä¸‹çš„ <code>;</code>æˆ–<code>,</code></li>
<li>csvæ–‡ä»¶ä½¿ç”¨utf-8ç¼–ç </li>
</ul>
<p><img loading="lazy" src="img/periodic-table-generator-load-content.png" alt=""  />
</p>
<br>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨streamlitåˆ¶ä½œè‡ªç„¶è¯­è¨€å¤„ç†å‘å±•æ—¶é—´çº¿é¡µé¢</title>
      <link>https://hidadeng.github.io/blog/nlp-history-timeline/</link>
      <pubDate>Sun, 27 Mar 2022 10:43:10 +0600</pubDate>
      
      <guid>/blog/nlp-history-timeline/</guid>
      <description>ä½¿ç”¨streamlitåˆ¶ä½œè‡ªç„¶è¯­è¨€å¤„ç†å‘å±•æ—¶é—´çº¿é¡µé¢</description>
      <content:encoded><![CDATA[<h2 id="è¯´æ˜">è¯´æ˜</h2>
<p>è¿™ä¸ªæ¡ˆä¾‹ä½¿ç”¨<a href="https://streamlit.io">Streamlit</a> å’Œ <a href="http://timeline.knightlab.com/">TimelineJS</a> åˆ¶ä½œï¼Œ é€šè¿‡æ—¶é—´çº¿æ–¹å¼å±•ç¤ºè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå‘å±•ã€‚å¤§å®¶å¯ä»¥å°†å…¶æ”¹é€ ä¸ºå…¬å¸å‘å±•æ—¶é—´çº¿ã€äººç”Ÿé‡Œç¨‹ç¢‘æ—¶é—´çº¿ç­‰ç­‰ã€‚</p>
<br>
<h2 id="ä¸‹è½½è¿è¡Œ">ä¸‹è½½&amp;è¿è¡Œ</h2>
<ul>
<li><a href="nlp-history-timeline.zip">ç‚¹å‡»æ­¤å¤„ä¸‹è½½ä»£ç </a>   <a href="https://hidadeng.github.io/blog/nlp-history-timeline/nlp-history-timeline.zip">https://hidadeng.github.io/blog/nlp-history-timeline/nlp-history-timeline.zip</a></li>
<li>è§£å‹nlp-history-timeline.zipæ–‡ä»¶å¤¹ï¼Œæ”¾ç½®äº<strong>æ¡Œé¢</strong></li>
<li>æ‰“å¼€å‘½ä»¤è¡Œ(ç»ˆç«¯)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">#åˆ‡æ¢åˆ°nlp-history-timeline
cd nlp-history-timeline

#å®‰è£…éœ€è¦çš„åŒ…
pip3 install -r requirements.txt

#è¿è¡Œtimeline_app.py
streamlit run timeline_app.py
</code></pre></div><br>
<h2 id="ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</h2>
<ul>
<li><a href="https://www.innerdoc.com/nlp-timeline-demo/">ç‚¹å‡»æ‰“å¼€æ¡ˆä¾‹ç½‘ç«™</a></li>
</ul>
<p>ä¸‹é¢æ˜¯ç½‘é¡µçš„ä¸€ä¸ªæ—¶é—´ç‚¹</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/demo-timeline.png" width="100%" />
    
    <figcaption><small><i>è‡ªç„¶è¯­è¨€å¤„ç†å‘å±•æ—¶é—´çº¿</i></small></figcaption>
</figure>
</div>
<br>
<p>ä½ ä¹Ÿå¯ä»¥æµè§ˆçš„åŸå§‹æ•°æ®æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºjsonã€‚ä¸‹å›¾å¯ä»¥çœ‹åˆ°jsonçš„æ˜¯ç”±</p>
<ul>
<li>36ä¸ªå­—å…¸ï¼Œå³36ä¸ªæ—¶é—´ç‚¹</li>
<li>æ¯ä¸ªå­—å…¸ä¸­æœ‰å¾ˆå¤šå­—æ®µï¼Œå¦‚urlå›¾ç‰‡é“¾æ¥ã€headlineã€yearå¹´ä»½ã€textç®€ä»‹ç­‰ã€‚</li>
</ul>
<div style="text-align: center;">
<figure >
    
        <img src="img/demo-data.png" width="100%" />
    
    <figcaption><small><i>æ—¶é—´çº¿æ¡ˆä¾‹æ•°æ®</i></small></figcaption>
</figure>
</div>
<br>
<p><br><br></p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨altairç»˜åˆ¶æ¼‚äº®çš„è‚¡ç¥¨ä»·æ ¼è¶‹åŠ¿å›¾</title>
      <link>https://hidadeng.github.io/blog/time-series-annotation/</link>
      <pubDate>Sun, 27 Mar 2022 10:42:10 +0600</pubDate>
      
      <guid>/blog/time-series-annotation/</guid>
      <description>ä½¿ç”¨altairç»˜åˆ¶æ¼‚äº®çš„è‚¡ç¥¨ä»·æ ¼è¶‹åŠ¿å›¾</description>
      <content:encoded><![CDATA[<div style="text-align: center;">
<figure >
    <a href="https://share.streamlit.io/streamlit/example-app-time-series-annotation/main">
        <img src="img/stockevolution.svg" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»</i></small></figcaption>
</figure>
</div>
<p>ä½¿ç”¨altairç»˜åˆ¶æ¼‚äº®çš„è‚¡ç¥¨ä»·æ ¼è¶‹åŠ¿å›¾, ç›´æ¥ä¸Šä»£ç ã€‚</p>
<br>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">altair</span>
</code></pre></div><br>
<h2 id="æ¡ˆä¾‹æ•°æ®">æ¡ˆä¾‹æ•°æ®</h2>
<p>è¿™é‡Œä½¿ç”¨vega_datasetsä¸­æä¾›çš„æ•°æ®åšæµ‹è¯•ï¼Œè¿”å›çš„ç»“æœæ˜¯dataframeç±»å‹çš„æ•°æ®ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">vega_datasets</span> <span class="kn">import</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">stocks</span><span class="p">()</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">source</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="s2">&#34;2004-01-01&#34;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">source</span>

<span class="n">get_data</span><span class="p">()</span>
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symbol</th>
      <th>date</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>49</th>
      <td>MSFT</td>
      <td>2004-02-01</td>
      <td>21.77</td>
    </tr>
    <tr>
      <th>50</th>
      <td>MSFT</td>
      <td>2004-03-01</td>
      <td>20.46</td>
    </tr>
    <tr>
      <th>51</th>
      <td>MSFT</td>
      <td>2004-04-01</td>
      <td>21.45</td>
    </tr>
    <tr>
      <th>52</th>
      <td>MSFT</td>
      <td>2004-05-01</td>
      <td>21.53</td>
    </tr>
    <tr>
      <th>53</th>
      <td>MSFT</td>
      <td>2004-06-01</td>
      <td>23.44</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>555</th>
      <td>AAPL</td>
      <td>2009-11-01</td>
      <td>199.91</td>
    </tr>
    <tr>
      <th>556</th>
      <td>AAPL</td>
      <td>2009-12-01</td>
      <td>210.73</td>
    </tr>
    <tr>
      <th>557</th>
      <td>AAPL</td>
      <td>2010-01-01</td>
      <td>192.06</td>
    </tr>
    <tr>
      <th>558</th>
      <td>AAPL</td>
      <td>2010-02-01</td>
      <td>204.62</td>
    </tr>
    <tr>
      <th>559</th>
      <td>AAPL</td>
      <td>2010-03-01</td>
      <td>223.02</td>
    </tr>
  </tbody>
</table>
<p>364 rows Ã— 3 columns</p>
</div>
<br>
<h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç </h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">vega_datasets</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">vega_datasets</span> <span class="kn">import</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">stocks</span><span class="p">()</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">source</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="s2">&#34;2004-01-01&#34;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">source</span>

<span class="k">def</span> <span class="nf">get_chart</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">hover</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_single</span><span class="p">(</span>
        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;date&#34;</span><span class="p">],</span>
        <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&#34;mouseover&#34;</span><span class="p">,</span>
        <span class="n">empty</span><span class="o">=</span><span class="s2">&#34;none&#34;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&#34;è‚¡ç¥¨ä»·æ ¼è¶‹åŠ¿&#34;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
        <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="s2">&#34;date&#34;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s2">&#34;price&#34;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&#34;symbol&#34;</span><span class="p">,</span>
            <span class="c1"># strokeDash=&#34;symbol&#34;,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Draw points on the line, and highlight based on selection</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">65</span><span class="p">)</span>

    <span class="c1"># Draw a rule at the location of the selection</span>
    <span class="n">tooltips</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mark_rule</span><span class="p">()</span>
        <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="s2">&#34;yearmonthdate(date)&#34;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s2">&#34;price&#34;</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">hover</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
                <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&#34;date&#34;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&#34;æ—¥æœŸ&#34;</span><span class="p">),</span>
                <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&#34;price&#34;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&#34;ä»·æ ¼ (USD)&#34;</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_selection</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">points</span> <span class="o">+</span> <span class="n">tooltips</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>


<span class="c1"># Original time series chart. Omitted `get_chart` for clarity</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">get_chart</span><span class="p">(</span><span class="n">get_data</span><span class="p">())</span>

<span class="c1"># Input annotations</span>
<span class="n">ANNOTATIONS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&#34;Mar 01, 2008&#34;</span><span class="p">,</span> <span class="s2">&#34;Pretty good day for GOOG&#34;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&#34;Dec 01, 2007&#34;</span><span class="p">,</span> <span class="s2">&#34;Something&#39;s going wrong for GOOG &amp; AAPL&#34;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&#34;Nov 01, 2008&#34;</span><span class="p">,</span> <span class="s2">&#34;Market starts again thanks to...&#34;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&#34;Dec 01, 2009&#34;</span><span class="p">,</span> <span class="s2">&#34;Small crash for GOOG after...&#34;</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Create a chart with annotations</span>
<span class="n">annotations_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ANNOTATIONS</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;date&#34;</span><span class="p">,</span> <span class="s2">&#34;event&#34;</span><span class="p">])</span>
<span class="n">annotations_df</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">annotations_df</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<span class="n">annotations_df</span><span class="p">[</span><span class="s2">&#34;y&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">annotation_layer</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">annotations_df</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">ticker</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">ticker_dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">ticker_dy</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&#34;center&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&#34;date:T&#34;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&#34;y:Q&#34;</span><span class="p">),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;event&#34;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="p">)</span>



<span class="p">(</span><span class="n">chart</span> <span class="o">+</span> <span class="n">annotation_layer</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div><p>Run</p>
<p><img loading="lazy" src="img/stockevolution.svg" alt=""  />
</p>
<br>
<h2 id="ä»£ç ä¸‹è½½time-series-annotationzip"><a href="time-series-annotation.zip">ä»£ç ä¸‹è½½</a></h2>
<br>
<h2 id="å‡ºå¤„">å‡ºå¤„</h2>
<p><a href="https://share.streamlit.io/streamlit/example-app-time-series-annotation/main">https://share.streamlit.io/streamlit/example-app-time-series-annotation/main</a></p>
<br>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨WeasyPrintè‡ªåŠ¨ç”ŸæˆpdfæŠ¥å‘Šæ–‡ä»¶</title>
      <link>https://hidadeng.github.io/blog/weasyprint_auto_report/</link>
      <pubDate>Sun, 27 Mar 2022 10:41:10 +0600</pubDate>
      
      <guid>/blog/weasyprint_auto_report/</guid>
      <description>è‡ªåŠ¨åŒ–åŠå…¬ï¼Œå¯ä½¿ç”¨WeasyPrintè‡ªåŠ¨ç”ŸæˆpdfæŠ¥å‘Šæ–‡ä»¶</description>
      <content:encoded><![CDATA[<p>Pandaséå¸¸å–„äºå¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œæ”¯æŒå°†ç»“æœå¯¼å‡ºåˆ°CSVï¼ŒExcelï¼ŒHTMLï¼Œjsonç­‰æ–‡ä»¶ä¸­ã€‚ å¦‚æœæ‚¨æƒ³å°† <code>å¤šç§ä¿¡æ¯ï¼ˆexcelã€å›¾ç‰‡ç­‰ï¼‰ç»„åˆ</code> åˆ°ä¸€ä¸ªæ–‡æ¡£ä¸­ï¼Œé‚£ä¹ˆäº‹æƒ…å˜å¾—æ›´åŠ å›°éš¾ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¦åœ¨ä¸€ä¸ªExcelå·¥ä½œè¡¨ä¸Šæ”¾ç½®ä¸¤ä¸ªDataFrameï¼Œåˆ™éœ€è¦ä½¿ç”¨ç›¸åº”çš„Excelåº“æ‰èƒ½è¾“å‡ºã€‚ è¿™å½“ç„¶æ˜¯OKçš„ï¼Œä½†èµ°èµ·æ¥çœŸä¸ç®€å•ã€‚ æœ¬æ–‡å°†ä»‹ç»ä¸€ç§æ–¹æ³•ï¼Œå°†å¤šç§ <code>ä¿¡æ¯ï¼ˆexcelã€å›¾ç‰‡ç­‰ï¼‰ç»„åˆ</code> æˆä¸€ä¸ª <code>HTMLæ¨¡æ¿</code> ï¼Œç„¶åä½¿ç”¨<code>Jinjaæ¨¡æ¿å’ŒWeasyPrint</code> å†å°†å…¶è½¬æ¢ä¸ºç‹¬ç«‹çš„PDFæ–‡æ¡£ã€‚</p>
<br>
<h2 id="æ“ä½œæµç¨‹">æ“ä½œæµç¨‹</h2>
<p>ä½¿ç”¨Pandaså°†æ•°æ®è¾“å‡ºåˆ°Excelæ–‡ä»¶ä¸­çš„å¤šä¸ªå·¥ä½œè¡¨æˆ–è€…ç”¨DataFramesåˆ›å»ºå¤šä¸ªExcelæ–‡ä»¶éå¸¸æ–¹ä¾¿ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³å°† <code>å¤šç§ä¿¡æ¯ï¼ˆexcelã€å›¾ç‰‡ç­‰ï¼‰ç»„åˆ</code> è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆç›´æ¥ä»Pandasè¿›è¡Œæ“ä½œçš„æ–¹æ³•å¹¶ä¸å¤šã€‚ å¹¸è¿çš„æ˜¯ï¼Œä¸‡èƒ½çš„pythonå¤§æ³•æœ‰å¾ˆå¤šé€‰é¡¹å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é‡‡ç”¨ä»¥ä¸‹æµç¨‹æ¥åˆ›å»ºå¤šé¡µPDFæ–‡æ¡£ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/pdf-conversion-pipeline.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="å·¥å…·">å·¥å…·</h2>
<p>æˆ‘å†³å®šä½¿ç”¨HTMLä½œä¸ºæ¨¡æ¿è¯­è¨€ï¼Œå› ä¸ºå®ƒå¯èƒ½æ˜¯ç”Ÿæˆç»“æ„åŒ–æ•°æ®æœ€ä¾¿æ·çš„æ–¹æ³•ï¼Œæ”¯æŒå„ç§æ ¼å¼æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€excelè¡¨ï¼‰ã€‚æˆ‘ä¹Ÿè®¤ä¸ºæ¯ä¸ªäººéƒ½çŸ¥é“ï¼ˆæˆ–å¯ä»¥å¼„æ¸…æ¥šï¼‰è¶³å¤Ÿçš„HTMLçŸ¥è¯†æ¥ç”Ÿæˆä¸€ä¸ªç®€å•çš„æŠ¥å‘Šã€‚</p>
<p>è¿™ä¸ªå·¥ä½œæµç¨‹ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†æ˜¯å¼„æ¸…æ¥šå¦‚ä½•å°†HTMLå‘ˆç°ä¸ºPDFã€‚æˆ‘è§‰å¾—è¿˜æ²¡æœ‰æœ€ä½³çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æˆ‘é€‰æ‹©äº† <code>WeasyPrint</code> ï¼Œå› ä¸ºå®ƒä»ç„¶åœ¨ç§¯æç»´æŠ¤ï¼Œæˆ‘å‘ç°æˆ‘å¯ä»¥ç›¸å¯¹å®¹æ˜“åœ°ä½¿å®ƒå·¥ä½œã€‚ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘è¿‡å»ä½¿ç”¨è¿‡xhtml2pdfï¼Œå®ƒçš„æ•ˆæœä¹Ÿå¾ˆå¥½ï¼Œé—æ†¾çš„æ˜¯è¯¥åº“ç¼ºä¹æ–‡æ¡£è¯´æ˜ï¼Œä½†å®ƒå·²å­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸”ç¡®å®å¯ä»¥ä»HTMLç”ŸæˆPDFã€‚</p>
<br>
<h2 id="æ•°æ®">æ•°æ®</h2>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¹‹å‰æ–‡ç« ä¸­çš„ç›¸åŒæ•°æ®é›†ã€‚ ä¸ºäº†ä½¿è¿™ä¸€åˆ‡æˆä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ–‡ç« ï¼Œä¸‹é¢æ˜¯æˆ‘å¦‚ä½•å¯¼å…¥æ•°æ®,åšæè¿°æ€§ç»Ÿè®¡ï¼ŒåŠå¹¶ç”Ÿæˆå…³äºCPUå’Œè½¯ä»¶é”€å”®çš„ <code>æ•°æ®é€è§†è¡¨</code> ã€‚</p>
<p>å¯¼å…¥æ¨¡å—ï¼Œå¹¶è¯»å…¥é”€å”®æ¸ é“ä¿¡æ¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;salesfunnel.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p>Run</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>Name</th>
      <th>Rep</th>
      <th>Manager</th>
      <th>Product</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>714466</td>
      <td>Trantow-Barrows</td>
      <td>Craig Booker</td>
      <td>Debra Henley</td>
      <td>CPU</td>
      <td>1</td>
      <td>30000</td>
      <td>presented</td>
    </tr>
    <tr>
      <th>1</th>
      <td>714466</td>
      <td>Trantow-Barrows</td>
      <td>Craig Booker</td>
      <td>Debra Henley</td>
      <td>Software</td>
      <td>1</td>
      <td>10000</td>
      <td>presented</td>
    </tr>
    <tr>
      <th>2</th>
      <td>714466</td>
      <td>Trantow-Barrows</td>
      <td>Craig Booker</td>
      <td>Debra Henley</td>
      <td>Maintenance</td>
      <td>2</td>
      <td>5000</td>
      <td>pending</td>
    </tr>
    <tr>
      <th>3</th>
      <td>737550</td>
      <td>Fritsch, Russel and Anderson</td>
      <td>Craig Booker</td>
      <td>Debra Henley</td>
      <td>CPU</td>
      <td>1</td>
      <td>35000</td>
      <td>declined</td>
    </tr>
    <tr>
      <th>4</th>
      <td>146832</td>
      <td>Kiehn-Spinka</td>
      <td>Daniel Hilton</td>
      <td>Debra Henley</td>
      <td>CPU</td>
      <td>2</td>
      <td>65000</td>
      <td>won</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<p>å¯¹æ•°æ®åšé€è§†è¡¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">sales_report</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Manager&#34;</span><span class="p">,</span> <span class="s2">&#34;Rep&#34;</span><span class="p">,</span> <span class="s2">&#34;Product&#34;</span><span class="p">],</span> 
                              <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Price&#34;</span><span class="p">,</span> <span class="s2">&#34;Quantity&#34;</span><span class="p">],</span>
                              <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">],</span> 
                              <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sales_report</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><p>Run</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">sum</th>
      <th colspan="2" halign="left">mean</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>Price</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Quantity</th>
    </tr>
    <tr>
      <th>Manager</th>
      <th>Rep</th>
      <th>Product</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Debra Henley</th>
      <th rowspan="3" valign="top">Craig Booker</th>
      <th>CPU</th>
      <td>65000</td>
      <td>2</td>
      <td>32500</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Maintenance</th>
      <td>5000</td>
      <td>2</td>
      <td>5000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Software</th>
      <td>10000</td>
      <td>1</td>
      <td>10000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Daniel Hilton</th>
      <th>CPU</th>
      <td>105000</td>
      <td>4</td>
      <td>52500</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Software</th>
      <td>10000</td>
      <td>1</td>
      <td>10000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<h2 id="æ¨¡æ¿">æ¨¡æ¿</h2>
<p>DataFrameæ‹¥æœ‰to_html()çš„æ–¹æ³•ï¼Œå¯ä»¥å°†dataframeæ•°æ®è½¬åŒ–ä¸ºå«æœ‰HTMLæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p>
<p>ä½†æ˜¯éšç€æ‚¨çš„æŠ¥å‘Šå˜å¾—è¶Šæ¥è¶Šå¤æ‚æˆ–æ‚¨é€‰æ‹©å°†Jinjaæ¨¡æ¿ç”¨äºæ‚¨çš„ç½‘ç»œåº”ç”¨ï¼Œjinjaçš„è¿™äº›åŠŸèƒ½å°†ä¸ºæ‚¨æä¾›è‰¯å¥½çš„æœåŠ¡ã€‚Jinjaçš„å¦ä¸€ä¸ªä¸é”™çš„åŠŸèƒ½æ˜¯å®ƒåŒ…å«å¤šä¸ªå†…ç½®è¿‡æ»¤å™¨ï¼Œè¿™äº›è¿‡æ»¤å™¨å…è®¸æˆ‘ä»¬ä»¥Pandasä¸­éš¾ä»¥åšåˆ°çš„æ–¹å¼æ ¼å¼åŒ–æˆ‘ä»¬çš„ä¸€äº›æ•°æ®ã€‚</p>
<p>ä¸ºäº†åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Jinjaï¼Œæˆ‘ä»¬éœ€è¦åšä¸‰ä»¶äº‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">1. åˆ›å»ºä¸€ä¸ªæ¨¡æ¿
2. å°†å˜é‡æ·»åŠ åˆ°æ¨¡æ¿ä¸Šä¸‹æ–‡ä¸­
3. å°†æ¨¡æ¿æ¸²æŸ“ä¸ºHTML
</code></pre></div><br>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¨¡æ¿ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºmyreport.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{ title }}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Sales Funnel Report - National<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
     {{ national_pivot_table }}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div><p>ä¸Šé¢htmlä»£ç ä¸­æ‹¥æœ‰ <code>{{title}} å’Œ {{national_pivot_table }}</code> è¿™ä¸¤ä¸ªå…³é”®è¯ã€‚è¿™ä¸¤ä¸ªå…³é”®è¯ç”¨æ¥æ¥æ”¶éœ€è¦æ¸²æŸ“çš„æ•°æ®ï¼Œæ¯”å¦‚å›¾ç‰‡å¯¹è±¡ã€dataframeå¯¹è±¡ç­‰ã€‚</p>
<p>è¦å¡«å……è¿™äº›å˜é‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªJinjaç¯å¢ƒå¹¶è·å–æˆ‘ä»¬çš„æ¨¡æ¿å¯¹è±¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">FileSystemLoader</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;myreport.html&#39;</span><span class="p">)</span>
</code></pre></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘å‡è®¾æ¨¡æ¿ä½äºå½“å‰ç›®å½•ä¸­ï¼Œä½†æ‚¨å¯ä»¥å°†å®Œæ•´è·¯å¾„æ”¾åˆ°æ¨¡æ¿ä½ç½®ã€‚</p>
<p>å¦ä¸€ä¸ªå…³é”®ç»„ä»¶æ˜¯ <code>env</code> çš„åˆ›å»ºã€‚ è¿™ä¸ªå˜é‡æ˜¯æˆ‘ä»¬å°†æ•°æ®ï¼ˆæˆ–å¯¹è±¡ï¼‰å¡«å……ç»™æ¨¡æ¿çš„æ–¹å¼ã€‚ æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>template_var</code> çš„å­—å…¸ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬æƒ³è¦ä¼ é€’ç»™æ¨¡æ¿çš„æ‰€æœ‰å˜é‡ã€‚</p>
<p><code>è¯·æ³¨æ„å˜é‡çš„åç§°å¦‚ä½•ä¸æˆ‘ä»¬çš„æ¨¡æ¿åŒ¹é…ã€‚å³åç§°è¦ä¸myreport.htmlä¸­çš„{{}}å¤¹ä½çš„å…³é”®è¯ä¸€æ ·ã€‚</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">template_vars</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span> <span class="p">:</span> <span class="s2">&#34;Sales Funnel Report - National&#34;</span><span class="p">,</span>
                 <span class="s2">&#34;national_pivot_table&#34;</span><span class="p">:</span> <span class="n">sales_report</span><span class="o">.</span><span class="n">to_html</span><span class="p">()}</span>
</code></pre></div><p>æœ€åä¸€æ­¥æ˜¯å°† <code>template_vars</code> æ¸²æŸ“åˆ°htmlæ¨¡æ¿ä¸­ï¼Œå¹¶è¾“å‡ºä¸ºhtmlå­—ç¬¦ä¸²ï¼Œæœ€ç»ˆæˆ‘ä»¬å°†ä½¿ç”¨è¯¥htmlå­—ç¬¦ä¸²æ¥ç”ŸæˆpdfæŠ¥å‘Šã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">html_out</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">template_vars</span><span class="p">)</span>
</code></pre></div><p>ä¸ºç®€æ´èµ·è§ï¼Œæˆ‘ä¸ä¼šæ˜¾ç¤ºå®Œæ•´çš„HTMLï¼Œä½†æ‚¨åº”è¯¥æ˜ç™½è¿™ä¸€ç‚¹ã€‚</p>
<br>
<h2 id="ç”Ÿæˆpdf">ç”Ÿæˆpdf</h2>
<p>pdfæŠ¥å‘Šçš„ç”Ÿæˆéƒ¨åˆ†ç›¸å½“ç®€å•ï¼Œè¿™é‡Œç”¨åˆ°weasyprintåº“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">weasyprint</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">html_out</span><span class="p">)</span><span class="o">.</span><span class="n">write_pdf</span><span class="p">(</span><span class="s2">&#34;report.pdf&#34;</span><span class="p">)</span>
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/ugly_table.png" width="100%" />
    
    
</figure>
</div>
<p>ä½†æ˜¯æ‰“å¼€çš„pdfæ ·å¼å¾ˆç®€å•ï¼Œç™½åº•é»‘å­—å¹¶ä¸ç¾è§‚ã€‚ä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰æ ·å¼è¡¨cssï¼Œä½†æ˜¯å’±ä»¬ä¸ç†Ÿæ‚‰cssï¼Œæœ‰ä¸€ç§ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨æˆç†Ÿçš„cssï¼Œè¿™é‡Œæˆ‘ç”¨çš„<code>typography.css</code> ä½œä¸ºå¡«å……è¡¨æ ¼æ—¶çš„æ ·å¼è¡¨ã€‚è¿™ä¸ªcssçš„ä¼˜ç‚¹æœ‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">1. ç›¸å¯¹è¾ƒå°ä¸”æ˜“äºç†è§£
2. å¯ä»¥åœ¨PDFå¼•æ“ä¸­è¿è¡Œè€Œä¸ä¼šæŠ›å‡ºé”™è¯¯å’Œè­¦å‘Š
3. èƒ½è®©è¡¨æ ¼è¡¨æ ¼çœ‹èµ·æ¥å¾ˆç¾è§‚
</code></pre></div><p>è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨æˆ‘ä»¬æ›´æ–°çš„æ ·å¼è¡¨é‡æ–°æ¸²æŸ“å®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">HTML</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">html_out</span><span class="p">)</span><span class="o">.</span><span class="n">write_pdf</span><span class="p">(</span><span class="s1">&#39;beautiful_report.pdf&#39;</span><span class="p">,</span> <span class="n">stylesheets</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;typography.css&#34;</span><span class="p">])</span>
</code></pre></div><div style="text-align: center;">
<figure >
    
        <img src="img/beautiful_table.png" width="100%" />
    
    
</figure>
</div>
<p>æ·»åŠ äº†ä¸€ä¸ªstylesheetså‚æ•°å°±è®©è¾“å‡ºç»“æœç¬é—´å˜å¾—é«˜ç«¯å¤§æ°”ä¸Šæ¡£æ¬¡ã€‚</p>
<br>
<h2 id="æ›´å¤š">æ›´å¤š</h2>
<p>å¦‚æœæƒ³æ›´åŠ ä¸°å¯Œçš„è¾“å‡ºpdfæŠ¥å‘Šï¼Œå¤§å®¶å›å»éœ€è¦æŸ¥é˜…jinjaæ–‡æ¡£ï¼Œæ‰¾ä¸€äº›cssæ ·å¼è¡¨ã€‚</p>
<br>
<h2 id="ä¸‹è½½weasyprint_auto_reportzip"><a href="weasyprint_auto_report.zip">ä¸‹è½½</a></h2>
<p><a href="weasyprint_auto_report.zip">ç‚¹å‡»è¿™é‡Œ</a>ä¸‹è½½æœ¬æ–‡éœ€è¦çš„å®éªŒæ•°æ®åŠä»£ç </p>
<br>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨Pythonè®¡ç®—åœ°å›¾ä¸­ä¸¤ç‚¹è·ç¦»åŠæ–¹ä½è§’</title>
      <link>https://hidadeng.github.io/blog/how_to_calculate_geo_distance_in_python/</link>
      <pubDate>Thu, 17 Mar 2022 20:43:10 +0600</pubDate>
      
      <guid>/blog/how_to_calculate_geo_distance_in_python/</guid>
      <description>ä½¿ç”¨Pythonçš„geographiclibåŒ…å¯ä»¥ç”¨æ¥è®¡ç®—åœ°ç†ä¿¡æ¯ï¼Œè¯¸å¦‚ä¸¤åŸå¸‚è·ç¦»ã€æ–¹ä½è§’ç­‰ä¿¡æ¯</description>
      <content:encoded><![CDATA[<div style="text-align: center;">
<figure >
    
        <img src="img/earth.jpg" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="ä¸‹è½½æœ¬æ–‡ä»£ç ä½¿ç”¨pythonè®¡ç®—åœ°å›¾ä¸­ä¸¤ç‚¹è·ç¦»åŠæ–¹ä½è§’ipynb"><a href="%E4%BD%BF%E7%94%A8Python%E8%AE%A1%E7%AE%97%E5%9C%B0%E5%9B%BE%E4%B8%AD%E4%B8%A4%E7%82%B9%E8%B7%9D%E7%A6%BB%E5%8F%8A%E6%96%B9%E4%BD%8D%E8%A7%92.ipynb">ä¸‹è½½æœ¬æ–‡ä»£ç </a></h2>
<br>
<h2 id="å¦‚ä½•è®¡ç®—åœ°å›¾ä¸­ä¸¤ç‚¹è·ç¦»åŠè§’åº¦">å¦‚ä½•è®¡ç®—åœ°å›¾ä¸­ä¸¤ç‚¹è·ç¦»åŠè§’åº¦</h2>
<p>ä¾‹å¦‚åŒ—äº¬å¸‚åŒ—çº¬40.1ï¼Œä¸œç»116.6ï¼› å“ˆå°”æ»¨å¸‚åŒ—çº¬45.7567, ä¸œç»126.6424</p>
<p>æ„Ÿå…´è¶£çš„ç«¥é‹ä¹Ÿå¯å»çœ‹é—®é¢˜å‡ºå¤„</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/3932502/calculate-angle-between-two-latitude-longitude-points/51415608">https://stackoverflow.com/questions/3932502/calculate-angle-between-two-latitude-longitude-points/51415608</a></p>
</blockquote>
<p>åœ¨å›ç­”ä¸­ï¼Œçœ‹åˆ°æœ‰åœ°ç†ä¿¡æ¯ç³»ç»ŸPythonåŒ…geographiclibï¼Œå¯ä»¥è®¡ç®—ä¸¤ç‚¹è·ç¦»å’Œè§’åº¦ã€‚</p>
<br>
<h2 id="å®‰è£…geographiclib">å®‰è£…geographiclib</h2>
<p><a href="https://geographiclib.sourceforge.io/1.52/python/">https://geographiclib.sourceforge.io/1.52/python/</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">geographiclib</span><span class="o">==</span><span class="mf">1.52</span>
</code></pre></div><br>
<h2 id="è®¡ç®—è·ç¦»">è®¡ç®—è·ç¦»</h2>
<p>æ³¨æ„ï¼Œåœ¨æ¥ä¸‹æ¥çš„è®¡ç®—ä¸­ï¼Œå°†åŒ—çº¬ã€ä¸œç»è¡¨ç¤ºä¸ºæ­£æ•°ã€‚å°†å—çº¬ã€è¥¿ç»è¡¨ç¤ºä¸ºè´Ÿæ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">beiwei1</span><span class="p">,</span> <span class="n">dongjing1</span><span class="p">,</span> <span class="n">beiwei2</span><span class="p">,</span> <span class="n">dongjing2</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;
</span><span class="s2">    beiwei1: åœ°ç‚¹1çš„çº¬åº¦æ•°ï¼Œå¦‚æœåœ°ç‚¹åœ¨åŒ—åŠçƒï¼ŒåŒ—çº¬ä¸ºæ­£ï¼›åä¹‹ä¸ºè´Ÿã€‚
</span><span class="s2">    dongjing1: åœ°ç‚¹2çš„ç»åº¦æ•°ï¼Œ å¦‚æœä½äºä¸œåŠçƒï¼Œä¸œç»æ•°ä¸ºæ­£ï¼›åä¹‹ä¸ºè´Ÿ
</span><span class="s2">    beiwei2: åœ°ç‚¹2çš„çº¬åº¦æ•°
</span><span class="s2">    dongjing2: åœ°ç‚¹2çš„ç»åº¦æ•°
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="kn">from</span> <span class="nn">geographiclib.geodesic</span> <span class="kn">import</span> <span class="n">Geodesic</span>
    <span class="n">geod</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">WGS84</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">geod</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">beiwei1</span><span class="p">,</span> <span class="n">dongjing1</span><span class="p">,</span> <span class="n">beiwei2</span><span class="p">,</span> <span class="n">dongjing2</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;s12&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>
    <span class="k">return</span> <span class="n">distance</span>
    

<span class="c1">#åŒ—äº¬Beijingä¸å“ˆå°”æ»¨harbin</span>
<span class="n">distance</span><span class="p">(</span><span class="mf">40.1</span><span class="p">,</span> <span class="mf">116.6</span><span class="p">,</span> <span class="mf">45.7567</span><span class="p">,</span> <span class="mf">126.6424</span><span class="p">)</span>
</code></pre></div><p>Run</p>
<pre><code>1031.617791888516
</code></pre>
<div style="text-align: center;">
<figure >
    
        <img src="img/%e8%b7%9d%e7%a6%bb.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="æ–¹ä½è§’azimuth">æ–¹ä½è§’azimuth</h2>
<p>ä¸¤ä¸ªåœ°ç‚¹åœ¨åœ°å›¾ä¸­æ‰€å¤„çš„ç›¸å¯¹ä½ç½®ï¼Œç§°ä¹‹ä¸ºæ–¹ä½è§’azimuthã€‚æ–¹ä½è§’æœ€å¤§åº¦æ•°360åº¦ï¼Œ</p>
<ul>
<li>0åº¦è¡¨ç¤ºæ­£åŒ—</li>
<li>90åº¦è¡¨ç¤ºæ­£è¥¿</li>
<li>180åº¦è¡¨ç¤ºæ­£å—</li>
<li>270åº¦è¡¨ç¤ºæ­£è¥¿</li>
<li>360åº¦è¡¨ç¤ºæ­£åŒ—</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">azimuth</span><span class="p">(</span><span class="n">beiwei1</span><span class="p">,</span> <span class="n">dongjing1</span><span class="p">,</span> <span class="n">beiwei2</span><span class="p">,</span> <span class="n">dongjing2</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;
</span><span class="s2">    beiwei1: åœ°ç‚¹1çš„çº¬åº¦æ•°ï¼Œå¦‚æœåœ°ç‚¹åœ¨åŒ—åŠçƒï¼ŒåŒ—çº¬ä¸ºæ­£ï¼›åä¹‹ä¸ºè´Ÿã€‚
</span><span class="s2">    dongjing1: åœ°ç‚¹2çš„ç»åº¦æ•°ï¼Œ å¦‚æœä½äºä¸œåŠçƒï¼Œä¸œç»æ•°ä¸ºæ­£ï¼›åä¹‹ä¸ºè´Ÿ
</span><span class="s2">    beiwei2: åœ°ç‚¹2çš„çº¬åº¦æ•°
</span><span class="s2">    dongjing2: åœ°ç‚¹2çš„ç»åº¦æ•°
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="kn">from</span> <span class="nn">geographiclib.geodesic</span> <span class="kn">import</span> <span class="n">Geodesic</span>
    <span class="n">geod</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">WGS84</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">geod</span><span class="o">.</span><span class="n">InverseLine</span><span class="p">(</span><span class="n">beiwei1</span><span class="p">,</span> <span class="n">dongjing1</span><span class="p">,</span> <span class="n">beiwei2</span><span class="p">,</span> <span class="n">dongjing2</span><span class="p">)</span>
    <span class="n">s12</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">beiwei1</span><span class="p">,</span> <span class="n">dongjing1</span><span class="p">,</span> <span class="n">beiwei2</span><span class="p">,</span> <span class="n">dongjing2</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="n">s12</span><span class="p">,</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">STANDARD</span> <span class="o">|</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">LONG_UNROLL</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;azi2&#39;</span><span class="p">]</span>

<span class="c1">#åŒ—äº¬ å“ˆå°”æ»¨</span>
<span class="n">azimuth</span><span class="p">(</span><span class="mf">40.1</span><span class="p">,</span> <span class="mf">116.6</span><span class="p">,</span> <span class="mf">45.7567</span><span class="p">,</span> <span class="mf">126.6424</span><span class="p">)</span>
</code></pre></div><pre><code>56.03961942267271
</code></pre>
<p>æŒ‰ç…§azimuthå®šä¹‰ï¼Œ56åº¦çš„è§£è¯»ä¸º å“ˆå°”æ»¨ä½äºåŒ—äº¬çš„ä¸œåŒ—æ–¹å‘ã€‚</p>
<p>åŒç†å¯ä»¥è®¡ç®—è¥¿å®‰ä¸æ­å·</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#è¥¿å®‰ï¼Œ æ­å·</span>
<span class="n">azimuth</span><span class="p">(</span><span class="mf">34.2658</span><span class="p">,</span> <span class="mf">108.9541</span><span class="p">,</span> <span class="mf">30.2741</span><span class="p">,</span> <span class="mf">120.1552</span><span class="p">)</span>
</code></pre></div><pre><code>115.1506923699206
</code></pre>
<p>æ­å·ä½äºè¥¿å®‰çš„115åº¦ï¼Œå³ä¸œå—æ–¹å‘</p>
<p><br><br></p>
<h1 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h1>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p>[ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ](</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>åœ¨Pythonä¸­ä½¿ç”¨Greppoæ„å»ºçš„åœ°ç†ç©ºé—´ä»ªè¡¨æ¿</title>
      <link>https://hidadeng.github.io/blog/geospatial_with_greppo/</link>
      <pubDate>Sat, 12 Mar 2022 20:43:10 +0600</pubDate>
      
      <guid>/blog/geospatial_with_greppo/</guid>
      <description>ç¼ºä¹å‰ç«¯ã€åç«¯å’Œç½‘ç»œå¼€å‘ç»éªŒå¯èƒ½ä¼šé™åˆ¶ä½¿ç”¨ Python åˆ¶ä½œç½‘ç»œåº”ç”¨ç¨‹åºã€‚ åœ¨Pythonä¸­ä½¿ç”¨ Greppoæ„å»ºçš„åœ°ç†ç©ºé—´ä»ªè¡¨æ¿</description>
      <content:encoded><![CDATA[<div style="text-align: center;">
<figure >
    <a href="vector-demo.zip">
        <img src="img/1.gif" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»æœ¬å›¾ä¸‹è½½æœ¬æ–‡é¡¹ç›®ä»£ç </i></small></figcaption>
</figure>
</div>
<h2 id="ä¸‹è½½é¡¹ç›®æ•°æ®ä»£ç vector-demozip"><a href="vector-demo.zip">ä¸‹è½½é¡¹ç›®æ•°æ®ä»£ç </a></h2>
<p><strong>åœ°ç†ç©ºé—´æ•°æ®åˆ†æ</strong>å·²æˆä¸ºæ•°æ®ç§‘å­¦ä¸­çš„ä¸€ä¸ªå¸¸è§é¢†åŸŸã€‚å¯¹äºåœ°ç†ç©ºé—´æ•°æ®ç§‘å­¦æ¥è¯´ä¹Ÿä¸ä¾‹å¤–ã€‚æ”¯æŒ GeoPandasã€Shapely å’Œ Rasterio ç­‰é¡¹ç›®çš„ç¤¾åŒºä½¿ Python æˆä¸ºåœ°ç†ç©ºé—´åˆ†æçš„é¦–é€‰ã€‚</p>
<br>
<h2 id="greppoå¿«é€Ÿç®€å•çš„åœ°ç†ç©ºé—´ä»ªè¡¨æ¿æ„å»ºæ–¹æ³•">Greppoï¼šå¿«é€Ÿç®€å•çš„åœ°ç†ç©ºé—´ä»ªè¡¨æ¿æ„å»ºæ–¹æ³•</h2>
<p>Greppo æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºåœ°ç†ç©ºé—´ç½‘ç»œåº”ç”¨ç¨‹åºçš„å¼€æº Python æ¡†æ¶ã€‚ å®ƒæä¾›äº†å¯éšæ—¶ä½¿ç”¨çš„å‰ç«¯å’Œåç«¯ç»„ä»¶ä½œä¸ºå‡½æ•°ï¼Œå……å½“å‰ç«¯äº¤äº’ç»„ä»¶å’Œç»‘å®šçš„åç«¯å˜é‡ä¹‹é—´çš„ APIã€‚ è¦äº†è§£æœ‰å…³å¿ƒæ™ºæ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œ<a href="https://docs.greppo.io/mental-model.html">è¯·å‚é˜…æ­¤é¡µé¢</a>ã€‚</p>
<p>æ— éœ€å¤ªå¤šå‰ç«¯ã€åç«¯ã€Web å¼€å‘ç»éªŒï¼Œæ‚¨å°±å¯ä»¥åœ¨ 5 åˆ†é’Ÿå†…ä½¿ç”¨ Python æ„å»ºå’Œéƒ¨ç½²åŠŸèƒ½é½å…¨çš„ Web åº”ç”¨ç¨‹åºã€‚</p>
<ul>
<li>GitHubå­˜å‚¨åº“ï¼šhttps://github.com/greppo-io/greppo</li>
<li>æ–‡æ¡£ï¼šhttps://docs.greppo.io/</li>
<li>ç½‘ç«™ï¼šhttps://greppo.io/</li>
</ul>
<blockquote>
<p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Greppo åœ¨ Python ä¸­æ„å»ºåœ°ç†ç©ºé—´ä»ªè¡¨æ¿ã€‚ æˆ‘ä»¬å°†é€šè¿‡è®¾ç½®ç¯å¢ƒã€å®‰è£…ã€å¯¼å…¥æ•°æ®ã€ä¸ºæˆ‘ä»¬çš„ä»ªè¡¨æ¿æ”¾å…¥ç»„ä»¶å¹¶ä¸ºå…¶æä¾›æœåŠ¡æ¥å·¥ä½œã€‚ æ‚¨å°†éœ€è¦äº†è§£ Pythonã€GeoPandas å’Œåœ°ç†ç©ºé—´åˆ†æçš„åŸºç¡€çŸ¥è¯†ã€‚
å…¥é—¨â€¦</p>
</blockquote>
<p>é¦–å…ˆè¦åšçš„æ˜¯å®‰è£…æœ¬æ–‡éœ€è¦çš„ Python ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">pip install greppo geopandas
</code></pre></div><p>ä¸‹è½½æœ¬æ•™ç¨‹æ‰€éœ€çš„æ•°æ®é›†ã€‚ æœ¬æ•™ç¨‹çš„æ‰€æœ‰æ•°æ®å’Œä»£ç éƒ½å¯ä»¥åœ¨è¿™ä¸ª GitHub å­˜å‚¨åº“ä¸­æ‰¾åˆ°ï¼šgreppo-demo/vector-demoï¼ˆæ•°æ®æºï¼šhttps://github.com/openpolis/geojson-italyï¼‰</p>
<br>
<h2 id="ç¼–å†™ä»ªè¡¨æ¿è„šæœ¬">ç¼–å†™ä»ªè¡¨æ¿è„šæœ¬</h2>
<p>æˆ‘ä»¬é¦–å…ˆä¸ºé¡¹ç›®è®¾ç½®æ–‡ä»¶å¤¹ç»“æ„ã€‚ æˆ‘å°†ä½¿ç”¨ä»¥ä¸‹é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">â””â”€â”€ vector-demo
    â”œâ”€â”€ app.py
    â”œâ”€â”€ cities.geojson
    â”œâ”€â”€ regions.geojson
    â””â”€â”€ roads.geojson
</code></pre></div><p>è¯¥åº”ç”¨ç¨‹åºçš„ä¸»æ§è„šæœ¬æ˜¯ app.pyã€‚</p>
<br>
<h2 id="step-0å¯åŠ¨æœåŠ¡å™¨">Step 0ï¼šå¯åŠ¨æœåŠ¡å™¨</h2>
<p>å¯åŠ¨æœåŠ¡å™¨ï¼Œè¯·æ‰“å¼€**ç»ˆç«¯ï¼ˆwindowså¯¹åº”çš„æ˜¯å‘½ä»¤è¡Œcmdï¼‰**å¹¶æŒ‰ç…§è¿™äº›è¯´æ˜è¿›è¡Œæ“ä½œã€‚</p>
<p>é¦–å…ˆï¼Œç»ˆç«¯ä¸­æ‰§è¡Œ<code>cd vector_demo</code>å°†å·¥ä½œç›®å½•åˆ‡æ¢ä¸º (cd) é¡¹ç›®æ–‡ä»¶å¤¹ <strong>vector_demo</strong>ã€‚</p>
<p>ç„¶åï¼Œç»ˆç«¯æ‰§è¡Œ<code>greppo serve app.py</code>, å¯åŠ¨æœåŠ¡å™¨ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/2.png" width="90%" />
    
    <figcaption><small><i>åœ¨å‘½ä»¤è¡Œä¸­å¯åŠ¨æœåŠ¡å™¨</i></small></figcaption>
</figure>
</div>
<p>ç„¶åï¼Œæ‚¨å°†çœ‹åˆ° Uvicorn æœåŠ¡å™¨åœ¨æŒ‡å®šä½ç½®ï¼ˆç±»ä¼¼äºé“¾æ¥ï¼‰è¿è¡Œã€‚ å¤åˆ¶ç½‘å€é“¾æ¥ï¼Œå¹¶å°†å…¶ç²˜è´´åˆ°æµè§ˆå™¨ä¸­ã€‚ ç„¶åå®ƒå°†åŠ è½½åº”ç”¨ç¨‹åºã€‚ å¦‚æœæ‚¨å¯¹ app.py è¿›è¡Œäº†ä»»ä½•æ›´æ”¹ï¼Œæ‚¨å°†åœ¨æµè§ˆå™¨é¡µé¢ä¸Šçœ‹åˆ°å¯¹æ‚¨çš„åº”ç”¨çš„æ›´æ–°æ›´æ”¹ã€‚</p>
<br>
<h2 id="step-1æ„å»ºåº”ç”¨ç¨‹åºçš„åŸºæœ¬è„šæ‰‹æ¶">Step 1ï¼šæ„å»ºåº”ç”¨ç¨‹åºçš„åŸºæœ¬è„šæ‰‹æ¶ã€‚</h2>
<p>å³å¯¼å…¥ greppo åŒ…ï¼Œå¹¶åœ¨åœ°å›¾ä¸­æ·»åŠ  base_layerã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="kn">from</span> <span class="nn">greppo</span> <span class="kn">import</span> <span class="n">app</span>

<span class="n">app</span><span class="o">.</span><span class="n">base_layer</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Open Street Map&#34;</span><span class="p">,</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://</span><span class="si">{s}</span><span class="s2">.tile.openstreetmap.org/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png&#34;</span><span class="p">,</span>
    <span class="n">subdomains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;(C) OpenStreetMap contributors&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">base_layer</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="s2">&#34;CartoDB Positron&#34;</span><span class="p">)</span>
</code></pre></div><p>æ‚¨éœ€è¦å…ˆä» greppo å¯¼å…¥åº”ç”¨ç¨‹åºã€‚ æ­¤åº”ç”¨ç¨‹åºå¯¹è±¡å°†ç”¨ä½œæ‚¨çš„åº”ç”¨ç¨‹åºå‰ç«¯çš„æ¥å£ï¼Œå¹¶ä¸ºå‰ç«¯å’Œåç«¯ä¹‹é—´çš„ 2 è·¯é€šä¿¡æä¾› APIã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/3.png" width="90%" />
    
    
</figure>
</div>
<p>è¦å°† base_layer æ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºåœ°å›¾ï¼Œåªéœ€ä½¿ç”¨å¸¦æœ‰æ‰€éœ€å‚æ•°çš„åº”ç”¨ç¨‹åº API æ–¹æ³• app.base_layer()ã€‚ è¯·<a href="https://docs.greppo.io/">å‚é˜…æ–‡æ¡£</a>ä»¥äº†è§£ä»€ä¹ˆæ˜¯å¿…éœ€çš„å’Œä»€ä¹ˆæ˜¯å¯é€‰çš„ã€‚ base_layer æ–¹æ³•æä¾›äº†ä¸¤ç§æ–¹æ³•æ¥æŒ‡å®šåŸºæœ¬ç“¦ç‰‡å±‚ã€‚ ä¸€ç§æ˜¯ä½¿ç”¨ name å’Œ url å±æ€§ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æä¾›è€…çš„åç§°ã€‚</p>
<br>
<h2 id="step-2å¯¼å…¥æ•°æ®é›†å¹¶å°†å…¶æ˜¾ç¤ºä¸ºå åŠ å±‚">Step 2ï¼šå¯¼å…¥æ•°æ®é›†å¹¶å°†å…¶æ˜¾ç¤ºä¸ºå åŠ å±‚ã€‚</h2>
<p>ä½¿ç”¨ geopandasï¼Œæˆ‘ä»¬å¯ä»¥å°†çŸ¢é‡æ•°æ®é›†ä½œä¸º GeoDataFrame å¯¼å…¥ã€‚ ç„¶åå¯ä»¥ä½¿ç”¨ app.vector_layer() æ–¹æ³•åœ¨ Web åº”ç”¨ç¨‹åºä¸Šçš„åœ°å›¾ä¸Šå¯¹å…¶è¿›è¡Œå¯è§†åŒ–ã€‚
åœ¨è¿™é‡Œï¼Œæˆ‘è¦å¯¼å…¥ä¸‰ä¸ªä¸åŒçš„æ•°æ®é›†ï¼Œæ¯ä¸ªæ•°æ®é›†éƒ½æœ‰å¤šè¾¹å½¢ï¼ˆæ„å¤§åˆ©ä¸åŒåœ°åŒºçš„è¾¹ç•Œï¼‰ã€çº¿ï¼ˆæ„å¤§åˆ©çš„ä¸»è¦é«˜é€Ÿå…¬è·¯ï¼‰å’Œç‚¹ï¼ˆæ„å¤§åˆ©çš„ä¸»è¦åŸå¸‚ï¼‰ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">greppo</span> <span class="kn">import</span> <span class="n">app</span>

<span class="n">regions</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./regions.geojson&#34;</span><span class="p">)</span>
<span class="n">roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./roads.geojson&#34;</span><span class="p">)</span>
<span class="n">cities</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./cities.geojson&#34;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">regions</span><span class="p">,</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Regions of Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Polygons showing the boundaries of regions of Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;fillColor&#34;</span><span class="p">:</span> <span class="s2">&#34;#4daf4a&#34;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">roads</span><span class="p">,</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Highways in Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Lines showing the major highways in Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;color&#34;</span><span class="p">:</span> <span class="s2">&#34;#377eb8&#34;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">cities</span><span class="p">,</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Cities of Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Points showing the cities in Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;color&#34;</span><span class="p">:</span> <span class="s2">&#34;#e41a1c&#34;</span><span class="p">},</span>
    <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div><p>ä½¿ç”¨æ–¹æ³• app.vector_layer() ä½œä¸ºå‰ç«¯çš„ APIï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºçŸ¢é‡æ•°æ®ã€‚ æ‚¨éœ€è¦ä¼ å…¥åç§°ï¼Œå…¶ä»–å‚æ•°æ˜¯å¯é€‰çš„ã€‚ è™½ç„¶ï¼Œå°†é¢œè‰²æˆ–å¡«å……é¢œè‰²ä¼ é€’ç»™æ ·å¼æ˜¯åŒºåˆ†å’Œè¯†åˆ«æ¯ä¸€å±‚çš„å¥½ä¹ æƒ¯ã€‚ ç”±äºå‰ç«¯åŸºäº Leafletï¼Œæ‰€æœ‰æ ·å¼éƒ½ç¬¦åˆ Leaflet çš„è§„èŒƒï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/4.png" width="100%" />
    
    
</figure>
</div>
<p>æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ° vector_layer å’Œæ ·å¼çš„æ‰€æœ‰ä¿¡æ¯ã€‚ æ³¨æ„ï¼šæ‚¨ä¹Ÿå¯ä»¥åˆ¶ä½œ Choropleth åœ°å›¾ã€‚ å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°å…¶æ–‡æ¡£ã€‚</p>
<br>
<h2 id="step-3æ˜¾ç¤ºåº”ç”¨å†…æ–‡æœ¬åº”ç”¨æ ‡é¢˜å’Œåº”ç”¨æè¿°">Step 3ï¼šæ˜¾ç¤ºåº”ç”¨å†…æ–‡æœ¬ã€åº”ç”¨æ ‡é¢˜å’Œåº”ç”¨æè¿°</h2>
<p>ä¸ºäº†ä½¿ Web åº”ç”¨ç¨‹åºæœ‰ç”¨ï¼Œå®ƒéœ€è¦æºå¸¦ä¸€äº›æ–‡æœ¬ä»¥å‘å…¶ç”¨æˆ·æä¾›ä¸€äº›æŒ‡å¯¼å’Œä¸Šä¸‹æ–‡ã€‚ è¿™äº›å¯ä»¥æ˜¾ç¤ºåœ¨ç»„ä»¶æ—è¾¹çš„ä¾§è¾¹æ ä¸Šã€‚ ä½¿ç”¨ app.display() æ–¹æ³•å¯ä»¥åœ¨ web-app ä¸Šæ˜¾ç¤ºé™ä»·æ–‡æœ¬ã€‚ ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œå¯ä»¥è®¾ç½®åº”ç”¨ç¨‹åºçš„æ ‡é¢˜å’Œæè¿°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">greppo</span> <span class="kn">import</span> <span class="n">app</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Vector demo&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;description&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="s1">&#39;A Greppo demo app for vector data using GeoJSON data.&#39;</span><span class="p">)</span>

<span class="n">text_1</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span><span class="s2">## About the web-app
</span><span class="s2">The dashboard shows the boundaries of the regions of Italy as polygons, 
</span><span class="s2">the major arterial higways as lines and the major cities of each region as points.
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;text-1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">text_1</span><span class="p">)</span>
</code></pre></div><p>app.display() æ¥å—ä¸¤ä¸ªå‚æ•° name å’Œ value ã€‚ è™½ç„¶ value æ‰¿è½½è¦æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œä½† name å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå¹¶å¸¦æœ‰æ–‡æœ¬çš„æ ‡è¯†ç¬¦ã€‚ å¦‚æœ name=&lsquo;title&rsquo; ä¼ é€’çš„å€¼æ˜¯åº”ç”¨ç¨‹åºçš„æ ‡é¢˜ï¼Œå¦‚æœ name=&lsquo;description&rsquo; ä¼ é€’çš„å€¼æ˜¯åº”ç”¨ç¨‹åºçš„æè¿°ã€‚ å¦‚æœæ²¡æœ‰è¿™ä¸¤è€…ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œè¯¥åº”ç”¨ç¨‹åºå°†å¸¦æœ‰å…¶é»˜è®¤æ ‡é¢˜å’Œæè¿°ã€‚ é¼“åŠ±è®¾ç½®åº”ç”¨ç¨‹åºçš„æ ‡é¢˜å’Œæè¿°ã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/5.png" width="100%" />
    
    
</figure>
</div>
<br>
<h2 id="step-4å°†æ•°æ®æ˜¾ç¤ºä¸ºå›¾è¡¨">Step 4ï¼šå°†æ•°æ®æ˜¾ç¤ºä¸ºå›¾è¡¨</h2>
<p>æ•°æ®åº”ç”¨ç¨‹åºå‡ ä¹æ²¡æœ‰å°†æ•°æ®æ˜¾ç¤ºä¸ºå›¾è¡¨ã€‚ Greppo è¿˜å…è®¸æ‚¨å°†æ•°æ®æ˜¾ç¤ºä¸ºå›¾è¡¨ã€‚ å¯ä»¥åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°æœ‰å…³å›¾è¡¨åŠå…¶ç”¨æ³•çš„ä¿¡æ¯ã€‚ è¿™é‡Œï¼Œä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº†ä¸€ä¸ªæ¡å½¢å›¾ï¼Œapp.bar_chart()ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">greppo</span> <span class="kn">import</span> <span class="n">app</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="n">regions</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./regions.geojson&#34;</span><span class="p">)</span>
<span class="n">roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./roads.geojson&#34;</span><span class="p">)</span>
<span class="n">cities</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./cities.geojson&#34;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;text-2&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="s1">&#39;The following displays the count of polygons, lines and points as a barchart.&#39;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">bar_chart</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Geometry count&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A bar-cart showing the count of each geometry-type in the datasets.&#39;</span><span class="p">,</span>
              <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;polygons&#39;</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="s1">&#39;points&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">roads</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cities</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#984ea3&#39;</span><span class="p">)</span>
</code></pre></div><p>å›¾è¡¨æ‰€éœ€çš„å‚æ•°æ˜¯åç§°ã€x å’Œ y å€¼ã€‚ å¯ä»¥æ·»åŠ æè¿°å’Œé¢œè‰²æ¥ä¸ºåº”ç”¨ç¨‹åºç”¨æˆ·æä¾›æ›´å¥½çš„ä¸Šä¸‹æ–‡ã€‚ åç§°å’Œæè¿°ä¸å›¾è¡¨ä¸€èµ·æ˜¾ç¤ºã€‚</p>
<div style="text-align: center;">
<figure >
    
        <img src="img/6.png" width="90%" />
    
    
</figure>
</div>
<br>
<h2 id="ç»“è®º">ç»“è®º</h2>
<p>è®©æˆ‘ä»¬å…¨é¢äº†è§£ä¸€ä¸‹æˆ‘ä»¬åœ¨è¿™é‡Œæ‰€åšçš„äº‹æƒ…ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿ç”¨ Greppo åˆ›å»ºä¸€ä¸ªåœ°ç†ç©ºé—´ web åº”ç”¨ç¨‹åºï¼Œä»¥æ˜¾ç¤ºä¸€äº› GIS çŸ¢é‡æ•°æ®ï¼Œå¹¶æ·»åŠ ç»„ä»¶ä»¥ä¸ºåº”ç”¨ç¨‹åºçš„ç”¨æˆ·æä¾›æ›´å¥½çš„ä¸Šä¸‹æ–‡ã€‚ è¿™æ˜¯è¯¥åº”ç”¨ç¨‹åºçš„å®Œæ•´ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">greppo</span> <span class="kn">import</span> <span class="n">app</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Vector demo&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;description&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="s1">&#39;A Greppo demo app for vector data using GeoJSON data.&#39;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">base_layer</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Open Street Map&#34;</span><span class="p">,</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://</span><span class="si">{s}</span><span class="s2">.tile.openstreetmap.org/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png&#34;</span><span class="p">,</span>
    <span class="n">subdomains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;(C) OpenStreetMap contributors&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">base_layer</span><span class="p">(</span>
    <span class="n">provider</span><span class="o">=</span><span class="s2">&#34;CartoDB Positron&#34;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">regions</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./regions.geojson&#34;</span><span class="p">)</span>
<span class="n">roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./roads.geojson&#34;</span><span class="p">)</span>
<span class="n">cities</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;./cities.geojson&#34;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Regions of Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&#34;Polygons showing the boundaries of regions of Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;fillColor&#34;</span><span class="p">:</span> <span class="s2">&#34;#4daf4a&#34;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">roads</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Highways in Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&#34;Lines showing the major highways in Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;color&#34;</span><span class="p">:</span> <span class="s2">&#34;#377eb8&#34;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">vector_layer</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">cities</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Cities of Italy&#34;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&#34;Points showing the cities in Italy.&#34;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;color&#34;</span><span class="p">:</span> <span class="s2">&#34;#e41a1c&#34;</span><span class="p">},</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">text_1</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span><span class="s2">## About the web-app
</span><span class="s2">
</span><span class="s2">The dashboard shows the boundaries of the regions of Italy as polygons, the 
</span><span class="s2">major arterial higways as lines and the major cities of each region as points.
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;text-1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">text_1</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;text-2&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="s1">&#39;The following displays the count of polygons, lines and points as a barchart.&#39;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">bar_chart</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Geometry count&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A bar-cart showing the count of each geometry-type in the datasets.&#39;</span><span class="p">,</span>
              <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;polygons&#39;</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="s1">&#39;points&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">roads</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cities</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#984ea3&#39;</span><span class="p">)</span>
</code></pre></div><p>è¿è¡Œæ•ˆæœå¦‚ä¸‹</p>
<div style="text-align: center;">
<figure >
    <a href="vector-demo.zip">
        <img src="img/1.gif" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»æœ¬å›¾ä¸‹è½½æœ¬æ–‡é¡¹ç›®ä»£ç </i></small></figcaption>
</figure>
</div>
<h2 id="ä¸‹è½½é¡¹ç›®æ•°æ®ä»£ç vector-demozip-1"><a href="vector-demo.zip">ä¸‹è½½é¡¹ç›®æ•°æ®ä»£ç </a></h2>
<p><br><br></p>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>PyCatFlowåº“|ç±»åˆ«æ•°æ®æ—¶é—´åºåˆ—å¯è§†åŒ–åº“</title>
      <link>https://hidadeng.github.io/blog/pycatflow/</link>
      <pubDate>Sun, 05 Dec 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/pycatflow/</guid>
      <description>å¤§å®¶çœ‹è¿‡äº†æ•°å€¼æ•°æ®éšæ—¶é—´å˜åŒ–çš„æ›²çº¿ï¼Œä½†æ˜¯ï¼Œå´é²œæœ‰å¯è§†åŒ–çš„å·¥å…·èƒ½å¾ˆå¥½åœ°å¯¹ç±»åˆ«ç‰¹å¾éšç€æ—¶é—´å˜åŒ–è¿›è¡Œç»˜åˆ¶ã€‚æœ¬æ–‡å°±ä»‹ç»ä¸€ç§å¾ˆå¥½çš„ç±»åˆ«ç‰¹å¾å¯è§†åŒ–å·¥å…·PyCatFlowï¼Œéå¸¸çš„ç®€å•ä¸”å®ç”¨ã€‚</description>
      <content:encoded><![CDATA[<p>å¤§å®¶çœ‹è¿‡äº†æ•°å€¼æ•°æ®éšæ—¶é—´å˜åŒ–çš„æ›²çº¿ï¼Œä½†æ˜¯ï¼Œå´é²œæœ‰å¯è§†åŒ–çš„å·¥å…·èƒ½å¾ˆå¥½åœ°å¯¹ç±»åˆ«ç‰¹å¾éšç€æ—¶é—´å˜åŒ–è¿›è¡Œç»˜åˆ¶ã€‚æœ¬æ–‡å°±ä»‹ç»ä¸€ç§å¾ˆå¥½çš„ç±»åˆ«ç‰¹å¾å¯è§†åŒ–å·¥å…·PyCatFlowï¼Œéå¸¸çš„ç®€å•ä¸”å®ç”¨ã€‚</p>
<h2 id="pycatflow">PyCatFlow</h2>
<p>PyCatFlow æ˜¯ä¸€ä¸ª Python åŒ…ï¼Œç”¨äºå¯è§†åŒ–<strong>ç±»åˆ«æ•°æ®çš„æ—¶é—´å˜åŒ–</strong>ã€‚å®ƒçš„çµæ„Ÿæ¥è‡ª Bernhard Rieder çš„å¯è§†åŒ–å·¥å…· <strong>RankFlow</strong>ï¼Œå®ƒå…è®¸å°†æ’ååˆ—è¡¨éšç€æ—¶é—´çš„æ¨ç§»è¿›è¡Œå¯è§†åŒ–ï¼Œä¾‹å¦‚ï¼ŒGoogle æˆ– YouTube ä¸ŠæŸ¥è¯¢çš„æœç´¢ç»“æœçš„å˜åŒ–ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œå°½ç®¡å®ƒçš„ç”¨æˆ·ç•Œé¢æç®€,RankFlow æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œè€Œä¸”æˆ‘å¾ˆéš¾ä¸ºå…¶å‡†å¤‡æ•°æ®ã€‚äº‹å®è¯æ˜ï¼Œè¿™äº›å›°éš¾ä¸»è¦æºäºâ€œæ»¥ç”¨â€RankFlowï¼Œæˆ–è€…ç”¨æ›´ç§¯æçš„æœ¯è¯­æ¥è¯´ï¼Œå®ƒæºäºå°† RankFlow ç”¨äºå…¶è®¾è®¡ç›®çš„ä»¥å¤–çš„å…¶ä»–ç›®çš„ã€‚</p>
<h2 id="èƒŒæ™¯äº†è§£rankflow">èƒŒæ™¯ï¼šäº†è§£RankFlow</h2>
<p>RankFlow å…è®¸æ¯”è¾ƒæ’ååˆ—è¡¨ï¼ˆéšç€æ—¶é—´çš„æ¨ç§»ï¼‰ã€‚ åœ¨æœ€ç®€å•çš„å½¢å¼ä¸­ï¼Œå®ƒéœ€è¦ä»¥æ¯åˆ—ä»£è¡¨ä¸€ä¸ªæ’ååˆ—è¡¨çš„æ–¹å¼æ’åˆ—è¡¨æ ¼æ•°æ®ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Time 1,Time 2,Time 3,Time 4
Item 1,Item 1,Item 1,Item 2
Item 2,Item 4,Item 2,Item 1
Item 3,Item 2,Item 4,Item 4
Item 4,Item 3,Item 5,Item 5
</code></pre></div><p>æ¯ä¸ªæ’ååˆ—è¡¨éƒ½å¯ä»¥é€šè¿‡æƒé‡è¿›è¡Œè¡¥å……ï¼Œä»è€Œä¸ºæ•°æ®æ·»åŠ å¦ä¸€å±‚ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬é‡‡ç”¨ YouTube æœç´¢ç»“æœæ•°æ®ï¼Œåˆ™å¯ä»¥å°†è§‚çœ‹æ¬¡æ•°ã€èµæˆç¥¨æ•°æˆ–èµæˆç¥¨åå¯¹ç‡ç”¨ä½œæƒé‡ä¿¡æ¯ã€‚ ä¸ºç®€å•èµ·è§ï¼Œç¤ºä¾‹æ•°æ®ä»…ç”±æ’ååˆ—è¡¨ç»„æˆï¼Œå¹¶åœ¨ä»¥ä¸‹æµç¨‹å›¾ä¸­æ˜¾ç¤ºç»“æœã€‚</p>

<figure >
    
        <img src="img/rankflow.png" width="800" />
    
    
</figure>

<p>ä¸ºäº†åŠ å¿«å›¾è¡¨çš„åå¤„ç†é€Ÿåº¦ï¼Œæˆ‘å†³å®šåˆ›å»ºä¸€ä¸ªç±»ä¼¼äº RankFlow çš„å¯è§†åŒ–å·¥å…·ï¼Œå®ƒéå¸¸é€‚åˆä¸åŒ…å«æ˜¾å¼æ’åä¿¡æ¯ä½†å¯èƒ½åŒ…å«é¢å¤–åˆ†ç±»æ•°æ®çš„æ—¶é—´æ•°æ®ã€‚</p>
<h2 id="pycatflowå¿«é€Ÿä¸Šæ‰‹">PyCatFlowå¿«é€Ÿä¸Šæ‰‹</h2>

<figure >
    
        <img src="img/sample_viz.png" width="800" />
    
    
</figure>

<p>å¦‚æœæˆ‘ä»¬ç”¨ä¸¤ç§ä¸åŒé¢œè‰²ï¼Œç°è‰²å’Œç»¿è‰²åˆ†åˆ«è¡¨ç¤ºç”·ç”Ÿå’Œå¥³ç”Ÿï¼Œç„¶åæ¯ä¸€ä¸ªæ ¼å­è¡¨ç¤ºä¸€ç±»ç”µå½±ï¼Œæ¨ªè½´æ˜¯ç”·ç”Ÿå’Œå¥³ç”Ÿéšç€æ—¶é—´æ¨ç§»çœ‹çš„ä¸åŒçš„ç”µå½±ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸€ç›®äº†ç„¶ç”·ç”Ÿå’Œå¥³ç”Ÿçš„å–œå¥½çš„å˜åŒ–ï¼ŒçœŸçš„æ˜¯å¤ªç›´è§‚äº†ï¼
PyCatFlowå¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬å¯¹äºç±»åˆ«ç‰¹å¾éšç€æ—¶é—´å˜åŒ–çš„åˆ†æã€‚</p>
<p><strong>å‡†å¤‡æ•°æ®</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;data/sample_data_ChatterBot_Requirements.csv&#34;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">column</th>
<th style="text-align:left">items</th>
<th style="text-align:left">category</th>
<th style="text-align:right">column order</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">2015-09-08</td>
<td style="text-align:left">fuzzywuzzy</td>
<td style="text-align:left">A_Requirements</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">2015-09-08</td>
<td style="text-align:left">requests</td>
<td style="text-align:left">A_Requirements</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">2015-09-08</td>
<td style="text-align:left">requests-oauthlib</td>
<td style="text-align:left">A_Requirements</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">2015-09-08</td>
<td style="text-align:left">pymongo</td>
<td style="text-align:left">A_Requirements</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">2015-09-08</td>
<td style="text-align:left">jsondatabase</td>
<td style="text-align:left">A_Requirements</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pycatflow</span> <span class="k">as</span> <span class="nn">pcf</span>

<span class="c1"># Load and parse data from file</span>
<span class="n">fname</span><span class="o">=</span><span class="s2">&#34;data/sample_data_ChatterBot_Requirements.csv&#34;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pcf</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&#34;column&#34;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="s2">&#34;items&#34;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="s2">&#34;category&#34;</span><span class="p">,</span> <span class="n">column_order</span><span class="o">=</span><span class="s2">&#34;column order&#34;</span><span class="p">)</span>

<span class="s1">&#39;&#39;&#39;
</span><span class="s1">visualize(data, spacing=50, node_size=10, width=None, height=None, minValue=1, maxValue=10, node_scaling=&#34;linear&#34;,
</span><span class="s1">          connection_type=&#34;semi-curved&#34;, color_startEnd=True, color_categories=True, nodes_color=&#34;gray&#34;,
</span><span class="s1">          start_node_color=&#34;green&#34;, end_node_color=&#34;red&#34;, palette=None, show_labels=True,
</span><span class="s1">          label_text=&#34;item&#34;, label_font=&#34;sans-serif&#34;, label_color=&#34;black&#34;, label_size=5,
</span><span class="s1">          label_shortening=&#34;clip&#34;, label_position=&#34;nodes&#34;, line_opacity=0.5, line_stroke_color=&#34;white&#34;,
</span><span class="s1">          line_stroke_width=0.5, line_stroke_thick=0.5, legend=True, sort_by=&#34;frequency&#34;)
</span><span class="s1">&#39;&#39;&#39;</span>

<span class="n">viz</span> <span class="o">=</span> <span class="n">pcf</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">maxValue</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">minValue</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#save visualization to files</span>
<span class="n">viz</span><span class="o">.</span><span class="n">savePng</span><span class="p">(</span><span class="s1">&#39;sample_viz.png&#39;</span><span class="p">)</span>
<span class="n">viz</span><span class="o">.</span><span class="n">saveSvg</span><span class="p">(</span><span class="s1">&#39;sample_viz.svg&#39;</span><span class="p">)</span>

<span class="c1">#show visualization</span>
<span class="n">viz</span>
</code></pre></div>
<figure >
    
        <img src="img/1.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Another option is to visualize the graph with curved connections.</span>
<span class="c1"># The implementation of this connection type draws on https://github.com/bernorieder/RankFlow</span>

<span class="n">viz</span> <span class="o">=</span> <span class="n">pcf</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">maxValue</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">minValue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">connection_type</span><span class="o">=</span><span class="s1">&#39;curved&#39;</span><span class="p">)</span>
<span class="n">viz</span>
</code></pre></div>
<figure >
    
        <img src="img/2.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The third option are straight connections between nodes</span>
<span class="n">viz</span> <span class="o">=</span> <span class="n">pcf</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">maxValue</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">minValue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">connection_type</span><span class="o">=</span><span class="s1">&#39;straight&#39;</span><span class="p">)</span>

<span class="c1"># show visualization</span>
<span class="n">viz</span>
</code></pre></div>
<figure >
    
        <img src="img/3.png" width="800" />
    
    
</figure>

<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/bumatic/PyCatFlow">https://github.com/bumatic/PyCatFlow</a></p>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ç§‘å­¦ç»˜å›¾matplotlib</title>
      <link>https://hidadeng.github.io/blog/sci_matplotlib/</link>
      <pubDate>Wed, 24 Nov 2021 22:40:10 +0600</pubDate>
      
      <guid>/blog/sci_matplotlib/</guid>
      <description>å­—æ®µä¸°å¯Œï¼Œé€‚åˆç©æ•°æ®åˆ†æ</description>
      <content:encoded><![CDATA[<p>Python ç§‘å­¦å¯è§†åŒ–é¢†åŸŸæ˜¯å·¨å¤§çš„ï¼Œç”±æ— æ•°å·¥å…·ç»„æˆï¼Œä»æœ€é€šç”¨å’Œæœ€å¹¿æ³›ä½¿ç”¨çš„å·¥å…·åˆ°æ›´ä¸“ä¸šå’Œæœºå¯†çš„å·¥å…·ã€‚å…¶ä¸­ä¸€äº›å·¥å…·æ˜¯åŸºäºç¤¾åŒºçš„ï¼Œè€Œå¦ä¸€äº›åˆ™æ˜¯ç”±å…¬å¸å¼€å‘çš„ã€‚æœ‰äº›æ˜¯ä¸“é—¨ä¸º Web åˆ¶ä½œçš„ï¼Œæœ‰äº›ä»…é€‚ç”¨äºæ¡Œé¢ï¼Œæœ‰äº›å¤„ç† 3D å’Œå¤§æ•°æ®ï¼Œè€Œæœ‰äº›åˆ™é’ˆå¯¹å®Œç¾çš„ 2D æ¸²æŸ“ã€‚</p>
<p>åœ¨è¿™ä¸ªå›¾æ™¯ä¸­ï¼ŒMatplotlib æœ‰ç€éå¸¸ç‰¹åˆ«çš„åœ°æ–¹ã€‚</p>
<ul>
<li>å®ƒæ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½ä¸”åŠŸèƒ½å¼ºå¤§çš„åº“ï¼Œå¯è®©æ‚¨è®¾è®¡éå¸¸é«˜è´¨é‡çš„å›¾å½¢ï¼Œé€‚ç”¨äº<strong>ç§‘å­¦å‡ºç‰ˆ</strong>ã€‚</li>
<li>å®ƒè¿˜æä¾›äº†ä¸€ä¸ªç®€å•ç›´è§‚çš„ç•Œé¢ä»¥åŠä¸€ä¸ªé¢å‘å¯¹è±¡çš„æ¶æ„ï¼Œå…è®¸æ‚¨è°ƒæ•´å›¾å½¢ä¸­çš„ä»»ä½•å†…å®¹ã€‚</li>
<li>æœ€åï¼Œå®ƒå¯ä»¥ç”¨ä½œå¸¸è§„å›¾å½¢åº“ä»¥è®¾è®¡éç§‘å­¦å›¾å½¢ã€‚</li>
</ul>
<br>
<h2 id="æœ¬ä¹¦ç« èŠ‚å››ä¸ªéƒ¨åˆ†">æœ¬ä¹¦ç« èŠ‚å››ä¸ªéƒ¨åˆ†</h2>
<ul>
<li>
<p>ç¬¬ä¸€éƒ¨åˆ† Matplotlib åº“çš„åŸºæœ¬åŸç†ã€‚</p>
<p>è¿™åŒ…æ‹¬å›é¡¾æ„æˆå›¾å½¢çš„ä¸åŒéƒ¨åˆ†ã€ä¸åŒçš„åæ ‡ç³»ã€å¯ç”¨çš„æ¯”ä¾‹å’ŒæŠ•å½±ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»ä¸€äº›ä¸æ’ç‰ˆå’Œé¢œè‰²ç›¸å…³çš„æ¦‚å¿µã€‚</p>
</li>
<li>
<p>ç¬¬äºŒéƒ¨åˆ† å›¾å½¢æ¶‰åŠå®è·µã€‚</p>
<p>åœ¨ä»‹ç»äº†ä¸€äº›ç”Ÿæˆæ›´å¥½å›¾å½¢çš„ç®€å•è§„åˆ™ä¹‹åï¼Œæˆ‘ä»¬å°†ç»§ç»­è§£é‡Š Matplotlib é»˜è®¤å€¼å’Œæ ·å¼ç³»ç»Ÿï¼Œç„¶åå†æ·±å…¥ç ”ç©¶å›¾å½¢å¸ƒå±€ç»„ç»‡ã€‚ç„¶åæˆ‘ä»¬å°†æ¢ç´¢å¯ç”¨çš„ä¸åŒç±»å‹çš„æƒ…èŠ‚ï¼Œçœ‹çœ‹å¦‚ä½•ç”¨ä¸åŒçš„å…ƒç´ è£…é¥°ä¸€ä¸ªäººç‰©ã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰éƒ¨åˆ† æ›´é«˜çº§çš„æ¦‚å¿µ</p>
<p>å³ 3D å›¾å½¢ã€ä¼˜åŒ–å’ŒåŠ¨ç”»ã€‚ç¬¬å››éƒ¨åˆ†ä¹Ÿæ˜¯æœ€åä¸€éƒ¨åˆ†æ˜¯å±•ç¤ºé›†åˆã€‚</p>
</li>
</ul>
<br>
<h2 id="ç¾å›¾å±•è§ˆ">ç¾å›¾å±•è§ˆ</h2>
<p>
<figure >
    
        <img src="img/1.png" width="800" />
    
    
</figure>


<figure >
    
        <img src="img/2.png" width="800" />
    
    
</figure>


<figure >
    
        <img src="img/3.png" width="800" />
    
    
</figure>
</p>
<br>
<h2 id="æ¡ˆä¾‹ä»£ç ">æ¡ˆä¾‹ä»£ç </h2>

<figure >
    
        <img src="img/matplotlib.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.textpath</span> <span class="kn">import</span> <span class="n">TextPath</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">PathPatch</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PolyCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">font_manager</span> <span class="k">as</span> <span class="n">fm</span><span class="p">,</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1">#æ›´æ”¹å­—ä½“ï¼Œæ”¯æŒä¸­æ–‡ã€‚</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;fonts/Alibaba-PuHuiTi-Bold.otf&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">red</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">233</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">darkred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">130</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">14.8</span> <span class="o">/</span> <span class="mf">2.54</span><span class="p">,</span> <span class="mi">21</span> <span class="o">/</span> <span class="mf">2.54</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">14.2</span><span class="p">,</span> <span class="mf">14.2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&#34;off&#34;</span><span class="p">)</span>

<span class="c1"># Text path</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">TextPath</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&#34;MATPLOTLIBåº“&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">)</span>

<span class="c1"># Text centering</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">V</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">V</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">V</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">V</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">V</span> <span class="o">-=</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">+</span> <span class="n">xmax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">+</span> <span class="n">ymax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>


<span class="c1"># Compute shadow by iterating over text path segments</span>
<span class="n">polys</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">iter_segments</span><span class="p">(</span><span class="n">curves</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">:</span>
        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">:</span>
        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">:</span>
        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">polys</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p1</span> <span class="o">+</span> <span class="p">(</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span> <span class="n">p0</span> <span class="o">+</span> <span class="p">(</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">)])</span>

<span class="c1"># Display shadow</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">PolyCollection</span><span class="p">(</span>
    <span class="n">polys</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">darkred</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">10</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>

<span class="c1"># Display text</span>
<span class="n">patch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&#34;white&#34;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&#34;none&#34;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>

<span class="c1"># Transparent gradient to fade out shadow</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="n">red</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">I</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">6.5</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.75</span><span class="p">,</span>
    <span class="s2">&#34;ä¸€ä¸ªå¤šåŠŸèƒ½çš„ç§‘å­¦å¯è§†åŒ–åº“&#34;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&#34;white&#34;</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s2">&#34;right&#34;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s2">&#34;baseline&#34;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="c1">#family=&#34;Pacifico&#34;,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">fontproperties</span><span class="o">=</span><span class="n">prop</span>
<span class="p">)</span>

<span class="c1"># Save and show result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&#34;text-shadow.pdf&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&#34;text-shadow.png&#34;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><br>
<h2 id="ç”µå­ä¹¦ä¸‹è½½">ç”µå­ä¹¦ä¸‹è½½</h2>
<p>æ‚¨å¯ä»¥é˜…è¯» PDFï¼ˆ95Moï¼Œé¦–é€‰ç«™ç‚¹ï¼‰è¿™æœ¬ä¹¦ï¼Œè¯¥ä¹¦æ˜¯å¼€æ”¾è®¿é—®çš„ï¼Œæ‰˜ç®¡åœ¨ HAL ä¸Šï¼ŒHAL æ˜¯ä¸€ä¸ªé¢å‘å­¦æœ¯ç•Œçš„æ³•å›½å¼€æ”¾æ¡£æ¡ˆé¦†ã€‚æœ€æ–°ç‰ˆæœ¬ä¹Ÿå¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°ã€‚æœ¬ä¹¦çš„æ¥æºï¼ˆåŒ…æ‹¬ä»£ç ç¤ºä¾‹ï¼‰å¯åœ¨ github.com/rougier/scientific-visualization-book ä¸Šæ‰¾åˆ°ã€‚</p>
<br>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hiDaDeng/DaDengAndHisPython/tree/master/matplotlib%E7%BB%98%E5%9B%BE%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87">ç‚¹å‡»ä¸‹è½½</a></p>
<br>
<p>##äº†è§£è¯¾ç¨‹</p>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>åœ¨Rmarkdownä¸­è°ƒç”¨Pythonä»£ç </title>
      <link>https://hidadeng.github.io/blog/call_python_code_in_rmarkdown/</link>
      <pubDate>Tue, 23 Nov 2021 18:40:10 +0600</pubDate>
      
      <guid>/blog/call_python_code_in_rmarkdown/</guid>
      <description>å·¦æ‰‹Rï¼Œå³æ‰‹Pythonï¼</description>
      <content:encoded><![CDATA[<h1 id="rpy2ç®€ä»‹">rpy2ç®€ä»‹</h1>
<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/%E5%9C%A8Rmarkdown%E4%B8%AD%E8%B0%83%E7%94%A8Python%E4%BB%A3%E7%A0%81.zip">ç‚¹å‡»ä¸‹è½½æ–‡æœ¬</a></p>
<br>
<p>Pythonå’ŒRæ˜¯ä¸€å¯¹æ•°æ®ç§‘å­¦ä¸¤å¤§è¯­è¨€ï¼Œåœ¨äº’è”äº’é€šçš„è·¯ä¸Šï¼Œæˆ‘æ„Ÿè§‰Ræ›´åŠ çš„ç§¯æã€‚è¿˜è®°å¾—ä¹‹å‰ <strong>Pythonä¸­è°ƒç”¨Rçš„åº“-rpy2</strong>ï¼Œ åœ¨Pythonä½¿ç”¨Rè¯­è¨€è¯­æ³•è¿˜æ˜¯æœ‰äº›ä¸è‡ªç„¶ã€‚åœ¨Rä¸­è°ƒç”¨Pythonä½“éªŒååˆ†æ£’ï¼Œä¸€èµ·è·Ÿæˆ‘çœ‹çœ‹å§ã€‚</p>
<p>reticulateåŒ…æ˜¯å¯ä»¥è®©Rè¯­è¨€éå¸¸æµç•…è‡ªç„¶è”é€šPythonçš„å…³é”®ã€‚</p>
<p><strong>Rmarkdowné¢„å¤‡çŸ¥è¯†</strong></p>
<p>Rmarkdownå¾ˆåƒjupyter notbeookå’Œmarkdownçš„ç»“åˆã€‚</p>
<ul>
<li>ä»£ç å—</li>
<li>markdonæ–‡æœ¬</li>
</ul>
<br>
<h2 id="ä»£ç å—">ä»£ç å—</h2>
<p>åœ¨Rmarkdownä¸­çš„ä»£ç å—çš„å¼€å§‹éƒ½æ˜¯ä»¥ä¸‰å¼•å·ã€{}å’Œè¯­è¨€åä¸ºæ ‡å¿—ï¼Œä»¥ä¸‰å¼•å·ç»“å°¾ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">library(ggplot2)
ggplot(mpg, aes(x=displ, y=cty))+
  geom_point()
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">displ</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cty</span><span class="p">))</span><span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/unnamed-chunk-1-1.png" width="100%" />
    
    
</figure>

<p>åé¢è®¾ç½®å¥½reticulateåŒ…åï¼Œå°±å¯ä»¥åœ¨Rmarkdownä¸­ä½¿ç”¨pythonä»£ç å—ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">import pandas as pd
df = pd.read_csv(&#39;test.csv&#39;)
df.head()
</code></pre></div><br>
<h2 id="markdownæ–‡æœ¬">markdownæ–‡æœ¬</h2>
<p>æ–‡æœ¬éƒ¨åˆ†å…¨éƒ¨æ”¯æŒmarkdownè¯­æ³•ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚</p>
<h2 id="å®‰è£…rpy">å®‰è£…rpy</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">install.packages(&#34;reticulate&#34;)
</code></pre></div><h2 id="ç¯å¢ƒè®¾ç½®">ç¯å¢ƒè®¾ç½®</h2>
<p>å½“æˆ‘ä»¬åœ¨Rä»£ç å—ä¸­è®¾ç½®å¥½Pythonç¯å¢ƒï¼Œå°±å¯ä»¥åœ¨Rmarkdownä¸­è·‘Pythonä»£ç ã€‚</p>
<br>
<h2 id="æŸ¥è¯¢python">æŸ¥è¯¢Python</h2>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“Pythonå®‰è£…è·¯å¾„ï¼Œå¯ä»¥åœ¨<strong>å‘½ä»¤è¡Œ</strong>ä¸­é€è¡Œæ‰§è¡Œä¸‹é¢ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">python3
import sys
sys.executable
</code></pre></div><p>æˆ‘çš„macç”µè„‘çš„Pythonå®‰è£…è·¯å¾„ä¸º</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">/Library/Frameworks/Python.framework/Versions/3.7/bin/python3
</code></pre></div><br>
<h2 id="æŒ‡å®špython">æŒ‡å®šPython</h2>
<p>æ‰§è¡Œä¸‹æ–¹çš„ä»£ç (è·¯å¾„æ”¹ä¸ºè‡ªå·±çš„Pythonå®‰è£…è·¯å¾„)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="err">##</span> <span class="nx">Warning</span><span class="p">:</span> <span class="kn">package</span> <span class="err">&#39;</span><span class="nx">reticulate</span><span class="err">&#39;</span> <span class="nx">was</span> <span class="nx">built</span> <span class="nx">under</span> <span class="nx">R</span> <span class="nx">version</span> <span class="mf">3.6.2</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">use_python</span><span class="p">(</span><span class="s">&#39;/Library/Frameworks/Python.framework/Versions/3.7/bin/python3&#39;</span><span class="p">)</span>
</code></pre></div><p>æ‰§è¡Œä»£ç åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨Pythonä»£ç </p>
<br>
<h1 id="è¿è¡Œpythonä»£ç ">è¿è¡ŒPythonä»£ç </h1>
<p>åœ¨Rmarkdownä¸­å†™Pythonä»£ç å—</p>
<h2 id="ä½œå›¾">ä½œå›¾</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="c1"># è®¡ç®—æ­£å¼¦æ›²çº¿ä¸Šç‚¹çš„ x å’Œ y åæ ‡</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">3</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;sine wave form&#34;</span><span class="p">)</span>  
<span class="c1"># ä½¿ç”¨ matplotlib æ¥ç»˜åˆ¶ç‚¹</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/unnamed-chunk-3-1.png" width="100%" />
    
    
</figure>

<br>
<h2 id="è¯»å–csv">è¯»å–csv</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;test.csv&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;gbk&#34;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">##      birthday   name               text  age  gender  height  weight
## 0  1985/10/08  Alice  æˆ‘å¾ˆå¼€å¿ƒï¼Œæ¯å¤©éƒ½è¿™ä¹ˆå¿«ä¹ï¼Œæˆ‘å¾ˆå¹¸ç¦   35  female     175      55
## 1    95.07.07   Mary               æˆ‘å¾ˆéš¾è¿‡   25  female     165      50
## 2    01-11-10   Mike              å”‰ï¼ŒçœŸéš¾å—   19    male     180      75
## 3      90/2/8  Smith          æ— æ‰€è°“å¼€å¿ƒè¿˜æ˜¯éš¾è¿‡   30    male     175      70
## 4      93-1-5  Henry          æ¯å¤©èµšä¸€ä¸‡ï¼ŒçœŸçˆ½ï¼   27    male     185      80
</code></pre></div><p>è¿”å›çš„dfæ˜¯Pythonå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¡¨æ ¼ä¸å¥½çœ‹ï¼Œè¿™æ˜¯Rä¸­çš„Pythonå¯¹è±¡ã€‚</p>
<br>
<h2 id="åœ¨rä»£ç å—ä¸­è°ƒç”¨pythonå˜é‡å¯¹è±¡">åœ¨Rä»£ç å—ä¸­è°ƒç”¨Pythonå˜é‡(å¯¹è±¡)</h2>
<p>åˆšåˆšè®²çš„éƒ½æ˜¯åœ¨Rmakdownä¸­è¿è¡ŒPythonä»£ç å—ï¼Œå¹¶ä¸æ˜¯åœ¨Rä»£ç å—ä¸­è¿è¡ŒPythonä»£ç æˆ–è€…è°ƒç”¨Pythonå˜é‡ã€‚</p>
<h3 id="pypython_variable_name">py$python_variable_name</h3>
<p>Rä»£ç å—ä¸­è°ƒç”¨Pythonæ–¹æ³•</p>
<p>py$python_variable_name</p>
<ul>
<li>pyç›¸å½“äºPythonä¸­çš„å¯¹è±¡</li>
<li>$ ç›¸å½“äºPythonä¸­çš„<strong>ç‚¹</strong></li>
<li>python_variable_name æ˜¯Pythonä»£ç å—ä¸­çš„å˜é‡å</li>
</ul>
<p>æ¯”å¦‚åœ¨ä¸Šæ–‡ä¸­Pythonçš„å˜é‡dfï¼Œåœ¨Rä¸­è°ƒç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="n">py</span><span class="o">$</span><span class="n">df</span>
</code></pre></div>
<figure >
    
        <img src="img/df.png" width="100%" />
    
    
</figure>

<p>ç°åœ¨è°ƒç”¨Pythonå¯¹è±¡dfæ—¶ï¼ŒRä¼šé»˜è®¤å°†å…¶è½¬ä¸ºRå¯¹è±¡ï¼Œæ‰€ä»¥å†…å®¹ä¸€æ ·ï¼Œæ ·å¼ä¼¼ä¹å˜å¥½çœ‹äº†ã€‚</p>
<h3 id="rä»£ç å—ä¸­å¯¼å…¥pythonåº“">Rä»£ç å—ä¸­å¯¼å…¥Pythonåº“</h3>
<p>ä½¿ç”¨osåº“çš„listdirå‡½æ•°æŸ¥è¯¢å½“å‰é¡¹ç›®æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶åˆ—è¡¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">## [&#39;reticulateå­¦ä¹ .md&#39;, &#39;test.csv&#39;, &#39;test.py&#39;, &#39;reticulateå­¦ä¹ .html&#39;, &#39;reticulateå­¦ä¹ _files&#39;, &#39;reticulate.pdf&#39;, &#39;reticulateå­¦ä¹ .Rmd&#39;, &#39;data.py&#39;]
</code></pre></div><p>åœ¨Rä»£ç å—ä¸­å®ç°ä¸Šæ–¹çš„PythonåŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼Œå¾ˆç®€å•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>

<span class="c1">#å¯¼å…¥åº“</span>
<span class="n">os</span> <span class="o">&lt;-</span> <span class="nf">import</span><span class="p">(</span><span class="s">&#34;os&#34;</span><span class="p">)</span>

<span class="c1">#osåº“çš„listdirå‡½æ•°</span>
<span class="n">os</span><span class="o">$</span><span class="nf">listdir</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">## [1] &#34;reticulateå­¦ä¹ .md&#34;    &#34;test.csv&#34;             &#34;test.py&#34;             
## [4] &#34;reticulateå­¦ä¹ .html&#34;  &#34;reticulateå­¦ä¹ _files&#34; &#34;reticulate.pdf&#34;      
## [7] &#34;reticulateå­¦ä¹ .Rmd&#34;   &#34;data.py&#34;
</code></pre></div><p>å¯ä»¥å‘ç°</p>
<ul>
<li><code>import(&quot;os)</code>ä»£æ›¿äº†<code>import os</code></li>
<li><code>$</code>ä»£æ›¿äº†<code>.</code></li>
<li><code>&lt;-</code> ä»£æ›¿äº† <code>=</code></li>
</ul>
<p>å†ç†Ÿæ‚‰ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
<span class="n">pd</span> <span class="o">&lt;-</span> <span class="nf">import</span><span class="p">(</span><span class="s">&#34;pandas&#34;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">&lt;-</span> <span class="n">pd</span><span class="o">$</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;test.csv&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#34;gbk&#34;</span><span class="p">)</span>
<span class="n">df2</span>
</code></pre></div>
<figure >
    
        <img src="img/df2.png" width="100%" />
    
    
</figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨Rä»£ç å—ä¸­æ‰§è¡ŒPythonä»£ç æ—¶ï¼Œé»˜è®¤ä¼šå°†Pythonå¯¹è±¡è½¬ä¸ºRå¯¹è±¡ã€‚</p>
<h3 id="source_python">source_python()</h3>
<p>ä½¿ç”¨reticulateåŒ…ä¸­çš„source_python(&lsquo;pyæ–‡ä»¶è·¯å¾„&rsquo;)å¯ä»¥å¯¼å…¥pyæ–‡ä»¶ä¸­çš„å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨Rä»£ç å—ä¸­ä½¿ç”¨å¤–éƒ¨å˜é‡ã€‚ä¾‹å¦‚æˆ‘åœ¨data.pyä¸­å‡†å¤‡Aå’ŒBä¸¤ä¸ªå­—ç¬¦ä¸²</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">A = &#39;æˆ‘æ˜¯å¼ ä¸‰,&#39;
B = &#39;æ¥è‡ªæ²³åŒ—&#39;
</code></pre></div><p>åœ¨Rä»£ç å—ä¸­è¿è¡Œdata.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>

<span class="nf">source_python</span><span class="p">(</span><span class="s">&#34;data.py&#34;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">## [1] &#34;æˆ‘æ˜¯å¼ ä¸‰,&#34;
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">## [1] &#34;æ¥è‡ªæ²³åŒ—&#34;
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">paste0</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">## [1] &#34;æˆ‘æ˜¯å¼ ä¸‰,æ¥è‡ªæ²³åŒ—&#34;
</code></pre></div><h2 id="py_run_file">py_run_file()</h2>
<p>åœ¨Rä»£ç å—ä¸­è¿è¡Œé¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„test.pyæ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
<span class="nf">py_run_file</span><span class="p">(</span><span class="s">&#34;test.py&#34;</span><span class="p">)</span>
</code></pre></div><h1 id="æ•°æ®ç±»å‹å¯¹æ¯”">æ•°æ®ç±»å‹å¯¹æ¯”</h1>
<table>
<thead>
<tr>
<th>R</th>
<th>Python</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single-element vector</td>
<td>Scalar</td>
<td><code>1</code>, <code>1L</code>, <code>TRUE</code>, <code>&quot;foo&quot;</code></td>
</tr>
<tr>
<td>Multi-element vector</td>
<td>List</td>
<td><code>c(1.0, 2.0, 3.0)</code>, <code>c(1L, 2L, 3L)</code></td>
</tr>
<tr>
<td>List of multiple types</td>
<td>Tuple</td>
<td><code>list(1L, TRUE, &quot;foo&quot;)</code></td>
</tr>
<tr>
<td>Named list</td>
<td>Dict</td>
<td><code>list(a = 1L, b = 2.0)</code>, <code>dict(x = x_data)</code></td>
</tr>
<tr>
<td>Matrix/Array</td>
<td>NumPy ndarray</td>
<td><code>matrix(c(1,2,3,4), nrow = 2, ncol = 2)</code></td>
</tr>
<tr>
<td>Data Frame</td>
<td>Pandas DataFrame</td>
<td><code>data.frame(x = c(1,2,3), y = c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;))</code></td>
</tr>
<tr>
<td>Function</td>
<td>Python function</td>
<td><code>function(x) x + 1</code></td>
</tr>
<tr>
<td>NULL, TRUE, FALSE</td>
<td>None, True, False</td>
<td><code>NULL</code>, <code>TRUE</code>, <code>FALSE</code></td>
</tr>
</tbody>
</table>
<br>
<h1 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h1>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ç§‘ç ”ç»˜å›¾SciencePlotsåº“</title>
      <link>https://hidadeng.github.io/blog/scienceplots/</link>
      <pubDate>Tue, 23 Nov 2021 18:40:10 +0600</pubDate>
      
      <guid>/blog/scienceplots/</guid>
      <description>ç§‘ç ”å¯è§†åŒ–ç»˜å›¾åŒ…</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/SciencePlot%E7%A7%91%E7%A0%94%E7%BB%98%E5%9B%BE.zip">https://github.com/hidadeng/DaDengAndHisPython/blob/master/SciencePlotç§‘ç ”ç»˜å›¾.zip</a></p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">SciencePlots</span>

</code></pre></div><pre><code>Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple/
Collecting SciencePlots
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c2/44/7b5c0ecd6f2862671a076425546f86ac540bc48c1a618a82d6faa3b26f58/SciencePlots-1.0.9.tar.gz (10 kB)
  Installing build dependencies ... [?25l/
</code></pre>
<p><strong>tips</strong>:</p>
<p>SciencePlotsåº“éœ€è¦ç”µè„‘å®‰è£…LaTexï¼Œå…¶ä¸­</p>
<ul>
<li>MacOSç”µè„‘å®‰è£…MacTex  <a href="https://www.tug.org/mactex/">https://www.tug.org/mactex/</a></li>
<li>Windowsç”µè„‘å®‰è£…MikTex  <a href="https://miktex.org/">https://miktex.org/</a></li>
</ul>
<h2 id="åˆå§‹åŒ–ç»˜å›¾æ ·å¼">åˆå§‹åŒ–ç»˜å›¾æ ·å¼</h2>
<p>åœ¨SciencePlotsåº“ä¸­ç§‘ç ”ç»˜å›¾æ ·å¼éƒ½æ˜¯ç”¨çš„science</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;science&#39;</span><span class="p">)</span>
</code></pre></div><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥åŒæ—¶è®¾ç½®å¤šä¸ªæ ·å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;ieee&#39;</span><span class="p">])</span>
</code></pre></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ <strong>ieee</strong> ä¼šè¦†ç›–æ‰ <strong>science</strong> ä¸­çš„æŸäº›å‚æ•°ï¼ˆåˆ—å®½ã€å­—å·ç­‰ï¼‰ï¼Œ ä»¥è¾¾åˆ°ç¬¦åˆ <strong>IEEE</strong>è®ºæ–‡çš„ç»˜å›¾è¦æ±‚</p>
<p>å¦‚æœè¦ä¸´æ—¶ä½¿ç”¨æŸç§ç»˜å›¾æ ·å¼ï¼Œç§‘ç ”ä½¿ç”¨å¦‚ä¸‹è¯­æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#æ³¨æ„ï¼Œæ­¤å¤„æ˜¯è¯­æ³•ç¤ºä¾‹ï¼Œ</span>
<span class="c1">#å¦‚è¦è¿è¡Œï¼Œ è¯·æå‰å‡†å¤‡å¥½xå’Œyçš„æ•°æ®</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">([</span><span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;ieee&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><h2 id="æ¡ˆä¾‹">æ¡ˆä¾‹</h2>
<p>å®šä¹‰å‡½æ•°æ›²çº¿ï¼Œ å‡†å¤‡æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span>

<span class="n">pparam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Voltage (mV)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Current ($\mu$A)&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
</code></pre></div><h3 id="scienceæ ·å¼">scienceæ ·å¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">([</span><span class="s1">&#39;science&#39;</span><span class="p">]):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Order&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">pparam</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig1.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig1.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_12_0.png" width="800" />
    
    
</figure>

<h3 id="scienceieeeæ ·å¼">science+ieeeæ ·å¼</h3>
<p>é’ˆå¯¹IEEEè®ºæ–‡å‡†å¤‡çš„<strong>science+ieee</strong>æ ·å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">([</span><span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;ieee&#39;</span><span class="p">]):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Order&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">pparam</span><span class="p">)</span>
    <span class="c1"># Note: $\mu$ doesn&#39;t work with Times font (used by ieee style)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Current (\textmu A)&#39;</span><span class="p">)</span>  
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig2a.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig2a.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_14_0.png" width="800" />
    
    
</figure>

<h3 id="sciencescatteræ ·å¼">science+scatteræ ·å¼</h3>
<p><strong>IEEE</strong> è¦æ±‚å›¾å½¢ä»¥é»‘ç™½æ‰“å°æ—¶å¿…é¡»å¯è¯»ã€‚ <strong>ieee</strong> æ ·å¼è¿˜å¯ä»¥å°†å›¾å½¢å®½åº¦è®¾ç½®ä¸ºé€‚åˆIEEEè®ºæ–‡çš„ä¸€åˆ—ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">([</span><span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;scatter&#39;</span><span class="p">]):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$^\#$</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sample&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">xlbl</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;$\log_</span><span class="si">{10}</span><span class="s2">\left(\frac{L_\mathrm</span><span class="si">{IR}</span><span class="s2">}{\mathrm</span><span class="si">{L}</span><span class="s2">_\odot}\right)$&#34;</span>
    <span class="n">ylbl</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;$\log_</span><span class="si">{10}</span><span class="s2">\left(\frac{L_\mathrm</span><span class="si">{6.2}</span><span class="s2">}{\mathrm</span><span class="si">{L}</span><span class="s2">_\odot}\right)$&#34;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlbl</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylbl</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig3.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig3.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_16_0.png" width="800" />
    
    
</figure>

<h3 id="dark_background-sciencehigh-vis">dark_background +science+high-vis</h3>
<p>æ‚¨è¿˜å¯ä»¥å°†è¿™äº›æ ·å¼ä¸Matplotlibéšé™„çš„å…¶ä»–æ ·å¼ç»“åˆä½¿ç”¨ã€‚ ä¾‹å¦‚ï¼Œdark_background +science+high-visæ ·å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">([</span><span class="s1">&#39;dark_background&#39;</span><span class="p">,</span> <span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;high-vis&#39;</span><span class="p">]):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Order&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">pparam</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig5.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig5.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output_18_0.png" width="800" />
    
    
</figure>

<br>
<p>##äº†è§£è¯¾ç¨‹</p>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>plotnineç»˜å›¾ | pythonçš„ggplot2è¯­æ³•ç»˜å›¾åŒ…</title>
      <link>https://hidadeng.github.io/blog/plotnine/</link>
      <pubDate>Tue, 23 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/plotnine/</guid>
      <description>ggplot2è¯­æ³•ï¼Œä¸‰è¡Œä»£ç ç»˜å›¾</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/plotnine%E5%8C%85%E5%AD%A6%E4%B9%A0-Python%E7%89%88%E7%9A%84ggplot2.ipynb">ç‚¹å‡»è·³è½¬åˆ°ä¸‹è½½é“¾æ¥é¡µé¢</a></p>
<br>
<p>Rè¯­è¨€çš„ggplot2ç»˜å›¾èƒ½åŠ›è¶…å¼ºï¼Œpythonè™½æœ‰matplotlibï¼Œä½†æ˜¯è¯­æ³•è‡ƒè‚¿ï¼Œä½¿ç”¨å¤æ‚ï¼Œå…¥é—¨æéš¾ï¼Œseabornçš„å‡ºç°ç¨å¾®æ”¹å–„äº†matplotlibä»£ç é‡é—®é¢˜ï¼Œä½†æ˜¯å®šåˆ¶åŒ–ç¨‹åº¦ä¾ç„¶éœ€è¦å€ŸåŠ©matplotlibï¼Œä½¿ç”¨éš¾åº¦ä¾ç„¶å¾ˆå¤§ã€‚</p>
<p>å¥½æ¶ˆæ¯æ˜¯pythonä¸­æœ‰ä¸€ä¸ªplotnineåŒ…ï¼Œå¯ä»¥å®ç°ç»å¤§å¤šæ•°ggplot2çš„ç»˜å›¾åŠŸèƒ½ï¼Œä¸¤è€…è¯­æ³•ååˆ†ç›¸ä¼¼ï¼ŒRå’ŒPythonçš„è¯­æ³•è½¬æ¢æˆæœ¬å¤§å¤§é™ä½ã€‚</p>
<ul>
<li>plotnineæ–‡æ¡£
<a href="https://plotnine.readthedocs.io/en/latest/">https://plotnine.readthedocs.io/en/latest/</a></li>
<li>Rè¯­è¨€ggplot2æ–‡æ¡£
<a href="https://ggplot2.tidyverse.org/reference/index.html">https://ggplot2.tidyverse.org/reference/index.html</a></li>
</ul>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">plotnine</span>

</code></pre></div><h2 id="å‡†å¤‡æ•°æ®">å‡†å¤‡æ•°æ®</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine.data</span> <span class="kn">import</span> <span class="n">mpg</span>

<span class="c1">#dataframe</span>
<span class="n">mpg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">manufacturer</th>
<th style="text-align:left">model</th>
<th style="text-align:right">displ</th>
<th style="text-align:right">year</th>
<th style="text-align:right">cyl</th>
<th style="text-align:left">trans</th>
<th style="text-align:left">drv</th>
<th style="text-align:right">cty</th>
<th style="text-align:right">hwy</th>
<th style="text-align:left">fl</th>
<th style="text-align:left">class</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">audi</td>
<td style="text-align:left">a4</td>
<td style="text-align:right">1.8</td>
<td style="text-align:right">1999</td>
<td style="text-align:right">4</td>
<td style="text-align:left">auto(l5)</td>
<td style="text-align:left">f</td>
<td style="text-align:right">18</td>
<td style="text-align:right">29</td>
<td style="text-align:left">p</td>
<td style="text-align:left">compact</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">audi</td>
<td style="text-align:left">a4</td>
<td style="text-align:right">1.8</td>
<td style="text-align:right">1999</td>
<td style="text-align:right">4</td>
<td style="text-align:left">manual(m5)</td>
<td style="text-align:left">f</td>
<td style="text-align:right">21</td>
<td style="text-align:right">29</td>
<td style="text-align:left">p</td>
<td style="text-align:left">compact</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">audi</td>
<td style="text-align:left">a4</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2008</td>
<td style="text-align:right">4</td>
<td style="text-align:left">manual(m6)</td>
<td style="text-align:left">f</td>
<td style="text-align:right">20</td>
<td style="text-align:right">31</td>
<td style="text-align:left">p</td>
<td style="text-align:left">compact</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">audi</td>
<td style="text-align:left">a4</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2008</td>
<td style="text-align:right">4</td>
<td style="text-align:left">auto(av)</td>
<td style="text-align:left">f</td>
<td style="text-align:right">21</td>
<td style="text-align:right">30</td>
<td style="text-align:left">p</td>
<td style="text-align:left">compact</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">audi</td>
<td style="text-align:left">a4</td>
<td style="text-align:right">2.8</td>
<td style="text-align:right">1999</td>
<td style="text-align:right">6</td>
<td style="text-align:left">auto(l5)</td>
<td style="text-align:left">f</td>
<td style="text-align:right">16</td>
<td style="text-align:right">26</td>
<td style="text-align:left">p</td>
<td style="text-align:left">compact</td>
</tr>
</tbody>
</table>
<h2 id="å¿«é€Ÿä½œå›¾qplot">å¿«é€Ÿä½œå›¾qplot</h2>
<p>æˆ‘ä»¬å…ˆç›´æ¥çœ‹æœ€ç®€å•å¥½ç”¨çš„å¿«é€Ÿä½œå›¾å‡½æ•°qplot(x, y, data)</p>
<ul>
<li>æ¨ªåæ ‡displ</li>
<li>çºµåæ ‡cty</li>
<li>æ•°æ®mpg</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">qplot</span>

<span class="n">qplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> 
      <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">,</span>
      <span class="n">data</span><span class="o">=</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_6_0.png" width="800" />
    
    
</figure>

<h2 id="ggplotå›¾å±‚">ggplotå›¾å±‚</h2>
<p>qplotæ˜¯å¿«é€Ÿä½œå›¾å‡½æ•°ï¼Œå¦‚æœæƒ³è®©å›¾æ›´å¥½çœ‹ï¼Œè¿›è¡Œç§äººè®¢åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è¿›è¡Œå›¾å±‚è®¾è®¡</p>
<p>é¦–å…ˆè®¾ç½®ggplotå›¾å±‚ï¼ˆç›¸å½“äºä¹°äº†ä¸€ä¸ªé«˜çº§ç”»å¸ƒï¼‰ï¼Œ</p>
<ul>
<li>æ•°æ®mpg</li>
<li>æ¨ªåæ ‡xè½´ä¸ºdispl</li>
<li>çºµåæ ‡yè½´cty</li>
</ul>
<p>åœ¨plotnineä¸­ï¼Œå˜é‡æ‰€å¯¹åº”çš„æ•°æ®å‡å¯é€šè¿‡å­—æ®µåè°ƒç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">geom_point</span><span class="p">,</span> <span class="n">aes</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_8_0.png" width="800" />
    
    
</figure>

<h2 id="å›¾å±‚å åŠ ">å›¾å±‚å åŠ </h2>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»ç»˜åˆ¶å‡ºä¸€ä¸ªç©ºçš„ggplotå›¾å±‚ï¼Œxè½´ä¸ºdisplï¼Œyè½´ä¸ºctyã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»™è¿™ä¸ªå›¾å±‚ä¸ŠåŠ ä¸Šæ•°æ®å¯¹åº”çš„æ•£ç‚¹ï¼Œä½¿ç”¨geom_point()ç›´æ¥è¿½åŠ åœ¨ggplotå›¾å±‚ä¹‹ä¸Šå³å¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
 <span class="o">+</span> <span class="n">geom_point</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_10_0.png" width="800" />
    
    
</figure>

<h2 id="color">color</h2>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œæ•£ç‚¹æ˜¯æ²¡æœ‰åŒºåˆ†æ¯è¾†è½¦çš„æ°”ç¼¸æ•°cylã€‚</p>
<p>åœ¨geom_point()ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ°”ç¼¸æ•°cylåˆ†é—¨åˆ«ç±»ï¼ŒæŒ‰ç…§é¢œè‰²æ˜¾ç¤ºå‡ºæ¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
 <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyl&#39;</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_12_0.png" width="800" />
    
    
</figure>

<p>ä¸Šå›¾æŒºå¥½çœ‹çš„ï¼Œæœ‰æ—¶å€™éœ€è¦ç»˜åˆ¶çš„å­—æ®µæ˜¯ç¦»æ•£å‹æ•°å€¼ï¼Œä½†æ˜¯ä¸Šè‰²åå¯èƒ½ä¸å¤Ÿæ˜æ˜¾ï¼Œéœ€è¦å£°æ˜è¯¥å­—æ®µä¸ºç¦»æ•£å‹ã€‚è¿™æ—¶å€™ç”¨factor()æ¥å‘Šè¯‰plotnineï¼Œè¿™ä¸ªå­—æ®µæ˜¯ç¦»æ•£å‹æ•°å€¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
 <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;factor(cyl)&#39;</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_14_0.png" width="800" />
    
    
</figure>

<h2 id="size">size</h2>
<p>æœ‰æ—¶å€™ä¸ºäº†å¢åŠ å¯è§†åŒ–æ˜¾ç¤ºçš„ç»´åº¦æ•°ï¼Œè¿˜å¯ä»¥è€ƒè™‘åŠ å…¥ç‚¹çš„å¤§å°size</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
 <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;hwy&#39;</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_16_0.png" width="800" />
    
    
</figure>

<h2 id="æ¢¯åº¦è‰²">æ¢¯åº¦è‰²</h2>
<p>å¦‚æœä½ æƒ³è‡ªå·±è®¾ç½®é¢œè‰²çš„æ¢¯åº¦ï¼Œå¯ä»¥é€šè¿‡scale_color_gradientè®¾ç½®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">scale_color_gradient</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cty&#39;</span><span class="p">),</span> <span class="n">mpg</span><span class="p">)</span>
<span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;hwy&#39;</span><span class="p">))</span>
<span class="o">+</span> <span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_18_0.png" width="800" />
    
    
</figure>

<h2 id="æ¡å½¢å›¾">æ¡å½¢å›¾</h2>
<p>plotnineä¸­å¯ç»˜åˆ¶çš„å›¾æœ‰å¾ˆå¤šï¼Œåˆšåˆšå·²ç»è®²äº†æ•£ç‚¹å›¾ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹plotnineä¸­çš„æ¡å½¢å›¾ã€‚</p>
<p>é¦–å…ˆå‡†å¤‡ä¸€ä¸‹æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">],</span>
    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;1-24&#39;</span><span class="p">,</span> <span class="s1">&#39;25-54&#39;</span><span class="p">,</span> <span class="s1">&#39;55+&#39;</span><span class="p">,</span> <span class="s1">&#39;Lo&#39;</span><span class="p">,</span> <span class="s1">&#39;Lo-Med&#39;</span><span class="p">,</span> <span class="s1">&#39;Med&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">],</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="p">})</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>

<span class="n">df</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">variable</th>
<th style="text-align:left">category</th>
<th style="text-align:right">value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">gender</td>
<td style="text-align:left">Female</td>
<td style="text-align:right">60</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">gender</td>
<td style="text-align:left">Male</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">age</td>
<td style="text-align:left">1-24</td>
<td style="text-align:right">50</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">age</td>
<td style="text-align:left">25-54</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">age</td>
<td style="text-align:left">55+</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:left">income</td>
<td style="text-align:left">Lo</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:left">income</td>
<td style="text-align:left">Lo-Med</td>
<td style="text-align:right">25</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:left">income</td>
<td style="text-align:left">Med</td>
<td style="text-align:right">25</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:left">income</td>
<td style="text-align:left">High</td>
<td style="text-align:right">40</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">aes</span><span class="p">,</span> <span class="n">geom_text</span><span class="p">,</span> <span class="n">position_dodge</span><span class="p">,</span> <span class="n">geom_point</span>

<span class="c1">#è°ƒæ•´æ–‡æœ¬ä½ç½®</span>
<span class="n">dodge_text</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>                              <span class="c1"># new</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> 
                <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">))</span> <span class="c1">#ç±»åˆ«å¡«å……é¢œè‰²</span>
 <span class="o">+</span> <span class="n">geom_col</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s1">&#39;dodge&#39;</span><span class="p">,</span> 
            <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># modified</span>
 <span class="o">+</span> <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">),</span>                          <span class="c1"># new</span>
             <span class="n">position</span><span class="o">=</span><span class="n">dodge_text</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>  <span class="c1">#æ–‡æœ¬é¢œè‰²</span>
             <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#å­—å·</span>
             <span class="n">angle</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="c1">#æ–‡æœ¬çš„è§’åº¦</span>
             <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    
 <span class="o">+</span> <span class="n">lims</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>                                                 <span class="c1"># new</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_22_0.png" width="800" />
    
    
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine.data</span> <span class="kn">import</span> <span class="n">economics_long</span>

<span class="n">economics_long</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">date</th>
<th style="text-align:left">variable</th>
<th style="text-align:right">value</th>
<th style="text-align:right">value01</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">1967-07-01 00:00:00</td>
<td style="text-align:left">pce</td>
<td style="text-align:right">507.4</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">1967-08-01 00:00:00</td>
<td style="text-align:left">pce</td>
<td style="text-align:right">510.5</td>
<td style="text-align:right">0.000266001</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">1967-09-01 00:00:00</td>
<td style="text-align:left">pce</td>
<td style="text-align:right">516.3</td>
<td style="text-align:right">0.00076368</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">1967-10-01 00:00:00</td>
<td style="text-align:left">pce</td>
<td style="text-align:right">512.9</td>
<td style="text-align:right">0.000471937</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">1967-11-01 00:00:00</td>
<td style="text-align:left">pce</td>
<td style="text-align:right">518.1</td>
<td style="text-align:right">0.000918132</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">aes</span><span class="p">,</span> <span class="n">geom_line</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">economics_long</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value01&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">))</span>
 <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="output_25_0.png" width="800" />
    
    
</figure>

<p>plotnineç›®å‰å·²ç»æ”¯æŒç»å¤§å¤šæ•°ggplot2ï¼Œä½†æ˜¯æ–‡æ¡£æ–¹é¢æ²¡æœ‰ggplot2å…¨ï¼Œæ‰€ä»¥å­¦ä¹ plotnineæ—¶å¯ä»¥å‚è€ƒggplot2ã€‚</p>
<ul>
<li>plotnineæ–‡æ¡£
<a href="https://plotnine.readthedocs.io/en/latest/">https://plotnine.readthedocs.io/en/latest/</a></li>
<li>Rè¯­è¨€ggplot2æ–‡æ¡£
<a href="https://ggplot2.tidyverse.org/reference/index.html">https://ggplot2.tidyverse.org/reference/index.html</a></li>
</ul>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p>[ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ](</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨pandas_bokehåšå¯è§†åŒ–</title>
      <link>https://hidadeng.github.io/blog/pandas_bokeh_vis/</link>
      <pubDate>Thu, 18 Nov 2021 17:40:10 +0600</pubDate>
      
      <guid>/blog/pandas_bokeh_vis/</guid>
      <description>ç®€æ´æ•°æ®å¯è§†åŒ–</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/blob/master/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96pandas_bokeh.zip">ç‚¹å‡»ä¸‹è½½ä»£ç </a></p>
<h2 id="pandas_bokeh">pandas_bokeh</h2>
<p>pandas_bokehå¯ä»¥ä½¿å¾—dataframeç›´æ¥è°ƒç”¨bokehåº•å±‚ä»£ç ã€‚é€šè¿‡ä½¿ç”¨pandas_bokehï¼Œå¯ä»¥åœ¨notebookæˆ–è€…htmlä¸­æ˜¾ç¤ºï¼Œè¯­æ³•ç›¸æ¯”äºbokehæ›´ç®€æ´æ˜“ç”¨ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pandas_bokeh</span>
</code></pre></div><h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>
<p>å¯¹fruits.csvåšä¸€ä¸ªæ¡å½¢å›¾</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fruits.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">fruits</th>
<th style="text-align:right">2015</th>
<th style="text-align:right">2016</th>
<th style="text-align:right">2017</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">è‹¹æœ</td>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">æ¢¨</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">é¦™è•‰</td>
<td style="text-align:right">4</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">è‰è“</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">æ¨±æ¡ƒ</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:left">æ©˜å­</td>
<td style="text-align:right">4</td>
<td style="text-align:right">6</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_bokeh</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span> <span class="c1">#å¿½ç•¥æŸäº›ä¸å½±å“ç¨‹åºçš„æç¤º</span>

<span class="c1">#åœ¨notebookä¸­èƒ½æ˜¾ç¤ºå¯è§†åŒ–ç»“æœ</span>
<span class="n">pandas_bokeh</span><span class="o">.</span><span class="n">output_notebook</span><span class="p">()</span>

<span class="c1">#å°†fruitsåˆ—è®¾ç½®ä¸ºè¡Œç´¢å¼•</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fruits.xlsx&#39;</span><span class="p">)</span>


<span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;fruits&#39;</span><span class="p">,</span> <span class="c1">#å°†fruitsåˆ—é€‰åšxè½´</span>
              <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">],</span> <span class="c1">#å°†å¹´ä»½é€‰åšyè½´</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;æ°´æœä»·æ ¼(å…ƒ/æ–¤)&#39;</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;æ°´æœ&#39;</span><span class="p">,</span>
              <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#æ˜¾ç¤º</span>
</code></pre></div>
<figure >
    
        <img src="img/2.gif" width="800" />
    
    
</figure>

<p>ä¸Šé¢çš„ä¾‹å­å·²ç»å¯ä»¥çœ‹åˆ°è¯¥åº“çš„ç®€æ´ä¼˜ç¾ä¹‹å¤„ï¼Œç°åœ¨æˆ‘ä»¬å¤šå­¦ç‚¹</p>
<h2 id="pandas_bokehè¾“å‡ºè®¾å®š">pandas_bokehè¾“å‡ºè®¾å®š</h2>
<ul>
<li>pandas_bokeh.output_notebook() åœ¨notebookä¸­èƒ½æ˜¾ç¤ºå¯è§†åŒ–ç»“æœ</li>
<li>pandas_bokeh.output_file(filename) å°†ç»“æœè¾“å‡ºåˆ°htmlæ–‡ä»¶ä¸­</li>
</ul>
<h2 id="æ”¯æŒå¯è§†åŒ–å›¾ç§ç±»">æ”¯æŒå¯è§†åŒ–å›¾ç§ç±»</h2>
<ul>
<li>line</li>
<li>bar</li>
<li>point</li>
<li>scatter</li>
<li>histogram</li>
<li>area</li>
<li>pie</li>
<li>map</li>
</ul>
<p>ä»¥barä¸ºä¾‹ï¼Œè°ƒç”¨å¯è§†åŒ–æ¥å£æ—¶ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§ä½¿ç”¨æ–¹æ³•</p>
<ul>
<li>df.plot_bokeh.line(&hellip;)</li>
<li>df.plot_bokeh(kind=&lsquo;line&rsquo;)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;fake_stocks.xlsx&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&#34;line&#34;</span><span class="p">,</span> 
              <span class="n">x</span><span class="o">=</span><span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">,</span> <span class="c1">#å°†excelä¸­çš„æ—¥æœŸåˆ—å½“åšxè½´</span>
              <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Google&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">])</span> <span class="c1">#å°†&#39;Google&#39;, &#39;Apple&#39;ä¸¤åˆ—ä½œä¸ºyè½´</span>
</code></pre></div>
<figure >
    
        <img src="img/3.gif" width="800" />
    
    
</figure>

<h2 id="é«˜çº§å‚æ•°">é«˜çº§å‚æ•°</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">plot_bokeh</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span>
              <span class="n">logx</span><span class="p">,</span> <span class="n">logy</span><span class="p">,</span> <span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">hovertool</span><span class="p">,</span> 
              <span class="n">zooming</span><span class="p">,</span> <span class="n">panning</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><ul>
<li>kind: æ”¯æŒçš„å›¾ç§ç±»&quot;line&quot;, &ldquo;point&rdquo;, &ldquo;scatter&rdquo;, &ldquo;bar&rdquo; ,&ldquo;histogram&quot;ç­‰</li>
<li>x: é€‰ä¸­æ•°æ®æŸåˆ—åä½œä¸ºxè½´ã€‚å¦‚æœxä¸ä¼ å…¥å‚æ•°ï¼Œä¼šé»˜è®¤ä½¿ç”¨dfçš„ç´¢å¼•ä½œä¸ºxè½´</li>
<li>y: å°†æ•°æ®ä¸­çš„æŸåˆ—æˆ–æŸäº›åˆ—æŒ‡å®šä¸ºyè½´</li>
<li>figsize: å›¾çš„å°ºå¯¸,å¦‚figsize=(600, 350)</li>
<li>title:  å›¾çš„æ ‡é¢˜</li>
<li>xlim/ylim: è®¾ç½®å›¾çš„xè½´å’Œyè½´çš„èŒƒå›´</li>
<li>xlabel/ylabel: è®¾ç½®xè½´å’Œyè½´çš„åå­—</li>
<li>logx/logy: å¸ƒå°”å‹å€¼ï¼Œå¯¹xå’Œyçš„æ•°æ®æ˜¯å¦è¿›è¡Œlogå˜æ¢</li>
<li>xticks/yticks: æ˜¾æ€§å®šä¹‰æ¨ªçºµåæ ‡åˆ»åº¦</li>
<li>color: å¯¹å›¾ä¸­ä½¿ç”¨åŒä¸€çš„é¢œè‰²ï¼Œå¦‚æœæƒ³å®šä¹‰å¤šç§é¢œè‰²ï¼Œè¯·ä½¿ç”¨colormapå‚æ•°</li>
<li>colormap: å¯ä»¥å¯¹å›¾ä¸­çš„ä¸åŒå¯¹è±¡è®¾ç½®é¢œè‰²ï¼Œ ä¼ å…¥çš„æ˜¯é¢œè‰²å­—ç¬¦ä¸²åˆ—è¡¨ã€‚</li>
<li>hovertool: é»˜è®¤Trueï¼Œé¼ æ ‡æ”¾åœ¨å›¾ä¸Šä¼šæ‚¬æµ®æ˜¾ç¤ºå…·ä½“ä¿¡æ¯ã€‚</li>
<li>zooming: å¸ƒå°”å€¼ï¼Œé»˜è®¤Trueæ”¯æŒç¼©æ”¾</li>
<li>panning: å¸ƒå°”å€¼ï¼Œé»˜è®¤Trueæ”¯æŒå¹³ç§»</li>
<li>kwargs**: æ›´å¤šå‚æ•°è®¾å®šè¯·çœ‹å®˜æ–¹æ–‡æ¡£</li>
</ul>
<h2 id="æ–‡æ¡£">æ–‡æ¡£</h2>
<ul>
<li>pandas_bokehæ–‡æ¡£åœ°å€https://github.com/PatrikHlobil/Pandas-Bokeh</li>
<li>Bokehå®˜æ–¹æ–‡æ¡£åœ°å€https://docs.bokeh.org/en/latest/</li>
</ul>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>2021æœ€æµè¡Œçš„8å¼ å¯è§†åŒ–å›¾</title>
      <link>https://hidadeng.github.io/blog/8_most_popular_vis/</link>
      <pubDate>Wed, 10 Nov 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/8_most_popular_vis/</guid>
      <description>ç‚«é…·å¯è§†åŒ–æ¡ˆä¾‹é›†é”¦å°½åœ¨æœ¬æ–‡</description>
      <content:encoded><![CDATA[<h2 id="1-é…’ç²¾æ¶ˆè´¹">1. é…’ç²¾æ¶ˆè´¹</h2>
<p>æ­¤å¯è§†åŒ–æ˜¾ç¤ºäº† 2001 å¹´è‡³ 2018 å¹´äººå‡ï¼ˆäººå‡ï¼‰é¥®é…’é‡æœ€é«˜çš„å›½å®¶ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™æ®µæ—¶é—´çš„æœ€é«˜å›½å®¶ä¸»è¦ç”±ä¸œéå’Œæ¬§æ´²å›½å®¶ç»„æˆã€‚</p>
<p>å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºå…¨çƒé…’ç²¾æ¶ˆè´¹çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ç‰›æ´¥å…³äºå…¨çƒé…’ç²¾æ¶ˆè´¹çš„æŠ¥å‘Š</p>
<p><a href="https://ourworldindata.org/alcohol-consumptio">https://ourworldindata.org/alcohol-consumptio</a></p>
<p>ä»¥é˜²ä¸‡ä¸€æ‚¨æ„Ÿå…´è¶£ï¼Œè¿™ç§ç±»å‹çš„æ•°æ®å¯è§†åŒ–ç§°ä¸ºæ¡å½¢å›¾ç«èµ›ã€‚ æˆ‘ç›¸ä¿¡ä½ å·²ç»åœ¨ YouTube å’Œ Reddit ä¸Šçœ‹åˆ°äº†å¾ˆå¤šè¿™æ ·çš„å†…å®¹ã€‚ å¦‚æœæ‚¨æƒ³è‡ªå·±æ„å»ºä¸€ä¸ªï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ•™ç¨‹ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹</p>
<p><a href="https://towardsdatascience.com/step-by-step-tutorial-create-a-bar-chart-race-animation-da7d5fcd7079">https://towardsdatascience.com/step-by-step-tutorial-create-a-bar-chart-race-animation-da7d5fcd7079</a></p>
<br>
<h2 id="2-å¥åº·è´¢å¯Œçš„221å¹´">2. å¥åº·&amp;è´¢å¯Œçš„221å¹´</h2>
<p>é€šå¸¸å°‘å³æ˜¯å¤šï¼Œä½†è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å¯è§†åŒ–ï¼Œå› ä¸ºå®ƒä»¥æ¸…æ™°çš„æ–¹å¼ä¼ è¾¾äº†å¦‚æ­¤å¤šçš„ä¿¡æ¯ï¼Œè€Œä¸”éå¸¸ç§¯æï¼</p>
<p>æ­¤å¯è§†åŒ–æ˜¾ç¤ºäº†æ¯ä¸ªå›½å®¶çš„è´¢å¯Œï¼ˆäººå‡ GDPï¼‰å’Œå¥åº·ï¼ˆå¹³å‡é¢„æœŸå¯¿å‘½ï¼‰å¦‚ä½•éšæ—¶é—´å˜åŒ–ã€‚ åœ†åœˆçš„å¤§å°ä»£è¡¨æ¯ä¸ªå›½å®¶çš„äººå£ï¼Œé¢œè‰²ä»£è¡¨æ¯ä¸ªå›½å®¶æ‰€å±çš„å¤§é™†ã€‚</p>
<p>çœ‹åˆ°æˆ‘ä»¬ä½œä¸ºä¸€ä¸ªç‰©ç§èµ°äº†å¤šè¿œçœŸæ˜¯å¤ªç¥å¥‡äº†ï¼Œæ˜¯å§ï¼Ÿ</p>
<p><a href="https://www.reddit.com/r/dataisbeautiful/comments/lmlrks/oc_our_health_and_wealth_over_221_years/">https://www.reddit.com/r/dataisbeautiful/comments/lmlrks/oc_our_health_and_wealth_over_221_years/</a></p>
<br>
<h2 id="3-åœ°çƒå…‰çº¤ç”µç¼†ç½‘ç»œ-3d-åœ°å›¾">3. åœ°çƒå…‰çº¤ç”µç¼†ç½‘ç»œ 3D åœ°å›¾</h2>
<p>è¿™ä¸ªç”± Tyler Morgan åˆ›å»ºçš„å¯è§†åŒ–æ˜¯ä¸–ç•Œå…‰ç¼†ç½‘ç»œçš„ 3D åœ°å›¾ã€‚ è¯¥ç½‘ç»œç”¨äºä¼ è¾“ç”µè¯ä¿¡å·ã€äº’è”ç½‘é€šä¿¡å’Œç”µè§†ä¿¡å·ã€‚</p>
<p>çœŸæ­£çœ‹åˆ°æˆ‘ä»¬åœ¨å…¨çƒèŒƒå›´å†…çš„ç›¸äº’è”ç³»æ˜¯éå¸¸ç–¯ç‹‚çš„ï¼Œä¸æ˜¯å—ï¼Ÿ</p>
<p>è¿™æ˜¯ä½¿ç”¨ rayrender å’Œ geojsonsf åŒ…åœ¨ R ä¸­åˆ›å»ºçš„ã€‚ å¦‚æœæ‚¨æƒ³æŸ¥çœ‹å®Œæ•´ä»£ç ï¼Œå¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹ã€‚</p>
<p><a href="https://gist.github.com/tylermorganwall/b222fcebcac3de56a6e144d73d166322">https://gist.github.com/tylermorganwall/b222fcebcac3de56a6e144d73d166322</a></p>
<br>
<h2 id="4-ç¾å›½covidç—…ä¾‹å¢é•¿">4. ç¾å›½Covidç—…ä¾‹å¢é•¿</h2>
<p>æˆ‘ä¸æ˜¯ç‰¹åˆ«å–œæ¬¢èŠ±å“¨çš„æ•°æ®å¯è§†åŒ–ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¸åƒç®€å•çš„å›¾å½¢ï¼ˆå¦‚æŠ˜çº¿å›¾ï¼‰é‚£æ ·æœ‰æ•ˆåœ°ä¼ è¾¾ä¿¡æ¯ã€‚ ä½†æ˜¯ï¼Œå› ä¸ºè¿™ä¸ªåŠ¨ç”»éå¸¸ç‹¬ç‰¹ï¼ˆè€Œä¸”æœ‰ç‚¹ä»¤äººä¸å®‰ï¼‰ï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦å°†å®ƒæ·»åŠ åˆ°å‰ 10 ä¸ªå¯è§†åŒ–æ•ˆæœä¸­ã€‚</p>
<p>è™½ç„¶æ²¡æœ‰è½´å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ç»å¯¹æ•°å­—ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªç®€æ´çš„å¯è§†åŒ–ï¼Œå‘æˆ‘ä»¬å±•ç¤ºäº†ä¸ 2020 å¹´å¹´åˆç›¸æ¯”ï¼ŒCOVID ç—…ä¾‹æ•°çš„å¢é•¿é€Ÿåº¦ã€‚</p>
<p>è¿™æ˜¯ä½¿ç”¨ d3 åˆ›å»ºçš„ï¼Œå®Œæ•´ä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚</p>
<p><a href="https://observablehq.com/@bagami/the-us-covid-syringe">https://observablehq.com/@bagami/the-us-covid-syringe</a></p>
<br>
<h2 id="5-ç¾å›½-covid-ç­‰å€¼çº¿å›¾">5. ç¾å›½ COVID ç­‰å€¼çº¿å›¾</h2>
<p>æ­¤å¯è§†åŒ–å‘Šè¯‰æˆ‘ä»¬ï¼Œä» 2020 å¹´ 2 æœˆå¼€å§‹åˆ° 2021 å¹´ 10 æœˆï¼Œç¾å›½çš„ COVID ç—…ä¾‹æ˜¯å¦‚ä½•å¢é•¿çš„ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ‚¨å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°è¿™ä¸€æ—¶æœŸ COVID çš„â€œæ³¢æµªâ€ã€‚</p>
<p>è¿™ç§ç±»å‹çš„å¯è§†åŒ–è¢«ç§°ä¸º<strong>ç­‰å€¼çº¿å›¾</strong>ï¼Œå®ƒåœ¨æ¯”è¾ƒä¸åŒåœ°åŒºï¼ˆå·ã€å›½å®¶ã€å¤§é™†ç­‰ï¼‰çš„ç‰¹å®šå˜é‡éšç€æ—¶é—´çš„æ¨ç§»éå¸¸å¼ºå¤§ã€‚</p>
<p>å¦‚æœä½ æƒ³å­¦ä¹ å¦‚ä½•ç”¨ Python æ„å»ºä¸€ä¸ªï¼Œæˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€ä»½åˆ›å»º Choropleth åœ°å›¾çš„åˆ†æ­¥æŒ‡å—ã€‚</p>
<p><a href="https://towardsdatascience.com/visualizing-the-coronavirus-pandemic-with-choropleth-maps-7f30fccaecf5">https://towardsdatascience.com/visualizing-the-coronavirus-pandemic-with-choropleth-maps-7f30fccaecf5</a></p>
<br>
<h2 id="6-æ‰€æœ‰ç²¾ç¥ç–¾ç—…çš„åœ°å›¾">6. æ‰€æœ‰ç²¾ç¥ç–¾ç—…çš„åœ°å›¾</h2>
<p>æ­¤å¯è§†åŒ–æ˜¾ç¤ºäº† DSM-5 ä¸­çš„æ¯ä¸€ç§ç²¾ç¥éšœç¢ï¼Œå®ƒä»£è¡¨ç²¾ç¥éšœç¢è¯Šæ–­å’Œç»Ÿè®¡æ‰‹å†Œã€‚ å®ƒæ˜¯ç¾å›½ç²¾ç¥éšœç¢çš„æ ‡å‡†åˆ†ç±»ã€‚
æœ‰ 20 å¤šä¸ªç±»åˆ«å’Œæ•°ç™¾ç§ç–¾ç—…ï¼Œä¸€æ—¦æ‚¨å¼€å§‹äº†è§£å®ƒï¼Œè¿™ç§å¯è§†åŒ–å¯èƒ½ä¼šèŠ±è´¹æ¯”æ‚¨æƒ³è±¡çš„æ›´å¤šçš„æ—¶é—´ã€‚</p>
<p><a href="https://www.reddit.com/r/dataisbeautiful/comments/kugn7e/oc_every_mental_disorder_diagnosis_in_the_dsm5/">https://www.reddit.com/r/dataisbeautiful/comments/kugn7e/oc_every_mental_disorder_diagnosis_in_the_dsm5/</a></p>
<p><a href="https://webcache.googleusercontent.com/search?q=cache:LY74prf8a0gJ:https://www.psychiatry.org/File%2520Library/Psychiatrists/Practice/DSM/APA_DSM-5-Contents.pdf+&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;gl=us&amp;client=safari">https://webcache.googleusercontent.com/search?q=cache:LY74prf8a0gJ:https://www.psychiatry.org/File%2520Library/Psychiatrists/Practice/DSM/APA_DSM-5-Contents.pdf+&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;gl=us&amp;client=safari</a></p>
<br>
<h2 id="7-æˆ‘ä»¬çš„å¡‘æ–™å»å“ªå„¿äº†">7. æˆ‘ä»¬çš„å¡‘æ–™å»å“ªå„¿äº†ï¼Ÿ</h2>
<p>è¯¥åŠ¨ç”»å±•ç¤ºäº†å¡‘æ–™çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥åŠå…¶ä¸­å¤§éƒ¨åˆ†çš„ç»“æŸä½ç½®ã€‚ å¯æ‚²çš„æ˜¯ï¼Œå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬æ²¡æœ‰åƒæˆ‘ä»¬åº”è¯¥å›æ”¶çš„é‚£æ ·å›æ”¶å°½å¯èƒ½å¤šçš„å¡‘æ–™ï¼ŒæƒŠäººçš„ 60% æœ€ç»ˆè¢«å¡«åŸ‹æˆ–è¿›å…¥æµ·æ´‹ã€‚</p>
<p>è¿™ç§ç±»å‹çš„å¯è§†åŒ–æ˜¯ä¸€ä¸ªåŠ¨ç”»æ¡‘åŸºå›¾ï¼Œå®ƒç±»ä¼¼äºæ ‘å›¾ï¼Œå› ä¸ºå®ƒå°†æ•°æ®åˆ†è§£ä¸ºå‡ ä¸ªå­ç»„å¹¶æŒ‰æ¯”ä¾‹è¡¨ç¤ºå€¼ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³å­¦ä¹ å¦‚ä½•åœ¨ Python ä¸­æ„å»º Sankey å›¾ï¼Œè¯·æŸ¥çœ‹æ­¤é“¾æ¥ã€‚</p>
<p><a href="https://towardsdatascience.com/sankey-diagram-basics-with-pythons-plotly-7a13d557401a">https://towardsdatascience.com/sankey-diagram-basics-with-pythons-plotly-7a13d557401a</a></p>
<br>
<h2 id="8--è¿‘60å¹´æ¥top-100-è‰ºæœ¯å®¶">8.  è¿‘60å¹´æ¥ï¼ŒTop 100 è‰ºæœ¯å®¶</h2>
<p>æœ€åï¼Œè¿™ä¸ªå¯è§†åŒ–æ˜¾ç¤ºäº† Billboard 1960 å¹´åˆ° 2020 å¹´çš„å‰ 100 ä½è‰ºæœ¯å®¶ã€‚æˆ‘ä¸ªäººå–œæ¬¢è¿™ä¸ªå›¾è¡¨ï¼Œå› ä¸ºå®ƒæä¾›äº†å¾ˆå¤šä¿¡æ¯ï¼šä½ å¯ä»¥çœ‹åˆ°é¡¶çº§è‰ºæœ¯å®¶æ˜¯è°ï¼Œä»–ä»¬ä»€ä¹ˆæ—¶å€™æœ€æµè¡Œï¼Œä»¥åŠä»–ä»¬æœ‰å¤šå°‘æ­Œæ›² ç§°éœ¸æ’è¡Œæ¦œï¼</p>
<p>ä½ è®¤è¯†å¤šå°‘è‰ºæœ¯å®¶ï¼Ÿ</p>
<br>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ä½¿ç”¨matplotlibç»˜åˆ¶è¶…å¯çˆ±è¶…èŒåŒ–çš„å›¾è¡¨</title>
      <link>https://hidadeng.github.io/blog/cute_matplotlib/</link>
      <pubDate>Sat, 30 Oct 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/cute_matplotlib/</guid>
      <description>èŒåŒ–matplotlibå›¾</description>
      <content:encoded><![CDATA[<h2 id="ä»£ç ä¸‹è½½">ä»£ç ä¸‹è½½</h2>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211031%E4%BD%BF%E7%94%A8matplotlib%E7%BB%98%E5%88%B6%E5%8D%A1%E9%80%9A%E5%8C%96%E5%9B%BE%E8%A1%A8">https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211031ä½¿ç”¨matplotlibç»˜åˆ¶å¡é€šåŒ–å›¾è¡¨</a></p>
<p>æ•°æ®å¯è§†åŒ–æ˜¯è®²æ•…äº‹çš„å¥½æ–¹æ³•ï¼Œä»ä¸­å¯ä»¥è½»æ¾åœ°å¸æ”¶ä¿¡æ¯å¹¶è¯†åˆ«æ•°æ®ä¸­çš„æ¨¡å¼ã€‚æˆ‘ä»¬çš„ä¸€ä½å­¦ç”Ÿå†³å®šä½¿ç”¨ Matplotlib åœ¨ Python ä¸­åˆ›å»ºæ•°æ®å¯è§†åŒ–ï¼Œä»¥äº†è§£ Netflix ä¸Šå¯ç”¨çš„ä¸åŒç±»å‹çš„å†…å®¹ã€‚æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»ä½¿ç”¨ Matplotlib ä»¥ä¸€ç§æœ‰è¶£çš„æ–¹å¼è¿›è¡Œæ•°æ®å¯è§†åŒ–ã€‚</p>
<p>åœ¨ Netflix ä¸Šçœ‹å®Œç²¾å½©çš„èŠ‚ç›®æˆ–ç”µå½±åï¼Œæ‚¨æœ‰æ²¡æœ‰æƒ³è¿‡ Netflix ä¸ºæ‚¨æä¾›äº†å¦‚æ­¤å¤šçš„æƒŠäººå†…å®¹ï¼Ÿå½“ç„¶ï¼Œæˆ‘å¹¶ä¸å­¤å•ï¼Œä¸æ˜¯å—ï¼Ÿä¸€ä¸ªæƒ³æ³•ä¼šå¯¼è‡´å¦ä¸€ä¸ªæƒ³æ³•ï¼Œåœ¨ä¸çŸ¥ä¸è§‰ä¸­ï¼Œæ‚¨å·²ç»ä¸‹å®šå†³å¿ƒè¿›è¡Œæ¢ç´¢æ€§æ•°æ®åˆ†æï¼Œä»¥äº†è§£æ›´å¤šå…³äºæœ€å—æ¬¢è¿çš„æ¼”å‘˜æ˜¯è°ä»¥åŠå“ªä¸ªå›½å®¶/åœ°åŒºæ›´å–œæ¬¢å“ªç§ç±»å‹çš„ä¿¡æ¯ã€‚</p>
<p>ä½¿ç”¨ Python åˆ¶ä½œå¸¸è§„çš„æ¡å½¢å›¾å’Œé¥¼å›¾ï¼Œè™½ç„¶å®ƒä»¬åœ¨ä¼ è¾¾ç»“æœæ–¹é¢åšå¾—å¾ˆå¥½ï¼Œä½†æˆ‘æƒ³ä¸ºè¿™ä¸ªé¡¹ç›®æ·»åŠ ä¸€äº›æœ‰è¶£çš„å…ƒç´ ã€‚</p>
<p>æˆ‘æœ€è¿‘äº†è§£åˆ°ä½ å¯ä»¥åœ¨ Python æœ€æµè¡Œçš„æ•°æ®å¯è§†åŒ–åº“ Matplotlib ä¸­åˆ›å»ºç±»ä¼¼ xkcd çš„ç»˜å›¾ï¼Œå¹¶å†³å®šæˆ‘åº”è¯¥åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æ•´ç†æˆ‘æ‰€æœ‰çš„ Matplotlib å¯è§†åŒ–ï¼Œåªæ˜¯ä¸ºäº†è®©äº‹æƒ…å˜å¾—æ›´æœ‰è¶£ã€‚</p>
<p>ä¸€èµ·æ¥çœ‹çœ‹æ•°æ®æ€ä¹ˆè¯´å§ï¼</p>
<br>
<h2 id="å¯¼å…¥æ•°æ®">å¯¼å…¥æ•°æ®</h2>
<p>7787éƒ¨ç”µå½±/TVèŠ‚ç›®çš„ä¿¡æ¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;netflix_titles.csv&#34;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df1.png" width="100%" />
    
    
</figure>

<br>
<h2 id="netflixå†å¹´å‘å±•é‡Œç¨‹ç¢‘">Netflixå†å¹´å‘å±•é‡Œç¨‹ç¢‘</h2>
<p>æè¿°ä¸€ä¸‹ Netflix å¤šå¹´æ¥æ¼”å˜çš„æ—¶é—´è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>


<span class="c1"># these go on the numbers below</span>
<span class="n">tl_dates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;1997</span><span class="se">\n</span><span class="s2">Founded&#34;</span><span class="p">,</span>
    <span class="s2">&#34;1998</span><span class="se">\n</span><span class="s2">Mail Service&#34;</span><span class="p">,</span>
    <span class="s2">&#34;2003</span><span class="se">\n</span><span class="s2">Goes Public&#34;</span><span class="p">,</span>
    <span class="s2">&#34;2007</span><span class="se">\n</span><span class="s2">Streaming service&#34;</span><span class="p">,</span>
    <span class="s2">&#34;2016</span><span class="se">\n</span><span class="s2">Goes Global&#34;</span><span class="p">,</span>
    <span class="s2">&#34;2021</span><span class="se">\n</span><span class="s2">Netflix &amp; Chill&#34;</span>
<span class="p">]</span>
<span class="n">tl_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

<span class="c1"># the numbers go on these</span>
<span class="n">tl_sub_x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>

<span class="n">tl_sub_times</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;1998&#34;</span><span class="p">,</span><span class="s2">&#34;2000&#34;</span><span class="p">,</span><span class="s2">&#34;2006&#34;</span><span class="p">,</span><span class="s2">&#34;2010&#34;</span><span class="p">,</span><span class="s2">&#34;2012&#34;</span>
<span class="p">]</span>

<span class="n">tl_text</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;Netflix.com launched&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Starts</span><span class="se">\n</span><span class="s2">Personal</span><span class="se">\n</span><span class="s2">Recommendations&#34;</span><span class="p">,</span><span class="s2">&#34;Billionth DVD Delivery&#34;</span><span class="p">,</span><span class="s2">&#34;Canadian</span><span class="se">\n</span><span class="s2">Launch&#34;</span><span class="p">,</span><span class="s2">&#34;UK Launch&#34;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
<span class="c1"># Set figure &amp; Axes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Timeline : line</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;deeppink&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Timeline : Date Points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tl_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl_x</span><span class="p">)),</span> <span class="n">s</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;palevioletred&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tl_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl_x</span><span class="p">)),</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Timeline : Time Points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tl_sub_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl_sub_x</span><span class="p">)),</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Date Text</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tl_x</span><span class="p">,</span> <span class="n">tl_dates</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1"># Stemplot : vertical line</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl_sub_x</span><span class="p">))</span>
    <span class="n">levels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span>
    <span class="n">markerline</span><span class="p">,</span> <span class="n">stemline</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">tl_sub_x</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemline</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>

    <span class="c1"># Text</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tl_sub_x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">tl_sub_x</span><span class="p">,</span> <span class="n">tl_sub_times</span><span class="p">,</span> <span class="n">tl_text</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.3</span><span class="o">*</span><span class="p">(</span><span class="n">idx</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.3</span><span class="o">*</span><span class="p">(</span><span class="n">idx</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>

    <span class="c1"># Spine</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;left&#34;</span><span class="p">,</span> <span class="s2">&#34;top&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="c1"># Title</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Netflix through the years&#34;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&#34;bold&#34;</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">1.57</span><span class="p">,</span><span class="s2">&#34;From DVD rentals to a global audience of over 150m people - is it time for Netflix to Chill?&#34;</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumblue&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre></div>
<figure >
    
        <img src="img/%e5%9b%be1.png" width="100%" />
    
    
</figure>

<br>
<h2 id="ç”µå½±-vs-ç”µè§†ç»¼è‰º">ç”µå½± vs ç”µè§†ç»¼è‰º</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘å†³å®šçœ‹ä¸€ä¸‹ç”µå½±ä¸ç”µè§†èŠ‚ç›®çš„æ¯”ä¾‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">col</span> <span class="o">=</span> <span class="s2">&#34;type&#34;</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span> <span class="p">:</span> <span class="s2">&#34;count&#34;</span><span class="p">,</span> <span class="s2">&#34;index&#34;</span> <span class="p">:</span> <span class="n">col</span><span class="p">})</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">explode</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># only &#34;explode&#34; the 2nd slice (i.e. &#39;TV Show&#39;)</span>
    <span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">grouped</span><span class="p">[</span><span class="s2">&#34;count&#34;</span><span class="p">],</span> <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">grouped</span><span class="p">[</span><span class="s2">&#34;type&#34;</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>  <span class="c1"># Equal aspect ratio ensures that pie is drawn as a circle.</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/%e5%9b%be2.png" width="100%" />
    
    
</figure>

<br>
<h2 id="å†…å®¹æœ€å¤šçš„å›½å®¶">å†…å®¹æœ€å¤šçš„å›½å®¶</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">col</span> <span class="o">=</span> <span class="s2">&#34;country&#34;</span>

<span class="n">categories</span> <span class="o">=</span> <span class="s2">&#34;, &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;, &#34;</span><span class="p">)</span>
<span class="n">counter_list</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">counter_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span> <span class="k">if</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;&#34;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span><span class="p">]</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>  <span class="c1"># labels read top-to-bottom</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Content&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Countries with most content&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/%e5%9b%be3.png" width="100%" />
    
    
</figure>

<br>
<h2 id="æœ€æµè¡Œçš„å¯¼æ¼”">æœ€æµè¡Œçš„å¯¼æ¼”</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;orangered&#34;</span><span class="p">,</span> <span class="s2">&#34;mediumseagreen&#34;</span><span class="p">,</span> <span class="s2">&#34;darkturquoise&#34;</span><span class="p">,</span> <span class="s2">&#34;mediumpurple&#34;</span><span class="p">,</span> <span class="s2">&#34;deeppink&#34;</span><span class="p">,</span> <span class="s2">&#34;indianred&#34;</span><span class="p">]</span>
<span class="n">countries_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;United States&#34;</span><span class="p">,</span> <span class="s2">&#34;India&#34;</span><span class="p">,</span> <span class="s2">&#34;United Kingdom&#34;</span><span class="p">,</span> <span class="s2">&#34;Japan&#34;</span><span class="p">,</span> <span class="s2">&#34;France&#34;</span><span class="p">,</span> <span class="s2">&#34;Canada&#34;</span><span class="p">]</span>
<span class="n">col</span> <span class="o">=</span> <span class="s2">&#34;director&#34;</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries_list</span><span class="p">:</span>
        <span class="n">country_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;country&#34;</span><span class="p">]</span><span class="o">==</span><span class="n">country</span><span class="p">]</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="s2">&#34;, &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">country_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;, &#34;</span><span class="p">)</span>
        <span class="n">counter_list</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">counter_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span> <span class="k">if</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;&#34;</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counter_list</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">values_int</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_int</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colours</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">values_int</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
        <span class="n">x</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Popular Directors with the most content&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre></div>
<figure >
    
        <img src="img/%e5%9b%be4.png" width="100%" />
    
    
</figure>

<br>
<h2 id="netflix-ä¸“æ³¨äºä»€ä¹ˆæ ·çš„å†…å®¹">Netflix ä¸“æ³¨äºä»€ä¹ˆæ ·çš„å†…å®¹ï¼Ÿ</h2>
<p>æˆ‘è¿˜æƒ³æµè§ˆè¯„çº§æ å¹¶æ¯”è¾ƒ Netflix ä¸ºå„¿ç«¥ã€é’å°‘å¹´å’Œæˆäººåˆ¶ä½œçš„å†…å®¹é‡â€”â€”ä»¥åŠè¿™äº›å¹´æ¥ä»–ä»¬çš„é‡ç‚¹æ˜¯å¦ä»ä¸€ä¸ªç¾¤ä½“è½¬ç§»åˆ°å¦ä¸€ä¸ªç¾¤ä½“ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘é¦–å…ˆæŸ¥çœ‹äº† DataFrame ä¸­çš„ç‹¬ç‰¹è¯„çº§ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;date_added&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date_added&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year_added&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date_added&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>


<span class="n">ratings_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TV-MA&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;PG-13&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-14&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-PG&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-G&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-Y&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-Y7&#39;</span><span class="p">,</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;NC-17&#39;</span><span class="p">,</span> <span class="s1">&#39;TV-Y7-FV&#39;</span><span class="p">]</span>
<span class="n">ratings_group_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Little Kids&#39;</span><span class="p">,</span> <span class="s1">&#39;Older Kids&#39;</span><span class="p">,</span> <span class="s1">&#39;Teens&#39;</span><span class="p">,</span> <span class="s1">&#39;Mature&#39;</span><span class="p">]</span>
<span class="n">ratings_dict</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;TV-G&#39;</span><span class="p">:</span> <span class="s1">&#39;Little Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-Y&#39;</span><span class="p">:</span> <span class="s1">&#39;Little Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="s1">&#39;Little Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-PG&#39;</span><span class="p">:</span> <span class="s1">&#39;Older Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-Y7&#39;</span><span class="p">:</span> <span class="s1">&#39;Older Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PG&#39;</span><span class="p">:</span> <span class="s1">&#39;Older Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-Y7-FV&#39;</span><span class="p">:</span> <span class="s1">&#39;Older Kids&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PG-13&#39;</span><span class="p">:</span> <span class="s1">&#39;Teens&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-14&#39;</span><span class="p">:</span> <span class="s1">&#39;Teens&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TV-MA&#39;</span><span class="p">:</span> <span class="s1">&#39;Mature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="s1">&#39;Mature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NC-17&#39;</span><span class="p">:</span> <span class="s1">&#39;Mature&#39;</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">rating_val</span><span class="p">,</span> <span class="n">rating_group</span> <span class="ow">in</span> <span class="n">ratings_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">rating</span> <span class="o">==</span> <span class="n">rating_val</span><span class="p">,</span> <span class="s2">&#34;rating&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rating_group</span>
    
    
    
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating_val&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">x</span><span class="o">=</span><span class="mi">0</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kinda</span><span class="se">\n</span><span class="s1">less&#39;</span><span class="p">,</span> <span class="s1">&#39;not so</span><span class="se">\n</span><span class="s1">bad&#39;</span><span class="p">,</span> <span class="s1">&#39;holyshit</span><span class="se">\n</span><span class="s1">that</span><span class="se">\&#39;</span><span class="s1">s too</span><span class="se">\n</span><span class="s1">many&#39;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ratings_group_list</span><span class="p">:</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">r</span><span class="p">]</span>
        <span class="n">year_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year_added&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">year_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year_df</span><span class="p">[</span><span class="s1">&#39;year_added&#39;</span><span class="p">],</span> <span class="n">year_df</span><span class="p">[</span><span class="s1">&#39;rating_val&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="n">values_int</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">year_df</span><span class="p">[</span><span class="s1">&#39;year_added&#39;</span><span class="p">]))</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">values_int</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Count of shows and movies that Netflix</span><span class="se">\n</span><span class="s1"> has been producing for different audiences&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Content Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">x</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ratings_group_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</code></pre></div>
<figure >
    
        <img src="img/%e5%9b%be5.png" width="100%" />
    
    
</figure>

<br>
<h2 id="æ•°æ®æŒ–æ˜è¯¾">æ•°æ®æŒ–æ˜è¯¾</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p><a href="https://hidadeng.github.io/blog/management_python_course/">ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Shifteratoråº“ | è¯ç§»å›¾åˆ†è¾¨ä¸¤æ–‡æœ¬ç”¨è¯é£æ ¼å·®å¼‚</title>
      <link>https://hidadeng.github.io/blog/shifterator_text_vis/</link>
      <pubDate>Tue, 26 Oct 2021 16:40:10 +0600</pubDate>
      
      <guid>/blog/shifterator_text_vis/</guid>
      <description>å›¾æ–‡ä»£ç ç†è§£ä¸¤æ–‡æœ¬ç”¨è¯é£æ ¼å·®å¼‚</description>
      <content:encoded><![CDATA[<p>ä»¥å¾€å¯¹æ¯”ä¸¤ä¸ªæ–‡æœ¬æ•°æ®å·®å¼‚ï¼Œæ¯”è¾ƒç®€å•çš„æŠ€æœ¯å®ç°æ–¹æ³•æ˜¯ç”Ÿæˆä¸¤æ–‡ä¸ªè¯äº‘å›¾ï¼Œä½†æ˜¯è¯äº‘å›¾æ— æ³•ç›´è§‚æ˜¾ç¤ºè¯è¯­å±‚é¢çš„æƒé‡ã€‚</p>
<p><strong>Shifterator</strong>åŒ…æä¾›äº†æ„å»ºè¯ç§»å›¾çš„åŠŸèƒ½ï¼Œå‚ç›´æ¡å½¢å›¾å¯ä»¥é‡åŒ–å“ªäº›è¯ä¼šå¯¼è‡´<strong>ä¸¤ä¸ªæ–‡æœ¬</strong>ä¹‹é—´çš„æˆå¯¹å·®å¼‚ä»¥åŠå®ƒä»¬å¦‚ä½•èµ·ä½œç”¨ã€‚ é€šè¿‡å…è®¸æ‚¨æŸ¥çœ‹å•è¯ä½¿ç”¨æ–¹å¼çš„å˜åŒ–ï¼Œå•è¯è½¬æ¢å¯å¸®åŠ©æ‚¨å¯¹æƒ…ç»ªã€ç†µå’Œåˆ†æ­§è¿›è¡Œåˆ†æï¼Œè¿™äº›åˆ†æä»æ ¹æœ¬ä¸Šæ¥è¯´æ›´å…·å¯è§£é‡Šæ€§ã€‚</p>
<p>Shifteratoräº®ç‚¹ï¼š</p>
<ul>
<li>æä¾›å¯è§£é‡Šçš„å·¥å…·ï¼Œç”¨äºå°†æ–‡æœ¬ä½œä¸ºæ•°æ®å¤„ç†å¹¶æ˜ å°„å‡ºä¸¤ä¸ªæ–‡æœ¬ç›¸ä¼¼æ€§æˆ–å·®å¼‚æ€§</li>
<li>å®ç°å¸¸è§çš„æ–‡æœ¬æ¯”è¾ƒåº¦é‡ï¼ŒåŒ…æ‹¬ç›¸å¯¹é¢‘ç‡ã€é¦™å†œç†µã€Tsallisç†µã€Kullback-Leibleræ•£åº¦å’Œ Jensen-Shannon æ•£åº¦ã€‚</li>
<li>åŸºäºå­—å…¸çš„æƒ…ç»ªåˆ†ææ–¹æ³•è®¡ç®—çš„åŠ æƒå¹³å‡å€¼ã€‚</li>
<li>åœ¨ç ”ç©¶åˆæœŸå¯ç”¨äºè¯Šæ–­æ•°æ®ã€æ„ŸçŸ¥æµ‹é‡è¯¯å·®ã€‚</li>
</ul>
<p>è®¡ç®—ç¤¾ä¼šç§‘å­¦å®¶ã€æ•°å­—äººæ–‡ä¸»ä¹‰è€…å’Œå…¶ä»–æ–‡æœ¬åˆ†æä»ä¸šè€…éƒ½å¯ä»¥ä½¿ç”¨ Shifterator ä»æ–‡æœ¬æ•°æ®æ„å»ºå¯é ã€ç¨³å¥å’Œå¯è§£é‡Šçš„æ•…äº‹ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">shifterator</span><span class="o">==</span><span class="mf">0.2.2</span>
</code></pre></div><br>
<h2 id="å¯¼å…¥æ•°æ®">å¯¼å…¥æ•°æ®</h2>
<p>å‡†å¤‡çš„å¤–å–csvæ•°æ®ï¼Œå«labelå’Œreviewä¸¤ä¸ªå­—æ®µã€‚</p>
<p>å…¶ä¸­labelæ˜¯å¥½è¯„å·®è¯„çš„æ ‡æ³¨ï¼Œ</p>
<ul>
<li>0ä¸ºå·®è¯„ï¼Œ</li>
<li>1ä¸ºå¥½è¯„</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">reviews_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;data/WaiMai8k.csv&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">reviews_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/df.png" width="800" />
    
    
</figure>

<p>æœ‰ä¸ªç–‘é—®ï¼Œå¤–å–å¥½å·®è¯„ä¸­çš„ç”¨è¯æœ‰ä»€ä¹ˆå·®å¼‚(åŒºåˆ«/ç‰¹ç‚¹)ï¼Ÿ</p>
<h2 id="å‡†å¤‡ä¸¤ç»„æ–‡æœ¬æ•°æ®">å‡†å¤‡ä¸¤ç»„æ–‡æœ¬æ•°æ®</h2>
<p>shifteratoréœ€è¦ä¸¤ç»„æ–‡æœ¬æ•°æ®ï¼Œæ ¼å¼ä¸ºé•¿åº¦ç›¸åŒçš„è¯é¢‘ç»Ÿè®¡å­—å…¸ã€‚</p>
<p>æŒ‰ç…§labelç±»åˆ«ï¼Œå°†æ•°æ®æ•´ç†ä¸ºä¸¤ä¸ªæ–‡æœ¬æ•°æ®ã€‚åœ¨å‡†å¤‡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›æ¸…æ´—æ“ä½œ</p>
<ul>
<li>æ¸…é™¤éä¸­æ–‡å­—ç¬¦ï¼Œå¦‚ç½‘å€ã€é‚®ç®±ã€æ ‡ç‚¹ç¬¦å·</li>
<li>æ¸…é™¤ä¿¡æ¯é‡æ¯”è¾ƒä½çš„åœç”¨è¯</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">jieba</span>
<span class="kn">import</span> <span class="nn">re</span> 

<span class="n">texts_neg</span> <span class="o">=</span> <span class="n">reviews_df</span><span class="p">[</span><span class="n">reviews_df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;review&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">texts_pos</span> <span class="o">=</span> <span class="n">reviews_df</span><span class="p">[</span><span class="n">reviews_df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;review&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">docs</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;æ¸…æ´—æ–‡æœ¬ä¸­çš„éä¸­æ–‡å­—ç¬¦ã€åœç”¨è¯ï¼Œè¿”å›è¯é¢‘ç»Ÿè®¡ç»“æœ
</span><span class="s2">    docs : å¾…å¤„ç†çš„æ–‡æ¡£åˆ—è¡¨
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="n">stop_words</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/stopwords.txt&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;[</span><span class="se">\u4e00</span><span class="s2">-</span><span class="se">\u9fa5</span><span class="s2">]+&#34;</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">jieba</span><span class="o">.</span><span class="n">lcut</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>
    <span class="n">wordfreq_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wordfreq_dict</span>


<span class="n">clean_texts_neg</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">texts_neg</span><span class="p">)</span>
<span class="n">clean_texts_pos</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">texts_pos</span><span class="p">)</span>
</code></pre></div><br>
<h2 id="æ— èŠçš„ä¼ ç»Ÿç»˜å›¾">æ— èŠçš„ä¼ ç»Ÿç»˜å›¾</h2>
<p>ä½¿ç”¨æ¡å½¢å›¾ã€è¯äº‘å›¾ç»˜åˆ¶ï¼Œä¸ºäº†ç¼©å°ä»£ç é‡ï¼Œè¿™é‡Œåªç»˜åˆ¶å·®è¯„æ•°æ®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯matplotlibä¸æ˜¾ç¤ºä¸­æ–‡ï¼Œè¿™é‡Œéœ€è¦å…ˆä½¿ç”¨ä¸‹é¢ä¸‰è¡Œä»£ç è·å–ç”µè„‘ä¸­è‡ªå¸¦çš„ä¸­æ–‡å­—ä½“åˆ—è¡¨mpl_fontsï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontManager</span>
 
<span class="n">mpl_fonts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">FontManager</span><span class="p">()</span><span class="o">.</span><span class="n">ttflist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mpl_fonts</span><span class="p">)</span>
</code></pre></div><p>ç»è¿‡è¿è¡Œï¼Œæˆ‘çš„ç”µè„‘mpl_fontsé‡Œæœ‰<strong>Arial Unicode MS</strong> ï¼Œåé¢ç”¨matplotlibæ˜¾ç¤ºä¸­æ–‡çš„åœ°æ–¹ï¼Œæˆ‘éƒ½ä½¿ç”¨è¯¥å­—ä½“ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#å‡†å¤‡DataFrameæ•°æ®</span>
<span class="n">common_neg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clean_texts_neg</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>

<span class="n">common_pos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clean_texts_pos</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&#34;whitegrid&#34;</span><span class="p">)</span>

<span class="c1">#ä¸ºäº†æ˜¾ç¤ºä¸­æ–‡</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&#34;font&#34;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial Unicode MS&#39;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">#ç»˜åˆ¶æ°´å¹³æ¡å½¢å›¾</span>
<span class="n">common_neg</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;words&#39;</span><span class="p">,</span>
                     <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
                      <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s2">&#34;red&#34;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;å¤–å–å·®è¯„å¸¸è§è¯&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/output_9_0.png" width="800" />
    
    
</figure>

<p>ç»˜åˆ¶è¯äº‘å›¾ï¼Œè¿™é‡Œä½¿ç”¨çš„pyechartsåŒ…ã€‚ç”±äºè¯¥åŒ…ä½œè€…æ›´æ–°å¼ºåº¦æ¯”è¾ƒå¤§ï¼Œä¸ºäº†ä¿è¯æ—¥åæœ¬æ•™ç¨‹ä»å¯æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œæä¾›å½“å‰æˆ‘ä½¿ç”¨çš„pyechartsç›¸å…³çš„ç‰ˆæœ¬ï¼Œå¤§å®¶å¯ä»¥è¿è¡Œä¸‹é¢ä»£ç ä¿è¯è¿è¡Œå‡ºæ­£ç¡®ç»“æœ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyecharts</span><span class="o">==</span><span class="mf">1.6.2</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyecharts</span><span class="o">-</span><span class="n">javascripthon</span><span class="o">==</span><span class="mf">0.0.6</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyecharts</span><span class="o">-</span><span class="n">jupyter</span><span class="o">-</span><span class="n">installer</span><span class="o">==</span><span class="mf">0.0.3</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyecharts</span><span class="o">-</span><span class="n">snapshot</span><span class="o">==</span><span class="mf">0.2.0</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pyecharts.options</span> <span class="k">as</span> <span class="nn">opts</span>
<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">WordCloud</span>
<span class="kn">from</span> <span class="nn">pyecharts.globals</span> <span class="kn">import</span> <span class="n">CurrentConfig</span><span class="p">,</span> <span class="n">NotebookType</span>
<span class="n">CurrentConfig</span><span class="o">.</span><span class="n">NOTEBOOK_TYPE</span> <span class="o">=</span> <span class="n">NotebookType</span><span class="o">.</span><span class="n">JUPYTER_NOTEBOOK</span>

<span class="n">wordfreqs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">clean_texts_neg</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>


<span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">()</span>
<span class="n">wc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">series_name</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">data_pair</span><span class="o">=</span><span class="n">wordfreqs</span><span class="p">,</span> <span class="n">word_size_range</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">wc</span><span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span><span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;å¤–å–å·®è¯„è¯äº‘å›¾&#34;</span><span class="p">,</span> 
                                             <span class="n">title_textstyle_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TextStyleOpts</span><span class="p">(</span><span class="n">font_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)),</span>
                   <span class="n">tooltip_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TooltipOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">wc</span><span class="o">.</span><span class="n">load_javascript</span><span class="p">()</span>
<span class="n">wc</span><span class="o">.</span><span class="n">render_notebook</span><span class="p">()</span>
</code></pre></div>
<figure >
    
        <img src="img/%e8%af%8d%e4%ba%91%e5%9b%be.png" width="800" />
    
    
</figure>

<h2 id="ä½¿ç”¨shifteratorç»˜åˆ¶è¯ç§»å›¾">ä½¿ç”¨Shifteratorç»˜åˆ¶è¯ç§»å›¾</h2>
<p>ç»ˆäºè¦ç”¨åˆ° <strong>Shifterator</strong> åŒ…äº†ï¼ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŒ…æ ¹æ®é¢‘ç‡å’Œæƒ…ç»ªï¼ˆæˆ–å…¶ä»–å€¼ï¼‰æ¯”è¾ƒè´Ÿé¢å’Œæ­£é¢çš„å¤–å–è¯„è®ºï¼Œè¿™é‡Œæˆ‘åªè®¡ç®—äº†é¢‘ç‡ä½œä¸ºæƒé‡</p>
<h3 id="ç†µç§»å›¾entropy-shift">ç†µç§»å›¾Entropy shift</h3>
<p>ç¬¬ä¸€å¹…å›¾æ˜¯entropy shift graph</p>
<p>å…·ä½“ä¿¡æ¯è¯·æŸ¥çœ‹æ–‡æ¡£  <a href="https://github.com/ryanjgallagher/shifterator">https://github.com/ryanjgallagher/shifterator</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">shifterator</span> <span class="kn">import</span> <span class="n">EntropyShift</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&#34;font&#34;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial Unicode MS&#39;</span><span class="p">)</span>

<span class="n">entropy_shift</span> <span class="o">=</span> <span class="n">EntropyShift</span><span class="p">(</span><span class="n">type2freq_1</span><span class="o">=</span><span class="n">clean_texts_neg</span><span class="p">,</span>
                             <span class="n">type2freq_2</span><span class="o">=</span><span class="n">clean_texts_pos</span><span class="p">,</span>
                             <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">entropy_shift</span><span class="o">.</span><span class="n">get_shift_graph</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;å¤–å–å·®è¯„ vs å¤–å–å¥½è¯„&#39;</span><span class="p">)</span>
</code></pre></div>
<figure >
    
        <img src="img/output141.png" width="800" />
    
    
</figure>

<p>çœ‹èµ·æ¥æœ€èƒ½å†³å®šå¤–å–å·®è¯„çš„ç”¨è¯­æ˜¯é…é€æ—¶é—´ï¼Œå…¶æ¬¡æ‰æ˜¯å£å‘³ã€‚</p>
<p>æœ€èƒ½å†³å®šå¤–å–å¥½è¯„çš„ä¼¼ä¹æ˜¯å£å‘³ï¼Œå…¶æ¬¡æ‰æ˜¯é…é€æ—¶é—´ã€‚</p>
<p>é€šè¿‡Shifteratoræˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºä¸åŒè¯åœ¨ä¸åŒæ–‡æœ¬ä¸­çš„ä½œç”¨ç¨‹åº¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åªä½¿ç”¨äº†æœ€é«˜çš„å‰15è¯é¢‘ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„è¯æœ‰äº›å°‘</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å¸Œæœ›æœ¬æ–‡èƒ½å¯¹ä½ çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œä»£ç ä¸‹è½½åœ°å€</p>
<p><a href="https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211027shifterator%E5%AD%A6%E4%B9%A0">https://github.com/hidadeng/DaDengAndHisPython/tree/master/20211027shifteratorå­¦ä¹ </a></p>
<p>ä»£ç æ’°å†™è°ƒè¯•ä¸æ˜“ï¼Œå¸Œæœ›å¸®å¿™è½¬è½½</p>

<figure >
    
        <img src="img/Python%e4%b8%93%e6%a0%8f%e8%af%be.jpg" width="800" />
    
    
</figure>

<br>
<h2 id="äº†è§£è¯¾ç¨‹">äº†è§£è¯¾ç¨‹</h2>
<div style="text-align: center;">
<figure >
    <a href="https://m.qlchat.com/wechat/page/channel-intro?channelId=2000015158133596">
        <img src="/images/bg/management_data_mining_with_python_course.png" width="100%" />
    </a>
    <figcaption><small><i>ç‚¹å‡»ä¸Šæ–¹å›¾ç‰‡è´­ä¹°è¯¾ç¨‹</i></small></figcaption>
</figure>
</div>
<p>[ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ](</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
